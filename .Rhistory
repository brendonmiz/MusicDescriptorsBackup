ylab = 'Bootstrap ratios',
) + ggtitle("", subtitle = 'Columns')
grid.arrange(
as.grob(badj001.BR1.I),as.grob(badj002.BR1.J),
as.grob(badj003.BR2.I),as.grob(badj004.BR2.J),
ncol = 2,nrow = 2,
top = textGrob("Bootstrap ratios", gp = gpar(fontsize = 18, font = 3))
)
BRadj.IJ <- recordPlot()
BR.I <- bootRatadj.I$boot.ratios
BR.J <- bootRatadj.J$boot.ratios
laDim = 1
# Plot the bootstrap ratios for Dimension 1
badj001.BR1.I <- PrettyBarPlot2(BR.I[,laDim],
threshold = 2,
font.size = 3,
color4bar = cols$ex.oc[order(BR.I[,laDim])], # we need hex code
ylab = 'Bootstrap ratios',
sortValues = TRUE,
) + ggtitle(paste0('Component ', laDim), subtitle = 'Rows')
badj002.BR1.J <- PrettyBarPlot2(BR.J[,laDim],
threshold = 2,
font.size = 3,
color4bar = cols$adj.oc[order(BR.J[,laDim])],
ylab = 'Bootstrap ratios',
sortValues = TRUE,
) + ggtitle("", subtitle = 'Columns')
# Plot the bootstrap ratios for Dimension 2
laDim = 2
badj003.BR2.I <- PrettyBarPlot2(BR.I[,laDim],
threshold = 2,
font.size = 3,
color4bar = cols$ex.oc[order(BR.I[,laDim])], # we need hex code
ylab = 'Bootstrap ratios',
sortValues = TRUE,
) + ggtitle(paste0('Component ', laDim), subtitle = 'Rows')
badj004.BR2.J <- PrettyBarPlot2(BR.J[,laDim],
threshold = 2,
font.size = 3,
color4bar = cols$adj.oc[order(BR.J[,laDim])],
ylab = 'Bootstrap ratios',
sortValues = TRUE,
) + ggtitle("", subtitle = 'Columns')
grid.arrange(
as.grob(badj001.BR1.I),as.grob(badj002.BR1.J),
as.grob(badj003.BR2.I),as.grob(badj004.BR2.J),
ncol = 2,nrow = 2,
top = textGrob("Bootstrap ratios", gp = gpar(fontsize = 18, font = 3))
)
BRadj.IJ <- recordPlot()
bootRatadj.I$prob.boot.ratios.corr
colsums(adj.contingency)
colSums(adj.contingency)
colSums(adj.contingency)[order(colSums(adj.contingency))]
adjbrick.AM <- adjbrick[,,1:length(which(adj.catadata.list$partcols$nationality == "AM"))]
adj.cont.AM <- apply(adjbrick.AM, c(1,2), sum)
adjbrick.FR <- adjbrick[,,(length(which(adj.catadata.list$partcols$nationality == "AM"))+1):dim(adjbrick)[[3]]]
adj.cont.FR <- apply(adjbrick.FR, c(1,2), sum)
adj.fr.cares <- epCA(adj.cont.FR, symmetric = TRUE)
adj.am.cares <- epCA(adj.cont.AM, symmetric = TRUE)
adj.fr.cares$ExPosition.Data$fi[,2] <- adj.fr.cares$ExPosition.Data$fi[,2]*-1
adj.fr.cares$ExPosition.Data$fj[,2] <- adj.fr.cares$ExPosition.Data$fj[,2]*-1
am.FI <- adj.am.cares$ExPosition.Data$fi
am.FJ <- adj.am.cares$ExPosition.Data$fj
fr.FI <- adj.fr.cares$ExPosition.Data$fi
fr.FJ <- adj.fr.cares$ExPosition.Data$fj
rownames(am.FI) <- rownames(fr.FI) <- rownames(FIsym.adj) <- c(1:30)
colnames(adjrenorm$G_A) <- colnames(FJs.adj)
axisone <- 1
axistwo <- 2
exmap <- createFactorMapIJ(FIsym.adj,
FJs.adj,
axis1 = axisone,axis2 = axistwo,
col.points.i = cols$ex.oc,
col.labels.i = cols$ex.oc,
col.points.j = cols$adj.oc,
col.labels.j = cols$adj.oc,
text.cex.i = 3.5, text.cex.j = 3.5,
font.face.j = 'italic',
)
# It's a fairly complex simplex, so we specify the vertices between which the
# simplex should be drawn.
#excerptedges <- c("Fast", "Aggressive", "Disturbing", "Dark", "Sad",
#                  "Slow", "Soft", "Warm", "Happy")
#simplexorder <- match(excerptedges, colnames(adj.contingency))
#zePoly.J <- PTCA4CATA::ggdrawPolygon(FJs.adj, order2draw = simplexorder)
vc.labels <- createxyLabels(resCA = adjsym.cares)
am.labels <- createxyLabels(resCA = adj.am.cares)
fr.labels <- createxyLabels(resCA = adj.fr.cares)
exmap.am <- createFactorMapIJ(am.FI,
am.FJ,
axis1 = axisone,axis2 = axistwo,
col.points.i = cols$ex.oc,
col.labels.i = cols$ex.oc,
col.points.j = cols$adj.oc,
col.labels.j = cols$adj.oc,
text.cex.i = 5, text.cex.j = 3.5, font.face.j = 'italic'
)
exmap.fr <- createFactorMapIJ(fr.FI,
fr.FJ,
axis1 = axisone,axis2 = axistwo,
col.points.i = cols$ex.oc,
col.labels.i = cols$ex.oc,
col.points.j = cols$adj.oc,
col.labels.j = cols$adj.oc,
text.cex.i = 5, text.cex.j = 3.5, font.face.j = 'italic'
)
mus.adj.am <- exmap.am$baseMap +
exmap.am$I_points +
exmap.am$I_labels +
exmap.am$J_points +
exmap.am$J_labels +
am.labels + ggtitle('American Participants')
mus.adj.fr <- exmap.fr$baseMap +
exmap.fr$I_points +
exmap.fr$I_labels +
exmap.fr$J_points +
exmap.fr$J_labels +
fr.labels + ggtitle('French Participants')
mus.adj.004 <- exmap$baseMap + #zePoly.J +
exmap$I_points +
exmap$I_labels +
exmap$J_points +
exmap$J_labels +
vc.labels + ggtitle('Symmetric Map of Row and Column Factor Scores')
grid.arrange(
as.grob(mus.adj.am),as.grob(mus.adj.fr),
ncol = 2,nrow = 1,
top = textGrob("Symmetric Maps of the Row and Column Factor Scores", gp = gpar(fontsize = 18, font = 3))
)
am_fr_adjmaps <- recordPlot()
print(mus.adj.004)
library(MExPosition)
adj4MFA <- abind(adj.cont.FR, adj.cont.AM, along = 2)
frvec <- t(as.data.frame(rep("FR", length.out = dim(adj.cont.FR)[2])))
amvec <- t(as.data.frame(rep("AM", length.out = dim(adj.cont.AM)[2])))
colnames(frvec) <- colnames(amvec) <- colnames(adj.cont.FR)
rownames(frvec) <- rownames(amvec) <- "group"
mfagroups <- abind(frvec, amvec, along = 2)
mfares <- mpMFA(adj4MFA, mfagroups)
renameCols <- function(x){
colnames(x) <- paste("Dimension", 1:ncol(x))
x
}
RVmat <- mfares$mexPosition.Data$InnerProduct$RVMatrix
#corrplot(RVmat, method = "color", addCoefasPercent = TRUE)
Eig4scree <- mfares$mexPosition.Data$Table$eigs
#mfascree <- PlotScree(Eig4scree, plotKaiser = TRUE)
MFA_FMap <- createFactorMap(
mfares$mexPosition.Data$Table$fi,
col.points = cols$ex.oc,
col.labels = cols$ex.oc,
alpha.points = .6,
pch = 17,
cex = 5,
display.labels = TRUE,
constraints = minmaxHelper4Partial(FactorScores = mfares$mexPosition.Data$Table$fi,
partialFactorScores = mfares$mexPosition.Data$Table$partial.fi.array)
)
label4Map <- createxyLabels.gen(1,2,
lambda = mfares$mexPosition.Data$Table$eigs,
tau = mfares$mexPosition.Data$Table$t,
axisName = "Dimension ")
fi4pfs <- mfares$mexPosition.Data$Table$fi
fi4pfs <- renameCols(fi4pfs)
pfi4pfs <- mfares$mexPosition.Data$Table$partial.fi.array
pfi4pfs <- renameCols(pfi4pfs)
rownames(pfi4pfs) <- c(1:30)
dimnames(pfi4pfs)[[3]] <- c("FR", "AM")
map4PFS <- createPartialFactorScoresMap(
factorScores = fi4pfs,
partialFactorScores = pfi4pfs,
axis1 = 1, axis2 = 2,
colors4Items = cols$ex.oc,
names4Partial = c("FR", "AM"),
font.labels = 'bold'
)
partialfsmap <- MFA_FMap$zeMap +
label4Map +
map4PFS$linesColByItems +
map4PFS$pointsColByItems +
map4PFS$labelsColByItems +
ggtitle("Contributions to the Excerpts Factor Scores")
adj4MFA.T <- abind(t(adj.cont.FR), t(adj.cont.AM), along = 2)
natvec <- rep(c("FR", "AM"), times = dim(adj4MFA.T)[2]/2)
natvec <- data.frame(natvec[order(natvec, decreasing = T)]) %>% t(.)
colnames(natvec) <- colnames(adj4MFA.T)
rownames(natvec) <- "group"
mfares.t <- mpMFA(adj4MFA.T, natvec)
RVmat.t <- mfares.t$mexPosition.Data$InnerProduct$RVMatrix
#corrplot(RVmat, method = "color", addCoefasPercent = TRUE)
Eig4scree <- mfares$mexPosition.Data$Table$eigs
#mfascree <- PlotScree(Eig4scree, plotKaiser = TRUE)
MFA_FMap.t <- createFactorMap(
mfares.t$mexPosition.Data$Table$fi,
col.points = cols$adj.oc,
col.labels = cols$adj.oc,
alpha.points = .6,
pch = 17,
cex = 5,
display.labels = TRUE,
constraints = minmaxHelper4Partial(FactorScores = mfares.t$mexPosition.Data$Table$fi,
partialFactorScores = mfares.t$mexPosition.Data$Table$partial.fi.array)
)
label4Map.t <- createxyLabels.gen(1,2,
lambda = mfares.t$mexPosition.Data$Table$eigs,
tau = mfares.t$mexPosition.Data$Table$t,
axisName = "Dimension ")
fi4pfs.t <- mfares.t$mexPosition.Data$Table$fi
fi4pfs.t <- renameCols(fi4pfs.t)
pfi4pfs.t <- mfares.t$mexPosition.Data$Table$partial.fi.array
pfi4pfs.t <- renameCols(pfi4pfs.t)
rownames(pfi4pfs.t) <- colnames(adj.contingency)
dimnames(pfi4pfs.t)[[3]] <- c("FR", "AM")
map4PFS.t <- createPartialFactorScoresMap(
factorScores = fi4pfs.t,
partialFactorScores = pfi4pfs.t,
axis1 = 1, axis2 = 2,
colors4Items = cols$adj.oc,
names4Partial = c("FR", "AM"),
font.labels = 'bold',
# alpha.lines = .75, size.lines = 3
)
partialfsmap.t <- MFA_FMap.t$zeMap +
label4Map.t +
map4PFS.t$linesColByItems +
map4PFS.t$pointsColByItems +
map4PFS.t$labelsColByItems +
ggtitle("Contributions to the Adjectives Factor Scores")
grid.arrange(as.grob(partialfsmap),
as.grob(partialfsmap.t),
ncol = 2, nrow = 1,
top = textGrob("Partial Factor Scores Plots for French and American Participants")
)
mfasbs <- recordPlot()
print(partialfsmap)
print(partialfsmap.t)
grid.arrange(as.grob(partialfsmap),
as.grob(partialfsmap.t),
ncol = 2, nrow = 1,
top = textGrob("Partial Factor Scores Plots for French and American Participants")
)
grid.arrange(as.grob(partialfsmap),
as.grob(partialfsmap.t),
ncol = 2, nrow = 1,
top = textGrob("Partial Factor Scores Plots for French and American Participants")
)
mfasbs <- recordPlot()
rm(list = ls())
load("catadatamusdim.RData")
load("adj.catadata.list.RData")
load("adjdesign.RData")
load("adjectivecolors.RData")
source('~/GitHub/MusicDescriptorsBackup/barplot_sigonly.R')
dimcontingency <- catadata.list$contingency
adjcontingency <- adj.catadata.list$adjcontingency
dimcontingency <- dimcontingency[-c(6,14),-9]
adjcontingency <- adjcontingency[-c(6,14),]
library(TExPosition)
library(TInPosition)
library(data4PCCAR)
pls.res <- tepPLS(dimcontingency, adjcontingency, DESIGN = adj.design$thedesign[-c(6,14)])
resPerm4PLSC <- perm4PLSC(dimcontingency, adjcontingency, nIter = 1000)
e1 <- pls.res$TExPosition.Data$eigs[1]
e2 <- pls.res$TExPosition.Data$eigs[2]
e3 <- pls.res$TExPosition.Data$eigs[3]
t1 <- pls.res$TExPosition.Data$t[1]
t2 <- pls.res$TExPosition.Data$t[2]
t3 <- pls.res$TExPosition.Data$t[3]
t4 <- pls.res$TExPosition.Data$t[4]
PlotScree(ev = pls.res$TExPosition.Data$eigs,
p.ev = resPerm4PLSC$pEigenvalues,
title = 'PLSC Music Features: Inertia Scree Plot',
plotKaiser = TRUE,
color4Kaiser = ggplot2::alpha('darkorchid4', .5),
lwd4Kaiser  = 2
)
a000.scree4plsc <-  recordPlot()
PlotScree(ev = pls.res$TExPosition.Data$eigs,
p.ev = resPerm4PLSC$pEigenvalues,
title = 'PLSC Music Features: Inertia Scree Plot',
plotKaiser = TRUE,
color4Kaiser = ggplot2::alpha('darkorchid4', .5),
lwd4Kaiser  = 2
)
a000.scree4plsc <-  recordPlot()
PlotScree(ev = pls.res$TExPosition.Data$eigs,
p.ev = resPerm4PLSC$pEigenvalues,
title = 'PLSC Music Features: Inertia Scree Plot',
plotKaiser = TRUE,
color4Kaiser = ggplot2::alpha('darkorchid4', .5),
lwd4Kaiser  = 2
)
a000.scree4plsc <-  recordPlot()
ps <- pls.res$TExPosition.Data$pdq$p
qs <- pls.res$TExPosition.Data$pdq$q
th <- .7
pslist <- vector(mode = "list", length = 2)
qslist <- vector(mode = "list", length= 2)
names(qslist) <- c("Dim1", "Dim2")
names(pslist) <- c("Dim1", "Dim2")
p.names <- rownames(ps)
q.names <- rownames(qs)
for (i in 1:2){
pslist[[i]] <- ps[which(abs(ps[,i]) > th*max(abs(ps[,i]))),i]
qslist[[i]] <- qs[which(abs(qs[,i]) > th*max(abs(qs[,i]))),i]
names(pslist[[i]]) <- p.names[abs(ps[,i]) > th*max(abs(ps[,i]))]
names(qslist[[i]]) <- q.names[abs(qs[,i]) > th*max(abs(qs[,i]))]
}
colors4plsc <- vector(mode = "list", length = 5)
names(colors4plsc) <- c("colors", "p.all","q.all","p.vec", "q.vec" )
colors4plsc$colors <- c(wes_palettes$Darjeeling1[c(1,2,4)],
wes_palettes$Darjeeling2[2])
colors4plsc$p.all <- ps
colors4plsc$p.all[colors4plsc$p.all > 0] <- colors4plsc$colors[1]
colors4plsc$p.all[colors4plsc$p.all != colors4plsc$colors[1]] <- colors4plsc$colors[2]
colors4plsc$q.all <- qs
colors4plsc$q.all[colors4plsc$q.all > 0] <- colors4plsc$colors[3]
colors4plsc$q.all[colors4plsc$q.all != colors4plsc$colors[3]] <- colors4plsc$colors[4]
colors4plsc$p.vec <- vector(mode = "list", length = 2)
colors4plsc$q.vec <- vector(mode = "list", length = 2)
names(colors4plsc$p.vec) <- c("Dim1", "Dim2")
names(colors4plsc$q.vec) <- c("Dim1", "Dim2")
for (i in 1:2){
colors4plsc$p.vec[[i]] <- colors4plsc$p.all[which(abs(ps[,i]) > th*max(abs(ps[,i]))),i]
colors4plsc$q.vec[[i]] <- colors4plsc$q.all[which(abs(qs[,i]) > th*max(abs(qs[,i]))),i]
}
loading1 <- PrettyBarPlot2(bootratio = c(pslist$Dim1, qslist$Dim1),
threshold = min(c(th*max(abs(ps[,1])), th*max(abs(qs[,1])))),
ylim = c(1.2*min(c(pslist$Dim1, qslist$Dim1)), 1.2*max(c(pslist$Dim1, qslist$Dim1))),
color4bar = c(colors4plsc$p.vec$Dim1, colors4plsc$q.vec$Dim1),
color4ns = "gray75",
plotnames = TRUE,
main = 'Loadings for variables for factor plot 1',
ylab = "Signed Loadings"
#font.size = 1
)
loading2 <- PrettyBarPlot2(bootratio = c(pslist$Dim2, qslist$Dim2),
threshold = min(c(th*max(abs(ps[,2])), th*max(abs(qs[,2])))),
ylim = c(1.2*min(c(pslist$Dim2, qslist$Dim2)), 1.2*max(c(pslist$Dim2, qslist$Dim2))),
color4bar = c(colors4plsc$p.vec$Dim2, colors4plsc$q.vec$Dim2),
color4ns = "gray75",
plotnames = TRUE,
main = 'Loadings for variables for factor plot 2',
ylab = "Signed Loadings",
#font.size = 1
)
grid.arrange(as.grob(loading1),
as.grob(loading2),
ncol = 2,nrow = 1
)
loads_plsc <- recordPlot()
PlotScree(ev = pls.res$TExPosition.Data$eigs,
p.ev = resPerm4PLSC$pEigenvalues,
title = 'PLSC Music Features: Inertia Scree Plot',
plotKaiser = TRUE,
color4Kaiser = ggplot2::alpha('darkorchid4', .5),
lwd4Kaiser  = 2
)
a000.scree4plsc <-  recordPlot()
ps <- pls.res$TExPosition.Data$pdq$p
qs <- pls.res$TExPosition.Data$pdq$q
th <- .7
pslist <- vector(mode = "list", length = 2)
qslist <- vector(mode = "list", length= 2)
names(qslist) <- c("Dim1", "Dim2")
names(pslist) <- c("Dim1", "Dim2")
p.names <- rownames(ps)
q.names <- rownames(qs)
for (i in 1:2){
pslist[[i]] <- ps[which(abs(ps[,i]) > th*max(abs(ps[,i]))),i]
qslist[[i]] <- qs[which(abs(qs[,i]) > th*max(abs(qs[,i]))),i]
names(pslist[[i]]) <- p.names[abs(ps[,i]) > th*max(abs(ps[,i]))]
names(qslist[[i]]) <- q.names[abs(qs[,i]) > th*max(abs(qs[,i]))]
}
colors4plsc <- vector(mode = "list", length = 5)
names(colors4plsc) <- c("colors", "p.all","q.all","p.vec", "q.vec" )
colors4plsc$colors <- c(wes_palettes$Darjeeling1[c(1,2,4)],
wes_palettes$Darjeeling2[2])
colors4plsc$p.all <- ps
colors4plsc$p.all[colors4plsc$p.all > 0] <- colors4plsc$colors[1]
colors4plsc$p.all[colors4plsc$p.all != colors4plsc$colors[1]] <- colors4plsc$colors[2]
colors4plsc$q.all <- qs
colors4plsc$q.all[colors4plsc$q.all > 0] <- colors4plsc$colors[3]
colors4plsc$q.all[colors4plsc$q.all != colors4plsc$colors[3]] <- colors4plsc$colors[4]
colors4plsc$p.vec <- vector(mode = "list", length = 2)
colors4plsc$q.vec <- vector(mode = "list", length = 2)
names(colors4plsc$p.vec) <- c("Dim1", "Dim2")
names(colors4plsc$q.vec) <- c("Dim1", "Dim2")
for (i in 1:2){
colors4plsc$p.vec[[i]] <- colors4plsc$p.all[which(abs(ps[,i]) > th*max(abs(ps[,i]))),i]
colors4plsc$q.vec[[i]] <- colors4plsc$q.all[which(abs(qs[,i]) > th*max(abs(qs[,i]))),i]
}
loading1 <- PrettyBarPlot2(bootratio = c(pslist$Dim1, qslist$Dim1),
threshold = min(c(th*max(abs(ps[,1])), th*max(abs(qs[,1])))),
ylim = c(1.2*min(c(pslist$Dim1, qslist$Dim1)), 1.2*max(c(pslist$Dim1, qslist$Dim1))),
color4bar = c(colors4plsc$p.vec$Dim1, colors4plsc$q.vec$Dim1),
color4ns = "gray75",
plotnames = TRUE,
main = 'Loadings for variables for factor plot 1',
ylab = "Signed Loadings"
#font.size = 1
)
loading2 <- PrettyBarPlot2(bootratio = c(pslist$Dim2, qslist$Dim2),
threshold = min(c(th*max(abs(ps[,2])), th*max(abs(qs[,2])))),
ylim = c(1.2*min(c(pslist$Dim2, qslist$Dim2)), 1.2*max(c(pslist$Dim2, qslist$Dim2))),
color4bar = c(colors4plsc$p.vec$Dim2, colors4plsc$q.vec$Dim2),
color4ns = "gray75",
plotnames = TRUE,
main = 'Loadings for variables for factor plot 2',
ylab = "Signed Loadings",
#font.size = 1
)
grid.arrange(as.grob(loading1),
as.grob(loading2),
ncol = 2,nrow = 1
)
loads_plsc <- recordPlot()
ctri <- pls.res$TExPosition.Data$ci*sign(pls.res$TExPosition.Data$fi)
ctrj <- pls.res$TExPosition.Data$cj * sign(pls.res$TExPosition.Data$fj)
conts.sigonly <- barplot.sigonly(x = ctri,
y = ctrj,
th = "mean",
type = "cont")
contribution1 <- PrettyBarPlot2(bootratio = conts.sigonly$data$Dim1,
threshold = conts.sigonly$t.hold$thr.tog,
ylim = conts.sigonly$data$y.limits$ylims.tog$Dim1,
color4bar = c(conts.sigonly$color$x.vec$Dim1, conts.sigonly$color$y.vec$Dim1),
color4ns = "gray75",
plotnames = TRUE,
main = 'Contributions to the First Latent Variables',
ylab = "Signed Contributions"
#font.size = 1
)
contribution2 <- PrettyBarPlot2(bootratio = conts.sigonly$data$Dim2,
threshold = conts.sigonly$t.hold$thr.tog,
ylim =conts.sigonly$data$y.limits$ylims.tog$Dim2,
color4bar = c(conts.sigonly$color$x.vec$Dim2, conts.sigonly$color$y.vec$Dim2),
color4ns = "gray75",
plotnames = TRUE,
main = 'Contributions to the Second Latent Variables',
ylab = "Signed Contributions",
#font.size = 1
)
grid.arrange(as.grob(contribution1),
as.grob(contribution2),
ncol = 1,nrow = 2
)
contributionsplsc <- recordPlot()
latvar.1 <- cbind(pls.res$TExPosition.Data$lx[,1],pls.res$TExPosition.Data$ly[,1])
colnames(latvar.1) <- c("Lx 1", "Ly 1")
zedesign <- adj.design$thedesign[-c(6,14)]
lescoleurs <- adj.design$ex.cols[-c(6,14)]
coleur4group <- adj.design$col4exgrp
# compute means
lv.1.group <- getMeans(latvar.1, zedesign)
# get bootstrap intervals of groups
lv.1.group.boot <- Boot4Mean(latvar.1, zedesign)
colnames(lv.1.group.boot$BootCube) <- c("Lx 1", "Ly 1")
#Next, we can start plotting:
plot.lv1 <- createFactorMap(latvar.1,
col.points = lescoleurs,
col.labels = lescoleurs,
alpha.points = 0.4, alpha.labels = 0.4,
text.cex = 3, title = "Latent Variable Plot 1"
)
plot1.mean <- createFactorMap(lv.1.group,
col.points = coleur4group,
col.labels = coleur4group,
cex = 4,
pch = 17,
alpha.points = 0.8,
text.cex = 6)
plot1.meanCI <- MakeCIEllipses(lv.1.group.boot$BootCube[,c(1:2),], # get the first two components
col = adj.design$col4exgrp,
names.of.factors = c("Lx 1", "Ly 1")
)
plot1 <- plot.lv1$zeMap_background + plot.lv1$zeMap_dots + plot.lv1$zeMap_text +
plot1.mean$zeMap_text + plot1.meanCI
latvar.2 <- cbind(pls.res$TExPosition.Data$lx[,2],pls.res$TExPosition.Data$ly[,2])
colnames(latvar.2) <- c("Lx 2", "Ly 2")
# compute means
lv.2.group <- getMeans(latvar.2, zedesign)
# get bootstrap intervals of groups
lv.2.group.boot <- Boot4Mean(latvar.2, zedesign)
colnames(lv.2.group.boot$BootCube) <- c("Lx 2", "Ly 2")
#Next, we can start plotting:
plot.lv2 <- createFactorMap(latvar.2,
col.points = lescoleurs,
col.labels = lescoleurs,
alpha.points = 0.4, alpha.labels = 0.4,
text.cex = 3, title = "Latent Variable Plot 2"
)
plot2.mean <- createFactorMap(lv.2.group,
col.points = coleur4group,
col.labels = coleur4group,
cex = 4,
pch = 17,
alpha.points = 0.8,
text.cex = 6)
plot2.meanCI <- MakeCIEllipses(lv.2.group.boot$BootCube[,c(1:2),], # get the first two components
col = coleur4group,
names.of.factors = c("Lx 2", "Ly 2")
)
plot2 <- plot.lv2$zeMap_background + plot.lv2$zeMap_dots + plot.lv2$zeMap_text +
plot2.mean$zeMap_text + plot2.meanCI
grid.arrange(as.grob(plot1),
as.grob(plot2),
ncol = 2,nrow = 1
)
plsc.fplot <- recordPlot()
wordcountaddin:::text_stats()
