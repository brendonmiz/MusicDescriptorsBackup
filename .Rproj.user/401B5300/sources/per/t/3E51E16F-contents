---
title             : "Cognitive Music Listening Space: A Multivariate Approach"
shorttitle        : "Music Descriptor Space"

author: 
  - name          : "Brendon Mizener"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "800 W. Campbell Rd., Richardson Tex"
    email         : "bmizener@utdallas.edu"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Stimuli creation
      - Survey design & creation
      - Data collection & processing
      - Statistical analyses
      - Writing - Original draft preparation
      - Writing - Review & Editing
  - name          : "Mathilde Vandenberghe"
    affiliation   : "2"
    role:
      - Original concept
      - Survey design & creation
      - Writing - Review & Editing
  - name          : "Hervé Abdi"
    affiliation   : "1"
    role:
      - Writing - Review & Editing
      - Statistical guidance
  - name          : "Sylvie Chollet"
    affiliation   : "2"
    role:
      - Original concept
      - Writing - Review & Editing

affiliation:
  - id            : "1"
    institution   : "University of Texas at Dallas"
  - id            : "2"
    institution   : "Junia, Univ. Artois, Université de Liège, Univ. Littoral Côte d’Opale, UMRT 1158 BioEcoAgro, F-62000 Arras, France"

authornote: |
  The authors have no conflict of interest to report. This study was approved by the UT Dallas IRB as initial submission 21-112. Additional material, including stimulus examples and datasets, can be found at github.com/brendonmiz/musicdescriptors_supp.

abstract: |
  French and American participants listened to new music stimuli and evaluated the stimuli using either adjectives or quantitative musical dimensions. Results were analyzed using Correspondence Analysis (CA), Hierarchical Cluster Analysis (HCA), Multiple Factor Analysis (MFA), and Partial Least Squares Correlation (PLSC). French and American listeners differed when they described the musical stimuli using adjectives, but not when using the quantitative dimensions. The present work serves as a case study in research methodology that allows for a balance between relaxing experimental control and maintaining statistical rigor.
  
keywords          : "Music, Cognition, Multivariate Analyses, Correspondence Analysis, Hierarchical Cluster Analysis, Multiple Factor Analysis, Partial Least Squares Correlation"
wordcount         : "7271"

bibliography      : ["Music Descriptor Space with R.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no

documentclass     : "apa6"
csl               : "apa7.csl"
classoption       : "man"
output            : 
  papaja::apa6_pdf: 
    latex_engine    : "xelatex"
header-includes   :
          - \usepackage{caption}
          - \usepackage{subcaption}
          - \usepackage{wrapfig}
nocite: |
  @Katz1933, @Meyners2014, @Coombs1956, @Valentin2012, @Escofier-Cordier1965, @Benzecri1973, @Greenacre1984, @Pielou1984, @Borg2005, @Abdi2013, @Escofier1994, @Tucker1958, @Abdi2013a, @Abdi2018b, @Gower1966, @Torgerson1958, @R-base, @R-papaja, @R-PTCA4CATA, @R-abind, @R-dplyr, @R-ExPosition, @R-forcats, @R-ggplot2, @R-gridExtra, @R-InPosition, @R-kableExtra, @R-plyr, @R-prettyGraphs, @R-purrr, @R-readr, @R-readxl, @R-rlist, @R-stringi, @R-stringr, @R-tibble, @R-tidyr, @R-tidyverse, @R-wesanderson, @R-data.table, @R-corrplot2017, @R-data4PCCAR, @R-FNN, @R-TExPosition, @R-TInPosition, @R-apaTables, @R-MExPosition, @R-pander, @R-glue, @R-flextable, @R-sylly 
---



```{r setup, include = FALSE}
rm(list = ls())
gc()

# Seed for random number generation
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message=FALSE, fig.align = "center",cache.extra = knitr::rand_seed)
set.seed(42)

papaja::r_refs("r-references.bib")
```

```{r analysis-preferences}
library("papaja")
suppressMessages(library(ExPosition))
suppressMessages(library(InPosition))
suppressMessages(library(MExPosition))
library(PTCA4CATA)
library(purrr)
library(plyr)
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
library(rlist)
library(wesanderson)
#library(kableExtra)
library(ggplotify)
library(gridExtra)
library(grid)
library(abind)

```

```{R graphPath}
powerpointFilename <- 'Music-Descriptor-Space.pptx'
path2pptx    <- './Analysis/'
name4Graphs  <- paste0(path2pptx,powerpointFilename)
title4Graphs <- 'Music Descriptor Space '
```


```{r citations, eval = FALSE, echo=FALSE, include=FALSE}




```

  We have a data collection problem: World events over the last year have shown that we need to be able to collect good data outside of the lab. In the lab, because we control error sources, we measure, on relatively small sets of observations, a few well-defined, quantitative variables, analyzed using standard techniques such as analysis of variance (ANOVA). But, with the labs closed (remember COVID?), how can we collect good data? Away from the controlled environment of the lab, quantitative variables are hard to measure, but we can collect, on large sets of observations, qualitative variables that can only be analyzed by newer multivariate techniques. In the present paper, we present a case study illustrating this tradeoff.  

  In 2004, Zampini and Spence demonstrated that something as simple as the sound of a crunch when eating a potato chip could influence its taste [@Zampini2004]. What about a signal as complex as a string quartet? The present study was designed to quantify a music listening "space" that captures objective stimulus and cognitive dimensions to use in future studies investigating cross-modal sensory mapping between food and music. 

  For the present study, we have defined stimulus dimensions as quantitative musical qualities, such as tempo, range, and meter and cognitive dimensions as qualitative descriptions of music, such as "Dark", "Warm", and "Round". These cognitive/qualitative dimensions are similar to the commonly investigated affective or emotional dimensions, but do not specifically assess affective quality. To quantify individual and combined spaces for these concepts, we ran three separate experiments. The first experiment included highly trained musicians and featured a multiple-choice survey about the stimulus dimensions; the second experiment included participants with any level of music training performing a check-all-that-apply task (CATA, Katz & Braly, 1933; Meyners & Castura, 2014; Coombs et al., 1956); and the third experiment incorporated both surveys in a single analysis.  
  
  To analyze our data, we selected a set of multivariate analyses that can visualize the answers to each of our questions. These multivariate analyses reduce the dimensionality of a data set by computing new variables---called dimensions, components, or factors---that extract the important information in the table. With these new variables, the original observations (and variables) can  be plotted as points in maps that can be interpreted as *conceptual* or *mental spaces* because they represent the similarity among variables or observations by their inter-distances [@Abdi2010d].
  
  These mental spaces were analyzed with Correspondence Analysis (CA)---a method similar to Principal Components Analysis (PCA)---created to analyze qualitative data. We used Multidimensional Scaling (MDS)---a distance analysis method---to visualize the differences between participants and participant groups. To find parallels between the surveys, we used Partial Least Squares Correlation (PLSC)---a method created to analyze two data tables comprising different sets of variables measured on the same set of observations. Finally, we used Multiple Factor Analysis (MFA) to evaluate how French and American participants' responses differed. Each of these methods provided different visualizations and interpretations of the data, which are discussed in more detail below.
 
## Music Perception

  Quantifying music perception is an interesting test case for this kind of data gathering and analytical paradigm. Most music or auditory perception studies have the inherent confound that small changes can affect listeners' perception, especially when the study involves timing, tuning, or sound localization. However, the experimental controls may be loosened slightly when investigating holistic music listening, because no single musical element is more important than the whole.  
  
  Quantitative and qualitative elements of music are theoretically distinct but practically inseparable [@BrunerII1990]. Listeners respond affectively to technical aspects of music using schemata informed by their individual musical experiences and personality traits [@Kopacz2005], and composers use various musical and compositional techniques to convey the emotions they want to express [@BrunerII1990; @Battcock2019]. However, quantifying the perceptual interactions between more than one or two musical qualities is a challenge. One reason is that models such as ANOVA and its variations are limited by how many variables a researcher can include while remaining coherent. Another reason is that asking participants to respond to multiple aspects of a stimulus taxes participants' perceptual capacity and is thus difficult to measure [@Thompson1994].  
  
  Music emotion research---in contrast to the research mentioned above---has attempted to capture a more multifaceted perspective on music listening. This is a well trod domain---see, for example @Juslin2010---and the application of multivariate analyses to these questions is similarly well established. Early studies, including @Gray1967, @Wedin1969, and @Wedin1972 used MDS to capture the affective space of various musical stimuli. MDS continues to be used commonly in more modern studies [@Madsen1997; @Bigand2005; @Roda2014], with a narrow focus on valence and arousal, which were the dimensions originally proposed to be the most salient for perception by @Osgood1955. 
  
  A few studies have specifically investigated dimensions beyond those first two (for example Rodà et al., 2014), and there are conflicting hypotheses about whether the valence-arousal plane or a different model of emotion perception represent the fundamental space around music emotion perception [@Juslin2008a; @Cowen2020]. However, an important distinction between the present study and work in music emotion perception is that the adjectives we chose were informed by music composition and performance, rather than by emotion [@Wallmark2019]. 
  
  With regard to musical expertise, many studies evaluate the differences between trained and untrained listeners, but the verdict is still out as to whether trained musicians are better listeners, an issue that could be due to multiple views of how much training is required for a participant to be "highly trained" [@Bigand2006]. There are, however, reported benefits with regard to sensitivity to the emotional content in music [@Ladinig2012] and familiarity with tonal systems [@Dowling1978a; @Bartlett1980a]. Recent works suggest that these benefits may be limited to specific technical aspects, and depend on the extent of training (Raman & Dowling 2017). Although we do not specifically evaluate the differences between trained and untrained listeners in the present study, we included highly trained musicians because they are sensitive to these technical aspects of music and will be able to accurately quantify the stimuli. Additionally, some of the response options to questions on the survey for Experiment 1 would only be familiar to participants with significant music training.   
  
  
### Intercultural music perception

  There are a few common goals in intercultural studies of music perception. Some quantify the shared emotional experience between musical cultures [@Fritz2009; @Balkwill1999; @Cowen2020; @Gregory1996; @Darrow1987; @Balkwill2004], and some ask participants to identify technical aspects of music from other cultures [@Raman2016; @Raman2017]. There are fewer studies that include the semantics of language in their evaluation of music perception [@Zacharakis2014; @Zacharakis2015], which makes this a prime area for research.  
  
  The research program presented in Zacharakis et al. (2014, 2015) deals specifically with timbre perception, and their use of adjectives is similar to the way we use adjectives here. In Zacharakis et al. (2014, 2015), Greek and English participants described timbre with adjectives from their native languages. These studies found that while there are some differences, overall, participants' descriptions of timbre do not differ much between languages [@Zacharakis2014; @Zacharakis2015]. 

## Present questions & methods of analysis

  The primary question addressed in this study is: Can we quantify a cognitive space around music listening defined by both stimulus and cognitive dimensions of music? Secondary questions include whether French and American participants describe music differently, and whether these differences may arise from cultural differences in music listening or preferences, or are purely semantic. To answer these questions, we employed a set of multivariate analyses that each offered a different perspective on the experimental results. We felt it may be useful to provide a quick overview of the data collection and analytical techniques for readers who may be unfamiliar with these methods.  

### Check-all-that-apply (CATA)

  The CATA technique---a method widely used in sensory evaluation (and elsewhere but under different names: Coombs et al., 1956; Katz & Braly, 1933; Meyners & Castura, 2014; Valentin et al., 2012)---measures how participants describe a set of stimuli. In a CATA task, stimuli are presented one at a time, and for each stimulus, participants are shown a list of descriptors and are asked to select the descriptors that apply to the presented stimulus [@Meyners2014]. CATA easily assesses questions with multiple "correct" responses [@Coombs1956], and places little cognitive demand on participants because they do not have to generate responses [@Ares2010].  
  CATA data are analyzed by 1) computing a pseudo contingency table that records the number of times descriptors were associated with stimuli and 2) analyzing this data table with Correspondence Analysis in order to visualize the patters of association between a) stimuli, b) descriptors, and c) stimuli and descriptors.  
  
### Correspondence Analysis

  The primary analysis used on the stimulus response data collected in the surveys is Correspondence Analysis (CA, Benzécri, 1973; Escofier-Cordier, 1965; Greenacre, 1984). CA analyzes a contingency table, or any data structured similarly, and computes the relationships between rows (observations) and columns (variables); in our case between musical excerpts and descriptors. The nature of CA allows for observations and variables to be visualized in the same space.  
  
### Hierarchical Cluster Analysis
  
  Hierarchical Cluster Analysis (HCA, Pielou, 1984) identifies groups, or clusters, of observations from the rows of a distance matrix, because HCA displays these observations as "leaves" on a tree computed to best represent the original distances. This method was used here to determine whether there were clusters of excerpts or adjectives that arose during participant ratings. These clusters were used as design or grouping variables and to select colors for visualizations.   
  
### Multidimensional Scaling

  Multidimensional Scaling (MDS, Borg & Groenen, 2005; Gower, 1966; Torgerson, 1958)---a technique commonly used in music perception studies [@Wedin1969; @Wedin1972; @Roda2014; @Madsen1997; @Bigand2005] analyzes a distance matrix computed between observations and visualizes these observations by positioning them on a map such that the distance between observations on the map best approximates their distance in the data table. Here, this technique is used as an omnibus method to evaluate similarity between groups of participants.   

### Multiple Factor Analysis

  Multiple Factor Analysis (MFA, Abdi et al., 2013; Escofier & Pagès, 1994) extends PCA to analyzes and visualizes multiple tables or blocks of variables that each describe the same observations. MFA computes a *compromise* and a set of *partial factor scores*, where the *compromise* is the average of (or compromise between) the normalized factor scores from each block, and the *partial factor scores* are the factor scores of each individual block. Plotting these factor scores allows for the comparison of observations (rows), and, for each observation, the relationships between the blocks of variables that contributed to that observation. The basic difference between MFA and PLSC is that PLSC extracts commonalities between two data tables, whereas MFA extracts similarities and differences between two or more data tables. In the present study, MFA was used to evaluate differences between French and American participants in how they described specific excerpts and used specific adjectives.   
  
### Partial Least Squares Correlation

  Partial Least Squares Correlation (PLSC, Abdi & Williams, 2013; Tucker, 1958) analyzes two data tables that describe the same set of observations (rows) with two different sets of variables (columns). To extract the common information between the two data tables, PLSC separately combines the variables from each data table to create new variables---similar to factor scores and called *latent variables*---that have the largest covariance. This method is commonly used in neuroimaging studies to extract the common information between imaging and behavioral data [@Krishnan2011]. It was used in the present study to evaluate the similarities in how participants in either survey rated the excerpts.   

### Bootstrapping

  We use bootstrapping [@Hesterberg2011] to evaluate group differences because the methods outlined above are not inferential methods, and do not inherently allow for hypothesis testing. Bootstrapping evaluates the stability of the result of an experiment. This is displayed in the form of confidence intervals, as ellipses, in the plots below, computed from resampling the original observations [@Hesterberg2011].

# Experiment 1: Musical Qualities Survey

## Methods

### Participants

For the first experiment, we recruited highly trained musicians with a minimum of 10 years of formal music training to evaluate the stimulus dimensions or musical qualities, and to ascertain whether these stimuli truly reflected the composer's intent of varying on a wide range of musical dimensions [@Raman2017]. Participants in the United States and in France were recruited by word of mouth and social media. There was a total of 84 responses to the survey, of which 57 were removed for not completing the survey, leaving a total of 27 ($N\mathrm{_{France}}$ = 9, $N\mathrm{_{USA}}$ = 18) for the analysis.  All recruitment measures were approved by the UT Dallas IRB.

### Stimuli
  
  All stimuli were new, original excerpts composed---in various Western styles using Finale composition software (Finale v25, MakeMusic, Inc.)---by the first author specifically for this study (scores and audio files available upon request). Each stimulus was a wav file generated using the Finale human playback engine, approximately 30 s in length (range: 27-40 s, *M* = 32.4 s). The stimuli were all string quartets, a choice made to control for effects of timbre and otherwise vary on a number of musical qualities, specifically Harmony, Tempo, Meter, Density, and Genre. 
  
### Survey

  American and French participants received links to surveys presented via Qualtrics in (respectively) English and French. Participants were instructed to listen to the excerpts presented in the survey using headphones or in a quiet listening environment, but this was not controlled, nor was it assessed as part of the survey. After standard informed consent procedures, participants listened to 15 of the 30 excerpts, presented one at time in a random order, and answered ten questions per excerpt, one for each of the musical qualities being assessed. The musical qualities assessed and the levels associated with each quality are indicated in Table \@ref(tab:qualitiestable). Of these dimensions being assessed, all were multiple choice, allowing for a single response, except for meter, contour, and articulation, which were check-all-that-apply (See supplementary materials for the French translations of this table). Upon completion of the experimental task, participants were asked to provide demographic data, including age, gender identity, nationality, occupation, and musical experience.
  
```{=latex}

\begin{lltable}
\begin{scriptsize}
\begin{longtable}{p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}}\noalign{\getlongtablewidth\global\LTcapwidth=\longtablewidth}
\caption{\label{tab:qualitiestable}Musical Qualities and the provided survey response options.}\\
\toprule[.8pt]
 \multicolumn{1}{c}{Harmonic Material} & \multicolumn{1}{c}{Tempo} & \multicolumn{1}{c}{Meter} & \multicolumn{1}{c}{Density} & \multicolumn{1}{c}{Genre} & \multicolumn{1}{c}{Articulation}\\
 \midrule
      Diatonic: Major & Very slow & Simple Duple & Very sparse & Baroque & Staccato \\
      Diatonic: Minor & Slow & Simple Triple & Moderately sparse & Classical & Marcato \\
      Blues & Moderately Slow & Simple Quadruple  & More sparse than dense & Romantic & Legato\\
      Chromatic & Moderate & Compound Duple & More dense than sparse & Impressionist & Tenuto\\
      Whole tone & Moderately Fast & Compound Triple & Moderately Dense & Modern & Other \\       
      Modal  & Fast & Compound Quadruple & Very Dense & Jazz/Blues & \\
      Quintal/Quartal  & Very Fast & Complex & & Contemporary & \\
      Ambiguous  & & & & Other & \\
      Other  & & & & & \\
\bottomrule\addlinespace[.5em]
 & \multicolumn{1}{c}{Contour} & \multicolumn{1}{c}{Motion} & \multicolumn{1}{c}{Range} & \multicolumn{1}{c}{Dynamics} & \\
 \cmidrule[.5pt]{2-5}
  & Ascending & Conjunct & Narrow & Soft & \\
  & Descending & Disjunct & Moderate & Moderate  & \\
  & Arch & \multirow{2}{0.2\textwidth}{Combination of conjunct and disjunct} & Wide & Loud  & \\
  & Undulating &  & Very Wide & \multirow{2}{0.2\textwidth}{Varied: gradual crescendo} &\\
  & Pendulum & \multirow{2}{0.2\textwidth}{I do not think this excerpt has a melody} & \multirow{2}{0.2\textwidth}{I do not think this excerpt has a melody} &  &\\
  & Terrace & & & \multirow{2}{0.2\textwidth}{Varied: gradual decrescendo} & \\
  & \multirow{2}{0.2\textwidth}{I do not think this excerpt has a melody} & Other & & &\\
  & & & & \multirow{2}{0.2\textwidth}{Some of each, soft and loud}   & \\
  & Other & & & & \\
  & & & & Other & \\
  
\cmidrule[.75pt]{2-5}
\end{longtable}
\end{scriptsize}
\end{lltable}
```


### Data Processing

  To process the data, survey responses were converted into a "brick" of data, with the excerpts on the rows, the qualities on the columns, and the participants on the pages (See Figure \@ref(fig:dataflow)). For the current experiment, one quality is one variable, and we refer to the response options as levels of that variable. On any page, at the intersection of any row and column was a one or a zero, with a one indicating that this participant had selected this level of this quality (column) to describe this excerpt (row). The responses in the French "brick" were all translated into English, and then the bricks from both nationalities were summed together across pages to obtain a single pseudo-contingency table^[Whereas, in a contingency table, there is one and only one "1" in each row---a pattern indicating that each observation (row) is associated with a single variable (column)---by contrast, in a pseudo-contingency table, there are as many ones as variables the participant decided were associated with that observation.] in which the intersection of a row and a column was the total number participants who selected a level of a musical quality to describe an excerpt. Levels for which the column sum was equal to one were considered as outliers and removed from the data. 
  

```{=latex}
\begin{figure}   
  \centering  
  \caption{Survey data processing flowchart. In the top table, participants are in rows and excerpts are in blocks of columns. Purple cells indicate that participants were presented with and responded to an excerpt, gray cells indicate that participants were not presented with an excerpt.}
    \includegraphics[width=1\columnwidth]{./Music-Descriptor-Space_files/figure-latex/dataflow.png}
  \label{fig:dataflow}
  \caption*{\footnotesize }
\end{figure}
```  

  After removing these columns, preliminary visualizations revealed a few variables that required recoding because they were having an outsized effect on the analysis. For the "Meter", variable, there were initially seven levels: "Simple Duple", "Simple Triple", "Simple Quadruple", "Compound Duple", "Compound Triple", "Compound Quadruple", and "Complex", but some participants misunderstood this question and selected multiple options for each level of "Duple", "Triple" or "Quadruple". These responses were recoded, removing "Simple", "Compound" and "Complex", (there were no excerpts with complex meter), and collapsed, so that each excerpt had only one meter response per participant, "Duple", "Triple", or "Quadruple".  
  
  There were multiple qualities for which a possible response was "I do not think this excerpt has a melody", and this pattern created a problem in which multiple columns represented the same response, which had a similar effect to the one caused by the "Meter" variable before it was recoded. To avoid this problem, these responses were also recoded. A new variable, "Melody", was created, with two levels/columns, yes and no, and if participants responded "I do not think this excerpt has a melody" to any of the Contour, Motion, or Range variables, a one was counted in the "No" column for that participant and that excerpt. The other levels for each of these three variables were then recoded so that each other column for that variable in that row had the value of one divided by the number of options for that variable---a procedure called barycentric recoding. If the participant responded with "I do not think this excerpt has a melody" for some but not all three of those variables, a one was still counted in the "no melody" column, but only the variables for which "I do not think..." was selected were recoded using barycentric recoding. For all excerpts and participants for which "I do not think..." was never selected, a one was added to the "Yes" column for the melody variable. Once the data were recoded, the brick was once again summed across pages to obtain the data table that would be used for subsequent analyses. 

### Analysis
  
  To analyze the similarity structure between participants, we computed a co-occurrence matrix from the brick with participants on the rows and columns, such that the intersection of a row and column represented the number of common choices between participants. This co-occurrence matrix was then analyzed using MDS.  
  
  To analyze the excerpts and musical qualities and obtain the music quality space, we performed a CA on the contingency table. To identify potential clusters among the excerpts, we ran an HCA on the row factor scores obtained from the CA.
  
```{r importQualdata}

load("catadatamusdim.RData")
musdimdata <- catadata.list$contingency#[,order(colnames(catadata.list$contingency))]
numberofdims <- catadata.list$numberofdims#[order(names(catadata.list$numberofdims))]
thebrick <- catadata.list$thebrick#[,order(colnames(catadata.list$contingency)),]

rows2drop <- c(6,14) 

musdimdata.no6 <- musdimdata[-rows2drop,]
thebrick.no6 <- thebrick[-rows2drop,,]

```

```{r Q.parts}

# reorder some of the columns in the french experts dataset, 
# taking only the ones we want to analyse for now
fr.ex.data <- catadata.list$french.expert.data[c(1:3,6,7,9:12),c(1,4,5,6,7)]
colnames(fr.ex.data) <- c("age", "gen", "nat", "tr_yrs", "tr_type")
fr.ex.data$gen[which(fr.ex.data$gen == "Homme")] <- "M"
fr.ex.data$gen[which(fr.ex.data$gen == "Femme")] <- "F"
fr.ex.data$nat <- "France"
fr.ex.data$tr_type[which(fr.ex.data$tr_type == "Instrumentale")] <- "Inst"
fr.ex.data$tr_type[which(fr.ex.data$tr_type == "Vocale")] <- "Voc"

am.ex.data <- catadata.list$expert.data[,c(1:3,6,7)]
colnames(am.ex.data) <- colnames(fr.ex.data)
am.ex.data$nat <- "USA"
am.ex.data$gen[which(am.ex.data$gen == "Male")] <- "M"
am.ex.data$gen[which(am.ex.data$gen == "Female")] <- "F"
am.ex.data$tr_type[which(am.ex.data$tr_type == "Instrumental")] <- "Inst"
am.ex.data$tr_type[which(am.ex.data$tr_type == "Vocal")] <- "Voc"

# Bind it all together
ex.data <- rbind(am.ex.data, fr.ex.data)

bygender <- as.factor(ex.data$gen)
bynationality <- as.factor(ex.data$nat)




```

```{r Q.ca, cache = T, message=FALSE, warning=FALSE, include = FALSE}

dimcares.inf <- epCA.inference.battery(musdimdata.no6, 
                 masses= NULL, weights= NULL, 
                 hellinger = FALSE, symmetric = TRUE, 
                 graphs =FALSE, test.iters = 1000)

# Factor Scores
FIsym  <- dimcares.inf$Fixed.Data$ExPosition.Data$fi
#FIasym <- RenormFi$G_A
FJs    <- dimcares.inf$Fixed.Data$ExPosition.Data$fj
CA.Q.Eigs <- dimcares.inf$Fixed.Data$ExPosition.Data$eigs
CA.Q.pEig <- dimcares.inf$Inference.Data$components$eigs.perm
```

```{r someQcolors}
# Participant colors:
col4M <- wes_palettes$Zissou1[1]
col4F <- wes_palettes$Zissou1[5]
col4FR <- wes_palettes$Darjeeling2[2]
col4AM <- wes_palettes$Darjeeling1[1]
# 
col4byG <- as.character(bygender)
col4byG[col4byG == "F"] <- col4F
col4byG[col4byG == "M"] <- col4M

col4byN <- as.character(bynationality)
col4byN[col4byN == "France"] <- col4FR
col4byN[col4byN == "USA"] <- col4AM

# To account for the fact that we removed some rows above:
#numberofdims[c(1,3,7,10,11)] <- c(6,7,8,3,4)
#numberofdims <- numberofdims[-2]

#numberofdims[c(1,7,8,9,10)] <- c(8,7,3,4,6)

#numberofdims <- numberofdims[-11]


col4cols <- wes_palette("FantasticFox1", 
                        length(numberofdims), type = "continuous")
col4cols <- rep(col4cols, numberofdims)

```

```{r bootQCA, cache=TRUE}

bootCA <- Boot4PTCA(ZeDataCube = thebrick.no6,
           fi = FIsym,
           fj = FJs,
           eigs = CA.Q.Eigs,
           nf2keep = 3,
           nBootIter = 500)
# Compute Bootstrapped ratios
bootRatios.I <- PTCA4CATA::boot.ratio.test(bootCA$RowsBoot,
                                            critical.value = 2)
bootRatios.J <- PTCA4CATA::boot.ratio.test(bootCA$ColumnsBoot,
                                              critical.value = 2)
# Probabilities 
probBR.I  <- bootRatios.I$prob.boot.ratios
probBR.J  <- bootRatios.J$prob.boot.ratios
```

```{r ca4Judges.Q}
# We have a problem here because most matrices
#  have lines with zeros. A symmetric difference matrix 
#  would do better than an RV or a 
#  chi2 distance so we use createSymDist4PTCA

Cmat.Q <- createSymDist4PTCA(thebrick)$CrossProduct

# Calculate the eigenvalues and the percentage of variance extracted (tau)
eigenCmat.Q <- eigen(Cmat.Q, symmetric = TRUE)
eig4Cmat.Q <-  eigenCmat.Q$values
tau4Cmat.Q <- round( (100*eig4Cmat.Q) / sum(eig4Cmat.Q))

# Calculate factor scores for the first three dimensions
nk       <- 3
F4Cmat.Q   <- eigenCmat.Q$vectors[,1:nk] %*% diag(eig4Cmat.Q[1:nk]^(1/2))

# Prep for plotting
Shortnames4Participants.Q <-  dimnames(thebrick[[3]])
rownames(F4Cmat.Q) <- Shortnames4Participants.Q

# Make labels
labels4RV.Q <- createxyLabels.gen(1,2,lambda = eig4Cmat.Q, tau = tau4Cmat.Q)

```


```{r ttest4Dpart}

D.dim14ttest <- F4Cmat.Q[,1]
D.dim24ttest <- F4Cmat.Q[,2]

d.test1 <- aov(D.dim14ttest ~ bynationality) %>% apa_print
d.test2 <- aov(D.dim24ttest ~ bynationality) %>% apa_print


```


## Results

### Participants

  The MDS performed on the co-occurrence matrix of participants was intended to identify potential clusters of participants. Visual examination of the results did not reveal any clusters---a pattern suggesting that the participants constituted a homogeneous group. To confirm this conclusion, we also computed average factor scores by nationality and gender identity and bootstrap-derived confidence intervals around these averages and did not find any significant differences (See supplementary materials for plots). 

```{=latex}
\begin{figure}  
  \begin{center}
  \caption{CA: Scree plot for the Qualities Survey, showing percentage of explained variance per dimension. The horizontal line indicates the average variance extracted per dimension}
    \includegraphics[width=0.6\columnwidth]{./Music-Descriptor-Space_files/figure-latex/scree4excerptsq-1.png}
  \label{fig:scree4excerptsq}  
 \end{center}
\end{figure}
```

### Excerpts

```{r getQeigs}
dim1eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[1]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)

dim2eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[2]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)

dim3eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[3]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)

dim4eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[4]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)
```
```{r scree4excerptsq, include = FALSE}
mus.scree <- PlotScree(ev = dimcares.inf$Fixed.Data$ExPosition.Data$eigs, 
                       p.ev = dimcares.inf$Inference.Data$components$p.vals, 
                       plotKaiser = T, color4Kaiser = "red", title = " "
                                              ) 

mus.00.scree <- recordPlot()

```


  The results of the CA performed on the contingency table revealed two significant dimensions, accounting together for `r sum(dim1eigperc, dim2eigperc)`% of the total variance. Figure \@ref(fig:scree4excerptsq) displays the scree plot, which shows for this analysis the percentage of variance explained by each dimension.  
  
```{r factormapsQbuild, fig.height = 10, fig.show = 'hold', out.width='75%'}


load("excerptsdesign.RData")

col4exgrp <- excerptsdesign$ex.design$col4exgrp
ex.cols <- excerptsdesign$ex.design$ex.cols

names(col4exgrp) <- rownames(musdimdata.no6)

axisone = 1
axistwo = 2

rownames(FIsym)<- c(1:5,7:13,15:30)
unsignedCJ <- dimcares.inf$Fixed.Data$ExPosition.Data$cj[,1:2]
signedCJ <- dimcares.inf$Fixed.Data$ExPosition.Data$cj * sign(FJs)

sig.colsonly <-  rownames(FJs)[(unsignedCJ[,1] > (1/nrow(FJs))) | 
                                 (unsignedCJ[,2] > (1/nrow(FJs))) ]

sig.FJs <- FJs[sig.colsonly,1:5]

col4sigcolsonly <- col4cols[(unsignedCJ[,1] > (1/nrow(FJs))) | 
                              (unsignedCJ[,2] > (1/nrow(FJs))) ]

mat6 <- as.matrix(catadata.list$contingency[c(6,14),])
colnames(mat6) <- colnames(catadata.list$contingency)

#test <- epCA(musdimdata.no6, 
#                  masses= NULL, weights= NULL, 
#                 hellinger = FALSE, symmetric = TRUE, 
#                 graphs =FALSE)

proj6 <- supplementaryRows(mat6, dimcares.inf$Fixed.Data)

rownames(proj6$fii) <- c("6","14")

scoresw6 <- rbind(FIsym, proj6$fii)

cols4proj <- c(col4exgrp, gplots::col2hex(c("blueviolet", "blueviolet")))

desc_groups <- excerptsdesign$ex.design$col4exgrp

dgf <- excerptsdesign$ex.design$thedesign

desc_groups[dgf == "ex.group1"] <- "Group 1"
desc_groups[dgf == "ex.group2"] <- "Group 2"
desc_groups[dgf == "ex.group3"] <- "Group 3"
desc_groups[dgf == "ex.group4"] <- "Group 4"
desc_groups <- c(desc_groups, "Projected", "Projected")
desc_groups <- as.factor(desc_groups)
#ti.qs.12 <- MakeToleranceIntervals(scoresw6, design = desc_groups, col = unique(cols4proj))
#+ ti.qs.12
exmap.sym.12 <- createFactorMapIJ(scoresw6,
                                sig.FJs,
                                axis1 = axisone,axis2 = axistwo,
                                col.points.i = cols4proj, 
                                col.labels.i = cols4proj, 
                                col.points.j = col4sigcolsonly, 
                                col.labels.j = col4sigcolsonly,
                                text.cex.i = 4, text.cex.j = 4,
                                cex.i = 4, cex.j = 4,
                                font.face.j = "italic",
                                alpha.labels.i = 1, alpha.labels.j = 1
                                )

vc.labels.12 <- createxyLabels(resCA = dimcares.inf$Fixed.Data, x_axis = axisone, y_axis = axistwo)

mus.012.i <- exmap.sym.12$baseMap +  
              exmap.sym.12$I_points + 
                exmap.sym.12$I_labels + 
                  vc.labels.12 + ggtitle('Excerpts') + 
                theme(plot.title = element_text(size = 18, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"))
                    

mus.012.j <- exmap.sym.12$baseMap +  
              exmap.sym.12$J_points + 
                exmap.sym.12$J_labels + 
                  vc.labels.12 + ggtitle('Musical Qualities') + 
                theme(plot.title = element_text(size = 18, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"))

#print(mus.012.i)
#print(mus.012.j)

#mus.012.023 <- recordPlot()
```

  Preliminary plots of the factor scores obtained from the CA revealed that Excerpts 6 and 14 distorted the factor space, with these two excerpts dominating the second and third dimensions. To help interpret the factor space, these two excerpts were removed from the data and the CA was rerun. Excerpts 6 and 14 were then added back in as *supplementary observations* (see Abdi & Béra, 2018 for details), a technique which visualizes the information these elements share with the elements retained in the main sample without distorting the factor space. The proximity of these supplementary observations to the origin helps identify how much information is shared with the rest of the sample. The closer the supplementary observations are to the origin, the less information they share with the rest of the sample.  
  
  The HCA performed on the row factor scores of the CA revealed four clusters of excerpts (see supplementary materials for the tree diagram). Figure \@ref(fig:factormapsQ) displays the first two factorial dimensions and the row factor scores calculated by the CA, colored according to the clusters revealed by the HCA, with Excerpts 6 and 14 as supplementary observations colored separately. Figure \@ref(fig:factormapsQ) also displays the column factor scores for the qualities calculated by the CA (right), with the levels of a given quality colored the same. For clarity, only the levels of qualities that contributed significantly (see below, and Figure \@ref(fig:contributionsQ)) are displayed.

  The proximity between two points in Figure \@ref(fig:factormapsQ) indicates their similarity when these points are on the same map. Because the CA computes a space common to both rows and columns, points on different maps can also be compared. Proximity between points on separate maps reflects their association relative to the average, for example Excerpt 24 is more associated with Legato articulation than is the average excerpt [@Abdi2010d]. 

```{r factormapsQcode, fig.width=12}
##grid.arrange(
#    as.grob(mus.012.i),as.grob(mus.012.j),
#    ncol = 2,nrow = 1#,
   # top = textGrob("Symmetric Maps of the Row and Column Factor Scores", gp = gpar(fontsize = 18, font = 3))
#  )

```  

```{=latex}
\begin{figure}   
  \centering  
  \caption{CA: Musical Qualities Survey, factor plots for Excerpts, colored according to clusters identified by the HCA, and important musical qualities, colored such that levels of each quality are the same color. Axes are labeled with the dimension, eigenvalue, and the explained variance for the dimension.}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/factormapsQcode-1.png}
  \label{fig:factormapsQ}
\end{figure}
```


  To evaluate the relative importance of the excerpts and musical qualities in defining each dimension, we computed their *contributions* to the dimensions. Contributions are similar to squared coefficients of correlation and vary between zero and one with zero indicating no importance and one indicating maximum importance [@Abdi2010d]. Contributions---being squared---are positive, but to facilitate interpretation contributions are signed to express the sign of the corresponding factor scores. Contributions whose magnitude is larger than the average contribution (i.e., 1 divided by the number of scores) are considered important for their factorial dimensions. A plot of the contributions for all excerpts and variables is in the supplementary materials.  
  
  Figure \@ref(fig:contributionsQ) shows only the contributions of excerpts and qualities important for the first two dimensions. For Dimension 1---ordered by magnitude---Excerpts 26, 4, 23, and 13 contribute to the positive side of the dimension, whereas Excerpts 24, 3, 10, 27, and 7 contribute to the negative side of the dimension. Low tempi (tempo.F2 and tempo.F1) contribute to the negative side, along with legato (smooth) articulation and soft dynamics. Finally, high tempi contribute to the positive side, along with marcato (accented) and staccato (separate) articulations and loud dynamics. Single levels from other variables also contribute to the first dimension: major harmony, classical genre, and undulating contour in the positive direction and disjunct motion and triple meter in the negative direction. 
  
  For Dimension 2, Excerpts 27, 19, 12, 7, and 15 contribute to the positive side of the dimension, whereas Excerpts 3, 11, 17, and 2 contribute to the negative side. Newer genres (Contemporary, Jazz/Blues, and Modern) contribute to the positive side of Dimension 2, along with Blues and Quintal harmony, Quadruple meter, Gradual decrescendo and loud dynamics, ascending contour, "no melody", and the slowest level of the tempo variable. Older genres (Baroque, Classical, and Romantic) contribute to the negative side of this dimension, along with soft dynamics, minor harmony, and triple meter.^[A full list of contributions is available at the first author's GitHub, the URL for which is in the author note and the supplementary materials.]  

```{r justsomecontsQ}


signed.ctrI <- dimcares.inf$Fixed.Data$ExPosition.Data$ci * sign(FIsym)
signed.ctrJ <- dimcares.inf$Fixed.Data$ExPosition.Data$cj * sign(FJs)

CIlist.dim <- vector(mode = "list", length = 6)
CJlist.dim <- vector(mode = "list", length= 6)

names(CIlist.dim) <- c("Dim1", "Dim2", "Dim3", "Dim1cols", "Dim2cols", "Dim3cols")
names(CJlist.dim) <- c("Dim1", "Dim2", "Dim3", "Dim1cols", "Dim2cols", "Dim3cols")

for (i in 1:3){
  CIlist.dim[[i]] <- signed.ctrI[which(abs(signed.ctrI[,i]) > 1/nrow(signed.ctrI)),i]
  CJlist.dim[[i]] <- signed.ctrJ[which(abs(signed.ctrJ[,i]) > 1/nrow(signed.ctrJ)),i]
  CJlist.dim[[i]] <- CJlist.dim[[i]][order(names(CJlist.dim[[i]]))]
}

names(col4cols) <- colnames(musdimdata.no6)

for (i in 4:6){
  CIlist.dim[[i]] <- col4exgrp[names(col4exgrp) %in% names(CIlist.dim[[i-3]])]
  CJlist.dim[[i]] <- col4cols[names(col4cols) %in% names(CJlist.dim[[i-3]])]
  CJlist.dim[[i]] <- CJlist.dim[[i]][order(names(CJlist.dim[[i]]))]
}

col4barsQ <- vector(mode = "list", length = 6)
names(col4barsQ) <- c("IDim1", "JDim1", "IDim2", "JDim2", "IDim3", "JDim3")

nrows <- nrow(signed.ctrI)

```

```{r contributionsQcode, fig.width=10, fig.height = 6}
# plot contributions of rows for component 1
ctrI.1 <- PrettyBarPlot2(CIlist.dim$Dim1,
                         threshold = 1 / NROW(signed.ctrI),
                         font.size = 3,
                         color4bar = CIlist.dim$Dim1cols,  #col4exgrp[which(abs(signed.ctrI[,1]) > 1/nrow(signed.ctrI))] , # we need hex code
                         ylab = 'Contributions', #sortValues = TRUE,
                         ylim = c(1.2*min(signed.ctrI[,1]), 1.2*max(signed.ctrI[,1]))
) + ggtitle("Dimension 1", subtitle = 'Rows') + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 14, face = "italic", family = "serif"))

# plot contributions of columns for component 1
ctrJ.1 <- PrettyBarPlot2(CJlist.dim$Dim1,#[order(names(CJlist.dim$Dim1))],
                         threshold = 1 / NROW(signed.ctrJ),
                         font.size = 3,
                         color4bar = CJlist.dim$Dim1cols,  #cols4conts[which(abs(signed.ctrJ[,1]) > 1/nrow(signed.ctrJ))], # we need hex code
                         ylab = 'Contributions',
                         ylim = c(2.5*min(signed.ctrJ[,1]), 1.75*max(signed.ctrJ[,1]))
) + ggtitle("", subtitle = 'Columns') + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 14, face = "italic", family = "serif"))

# plot contributions of rows for component 2
ctrI.2 <- PrettyBarPlot2(CIlist.dim$Dim2,
                         threshold = 1 / NROW(signed.ctrI),
                         font.size = 3,
                         color4bar = col4exgrp[which(abs(signed.ctrI[,2]) > 1/nrow(signed.ctrI))] , # we need hex code
                         ylab = 'Contributions',
                         ylim = c(1.2*min(signed.ctrI[,2]), 1.2*max(signed.ctrI[,2]))
) + ggtitle("Dimension 2", subtitle = 'Rows') + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 14, face = "italic", family = "serif"))

# plot contributions of columns for component 2
ctrJ.2 <- PrettyBarPlot2(CJlist.dim$Dim2,
                         threshold = 1 / NROW(signed.ctrJ),
                         font.size = 3,
                         color4bar = CJlist.dim$Dim2cols, # we need hex code
                         ylab = 'Contributions',
                         ylim = c(2.4*min(signed.ctrJ[,2]), 3.5*max(signed.ctrJ[,2]))
) + ggtitle("", subtitle = 'Columns') + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 14, face = "italic", family = "serif"))


#grid.arrange(
#    as.grob(ctrI.1),as.grob(ctrJ.1),
#    as.grob(ctrI.2),as.grob(ctrJ.2),
#    ncol = 2,nrow = 2#, top = textGrob("Contributions, Qualities Survey", gp = gpar(fontsize = 18, font = 3))
#  )

#Ctr.IJ <- recordPlot()

#1 - blue, 2 - red, 3 - green, 4 - yellow
```

```{=latex}
\begin{figure}   
  \centering  
  \caption{CA: Musical Qualities survey, important signed contributions for the first two dimensions, colored similarly to Figure 3. The $y$-axis represents the value of the contributions.}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/contributionsQcode-1.png}
  \label{fig:contributionsQ}
\end{figure}
```

## Experiment 1 Discussion

  Observing no group differences between French and American participants in the results of the MDS on the co-occurrence matrix suggests that the trained musicians perceived the excerpts with which they were presented similarly. 

  The results of the CA (Figure \@ref(fig:factormapsQ)) reveal a few musical connections: for example, between tempo and articulation (on Dimension 1), and between genre and harmony (on Dimension 2). Staccato articulations, associated on this factor plot with high tempi, are played light and separate, and legato articulations, associated with slow tempi, are played smooth and connected. The coordinate mapping of jazz/blues harmony and genre, which are on top of one another, is the most extreme example of a genre being associated with certain harmonic material, but other connections are also revealed. The second dimension separates older styles, such as Baroque, Classical, and Romantic, from newer styles, Contemporary, Jazz/Blues, and Modern. Dimension 2  similarly separates harmonies associated with those styles, specifically older and simpler harmonies of major and minor from the more complex harmonies of Quintal and Blues.  
  
  The first dimension can be interpreted as arousal---tempo, articulation, and dynamics all load from greater arousal in the positive direction to lesser arousal in the negative direction on the first dimension. Dimension 2 is less clear, and does not seem to be tied to valence. Minor and major harmony, for example, both score negatively on Dimension 2. Instead, Figure \@ref(fig:contributionsQ) shows that while two levels of the meter variable are the most important for this dimension, that genre is also important, based on the number of levels of genre that contribute significantly to Dimension 2. Considering the contributions of the genre and the harmony variables, it may be that the second dimension represents complexity.  

# Experiment 2: Musical Adjectives Survey
 
## Methods

### Participants

  Participants with self-reported normal hearing were recruited for Experiment 2 without regard to level of music training. Participants in the United States were recruited by the UT Dallas Psych Research Sign-up (SONA) System, by word of mouth, and by social media. French participants were recruited by word of mouth, email, and social media. Only participants who signed up via the SONA System were compensated (i.e., with research participation credit). Out of 520 survey responses received, 166 were incomplete and removed. The remaining 354 were filtered by nationality: American participants who answered the question "What's your nationality?" with a compound nationality including American were retained, but those who indicated only a nationality other than American were excluded. For example, "Indian-American" was included, but "Ghanian" was not. This left a total of 278 ($N\mathrm{_{France}}$ = 112, $N\mathrm{_{USA}}$ = 166) survey responses for analysis. All recruitment measures were approved by the UT Dallas IRB.  
  
### Stimuli  
  
  The stimuli used for Experiment 2 were the same as those used for Experiment 1.
  
### Survey
  
  The procedures for participants in Experiments 1 and 2 were similar: Participants received a link to a Qualtrics survey presented in either English or French, depending on the country in which they were recruited, and instructions regarding listening environment were the same as in Experiment 1. After standard informed consent procedures, participants listened to 15 of the 30 excerpts, presented one at a time, in a random order, and performed a CATA task. Participants were instructed to select all adjectives that they felt described the stimulus. Participants were provided with a list of 33 adjectives, presented in a random order for each stimulus, such as such as "Dark", "Warm", and "Colorful" (French: "Sombre", "Chaleureux", and "Coloré"). The adjectives for this survey were selected using @Wallmark2019 as a guide and in consultation with a French professional musician. Some adjectives were initially selected in French and some in English. In all cases, adjectives were selected for which there was a clear French (vis-à-vis English) translation. The adjectives are listed in English and in French in the supplementary materials. Following the experimental task, the participants were asked to provide demographic data, including age, gender identity, nationality, occupation, and musical experience.  

### Data Processing & Analysis

  Data for the survey for Experiment 2 were processed similarly to Experiment 1. Due to a technical error, French participants were not presented with Excerpt 17, so the data for that excerpt were removed from the dataset for the American participants. Although Excerpts 6 and 14 were removed from Experiment 1 data for being outliers, they were not found to be outliers in Experiment 2, and were, therefore, included in all of the analyses for this experiment. To process the data, first, all French survey responses were translated into English. Both sets of responses were then converted into "bricks" of data, with the excerpts on the rows, the adjectives on the columns, and participants on the pages. On a page, at the intersection of a row and column was a one or a zero, with a one indicating that this participant had selected this adjective (column) to describe this stimulus (row). The bricks were then summed across pages to obtain a pseudo-contingency table in which the intersection of a row and a column stored the number of participants who selected an adjective to describe an excerpt.  
  
  To analyze the similarity structure between participants, we computed a co-occurrence matrix from the brick with participants on the rows and columns, such that the intersection of a row and column represented the number of common choices between participants. This co-occurrence matrix was then analyzed using MDS.  
  
  To analyze the excerpts and adjectives and obtain the music quality space, we performed a CA on the excerpts by adjectives contingency table. To identify potential clusters of excerpts or adjectives, two separate HCAs were computed, one on the row factor scores (excerpts) and one on the column factor scores (adjectives) obtained from the CA. 

```{=latex}
\begin{figure}   
  \centering  
  \caption{MFA: Data manipulation flowchart.}
    \includegraphics[width=1\columnwidth]{./Music-Descriptor-Space_files/figure-latex/mfadataflow.png}
  \label{fig:mfadataflow}
  \caption*{\footnotesize \textit{Note.} 1. Brick separated by nationality. 2. Separate bricks summed across pages. 3. Tables transposed. Thin arrows: tables as blocks concatenated into large matrices and sent to MFA for analysis.}
\end{figure}
```     

  We performed two MFAs, one to explore differences between French and American participants from the perspective of their use of adjectives, and another to explore differences between French and American participants from the perspective of their descriptions of the excerpts. To prepare the data for these MFAs, we separated the brick into two separate bricks, one for the French participants and one for the American participants. Each brick was then summed to obtain excerpts by adjectives pseudo-contingency tables for each nationality. These tables were then transposed to obtain adjectives by excerpts pseudo contingency tables for each group. The French and American excerpts by adjectives tables were then concatenated into a single large matrix in which each table represented a block, as were the transposed (adjectives by excerpts) tables. We then performed separate MFAs on each of these large matrices. Figure \@ref(fig:mfadataflow) sketches the data manipulation process.  

```{r Adatain}
rm(list = ls())

load("adj.catadata.list.RData")
load("excerptsdesign.RData")
load("adjdesign.RData")
load("adjectivecolors.RData")

partcols <- adj.catadata.list$partcols
adjbrick <- adj.catadata.list$adjbrick
adj.contingency <- adj.catadata.list$adjcontingency
adjcols <- adj.catadata.list$adjcols
listofwords <- adj.catadata.list$listofwords

nat.factor <- partcols$nationality
col4nat <- nat.factor
nat.factor <- as.factor(nat.factor)

#cols$n.oc[nat.factor == "AM"] <- "#FF0000"
#cols$n.oc[nat.factor == "FR"] <- "#046C9A"
#cols$n.gc[1] <- "#FF0000"
#cols$n.gc[2] <- "#046C9A"

```

```{r A.CA}
adjsym.cares <- epCA.inference.battery(adj.contingency, 
                     symmetric = TRUE)

adjrenorm <- CARenormalization(adjsym.cares$Fixed.Data$ExPosition.Data$fi,
                               delta = adjsym.cares$Fixed.Data$ExPosition.Data$pdq$Dv,
                               singularValues = T,
                               masses = adjsym.cares$Fixed.Data$ExPosition.Data$M
                               )

FIsym.adj <- adjsym.cares$Fixed.Data$ExPosition.Data$fi
FIasym.adj <- adjrenorm$G_A
FJs.adj <- adjsym.cares$Fixed.Data$ExPosition.Data$fj
CAEigs.adj <- adjsym.cares$Fixed.Data$ExPosition.Data$eigs
```

```{r inferences.A, cache = TRUE}
# Bootstrapping
bootCA.adj <- Boot4PTCA(ZeDataCube = adjbrick,
                        fi = FIsym.adj,
                        fj = FJs.adj,
                        eigs = CAEigs.adj,
                        nf2keep = 3,
                        nBootIter = 1000)
# Compute Bootstrapped ratios
bootRatadj.I <- PTCA4CATA::boot.ratio.test(bootCA.adj$RowsBoot,
                                            critical.value = 2)
bootRatadj.J <- PTCA4CATA::boot.ratio.test(bootCA.adj$ColumnsBoot,
                                              critical.value = 2)
# Probabilities 
probBRadj.I  <- bootRatadj.I$prob.boot.ratios
probBRadj.J  <- bootRatadj.J$prob.boot.ratios

# Permutation tests
#adjca.inf <- perm4PTCA(aCube = adjbrick,
#                       nIter = 1000,
#                       permType = 'byRows' ,
#                       Malinvaud = TRUE)
#Ind.Permu.adj    <- adjca.inf$permInertia
#InertiaFixed.adj <- adjca.inf$fixedInertia
#prob.cpt.lst.adj <- adjca.inf$MalinvaudQ['p-perm',]
# Get the p values for the components
#prob.cpt.adj <- (unlist(prob.cpt.lst.adj[2:length(prob.cpt.lst.adj)]))
#prob.cpt.adj[is.na(prob.cpt.adj)] <- 1
```

```{r partdistance.A}

Cmat.adj <- createSymDist4PTCA(adjbrick)$CrossProduct

eigenCmat.adj <- eigen(Cmat.adj, symmetric = TRUE)
eig4Cmat.adj <-  eigenCmat.adj$values
tau4Cmat.adj <- round( (100*eig4Cmat.adj) / sum(eig4Cmat.adj))

nk       <- 100
F4Cmat.adj   <- eigenCmat.adj$vectors[,1:nk] %*% diag(eig4Cmat.adj[1:nk]^(1/2))

rownames(F4Cmat.adj) <- rownames(Cmat.adj)
```

```{r judgeshca}
F4dist <- F4Cmat.adj

rownames(F4dist) <- partcols$nationality

cmat.D <- dist(F4dist)

fit.p <- hclust(cmat.D, method = "ward.D2")

ngroups <- 2

col4extree <- cols$n.gc

part.groups <- cutree(fit.p, k= ngroups)

col4partxhca <- recode(part.groups, 
                    "1" = col4extree[2],
                    "2" = col4extree[1]
                    )

mus.tree4parts <- factoextra::fviz_dend(fit.p,  k = 2, 
#                        k_colors = unique(col4extree.w6), 
#                        label_cols = col4extree.w6,
                        cex = .75, xlab = 'Participants',
                        main = ' ', 
                        rect = TRUE, rect_fill = TRUE)  + theme(plot.title = element_text(size = 14, family = "serif"),
                      axis.title = element_text(size = 12, face = "italic", family = "serif"))
 
#print(mus.tree4parts)


```
```{r ajudgehca}

labelscolor <- cbind(fit.p$labels, part.groups) %>% as.data.frame()

labcolgroup <- labelscolor %>% group_by(V1, part.groups) %>% summarise(number = n() )

#labcolgroup

posthocperc <- c(101/112, 81/166, 11/112, 85/166)

```


```{r apartscreecode, include = FALSE}
ScreeInf <- PlotScree(ev = eig4Cmat.adj,
             max.ev = NULL, alpha = 0.05,
             col.ns = "#006D2C", col.sig = "#54278F", title = " ",
             #title = "Participants Distance Analysis, Adjectives Survey: \nExplained Variance per Dimension",
             plotKaiser = T)

a000.adj.screeRV <-  recordPlot()
```  

## Results

### Excerpts

```{r}
adj.tau <- adjsym.cares$Fixed.Data$ExPosition.Data$t
```

```{=latex}
\begin{figure}  
  \begin{center}
  \caption{CA: Scree plot for Adjectives Survey, showing percentage of explained variance per dimension. Horizontal line indicates the average variance extracted per dimension.}
    \includegraphics[width=0.6\columnwidth]{./Music-Descriptor-Space_files/figure-latex/scree4descriptorscode-1.png}
  \label{fig:scree4descriptors}  
 \end{center}
\end{figure}
```

#### CA & HCA
  
  The CA performed on the AS pseudo-contingency table revealed two important dimensions, which together accounted for `r round(sum(adj.tau[c(1,2)]))`% of the total variance (see Figure \@ref(fig:scree4descriptors)).

  Figure \@ref(fig:factormapsA) displays the factor scores for the excerpts and the adjectives. Interpretation of these plots is similar to the factor plots in Experiment 1. Because this experiment captures participant behavior relative to the descriptions of the excerpts, adjectives that are near one another can be interpreted as having been used similarly, such as “Incisive” and “Complex”. This plot shows a clear valence-arousal plane, such that the first dimension represents valence, with adjectives such as "Sad" and "Dark" on the right contrasting with "Dancing" and "Happy" on the left, and the second dimension represents arousal, such that "Aggressive" is contrasted near the top with "Soft" near the bottom. Similarly, Excerpts 27 and 26 are defined almost entirely by valence, with their projections on Dimension 1 accounting for 84% and 86% of their variance, respectively, and Excerpt 28 could be interpreted as being defined almost entirely by arousal, with its projection on Dimension 2 accounting for 81% of its variance. 

  The HCAs computed separately on the factor scores for the rows (excerpts) and columns (adjectives; see supplementary materials for tree diagrams) revealed four clusters for each set, and the excerpts and adjectives are colored according to these clusters for all plots for Experiment 2. The clusters of adjectives and excerpts identified by the HCA are grouped approximately by quadrant in Figure \@ref(fig:factormapsA), with the top right representing negative valence/high arousal, the top left representing positive valence/high arousal, the bottom left representing positive valence/low arousal, and the bottom right representing negative valence/low arousal. A few adjectives do not conform to this pattern---such as "Monotonous" and "Dull"---because the factor scores for all dimensions were used for the HCA, and these adjectives were likely loading on higher dimensions. 
  

```{r scree4descriptorscode, include = FALSE}
adj.scree <- PlotScree(adjsym.cares$Fixed.Data$ExPosition.Data$eigs, 
                       p.ev = adjsym.cares$Inference.Data$components$p.vals,
                       plotKaiser = T, color4Kaiser = "red", title = " ")
  
mus.00.scree <- recordPlot()
```


```{=latex}
\begin{figure}   
  \centering  
  \caption{CA: Adjective survey, factor plots for Excerpts and Adjectives, each colored according to clusters identified by their respective HCAs. Axis labels indicate dimension, eigenvalue, and explained variance for that dimension.}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/factormapsAcode-1.png}
  \label{fig:factormapsA}
\end{figure}
```

```{r factormapsAcode, fig.width= 10, fig.show = 'hold', out.width='100%', include = FALSE}

rownames(FIsym.adj) <- c(1:16,18:30)


axisone <- 1
axistwo <- 2

exmap <- createFactorMapIJ(FIsym.adj,
                           FJs.adj,
                           axis1 = axisone,axis2 = axistwo,
                           col.points.i = cols$ex.oc, 
                           col.labels.i = cols$ex.oc, 
                           col.points.j = cols$adj.oc, 
                           col.labels.j = cols$adj.oc,
                           text.cex.i = 3.5, text.cex.j = 3.5,
                           font.face.j = 'italic', 
                           )

vc.labels <- createxyLabels(resCA = adjsym.cares$Fixed.Data)


mus.adj.fi <- exmap$baseMap + #zePoly.J + 
            exmap$I_points + 
              exmap$I_labels + 
              #  exmap$J_points + 
                #  exmap$J_labels + 
                    vc.labels + ggtitle('Excerpts') + 
                theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 12, face = "italic", family = "serif"))
  
mus.adj.fj <- exmap$baseMap + #zePoly.J + 
          #  exmap$I_points + 
           #   exmap$I_labels + 
                exmap$J_points + 
                  exmap$J_labels + 
                    vc.labels + ggtitle('Adjectives')+ 
                theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 12, face = "italic", family = "serif"))




#grid.arrange(
#    as.grob(mus.adj.fi),as.grob(mus.adj.fj),
#   as.grob(mus.adj.amj),as.grob(mus.adj.frj),
#    ncol = 2,nrow = 1# ,top = textGrob("Factor Plots for the Adjectives Survey", gp = gpar(fontsize = 22, font = 3))
# )



```


  Figure \@ref(fig:contributionsA) displays the contributions of excerpts and adjectives important for the first two dimensions. For Dimension 1---in order of magnitude---Excerpts 27, 24, 3, 7, 18, and 10 contribute to the positive side of the dimension, whereas Excerpts 23, 13, 26, 4, and 19 contribute to the negative side. Adjectives "Sad", "Dark", "Melancholy", "Slow", "Mysterious", "Solemn", and "Disturbing" contribute in the positive direction, whereas "Fast," "Dancing," "Happy," "Colorful," and "Bright" contribute in the negative direction.

  For Dimension 2, Excerpts 6, 1, 25, 7, and 16 contribute to the positive side of the dimension, whereas Excerpts 28, 11, 20, 29, and 10 contribute to the negative side. Adjectives "Aggressive," "Fast," "Mysterious," "Disturbing," and "Complex" contribute to the positive side of Dimension 2, whereas "Warm," "Soft," "Slow," "Round," Happy," "Melancholy," and "Solemn" contribute to the negative side. 

  
```{r justsomecontsA}
signed.ctrI.adj <- adjsym.cares$Fixed.Data$ExPosition.Data$ci * sign(FIsym.adj)
signed.ctrJ.adj <- adjsym.cares$Fixed.Data$ExPosition.Data$cj * sign(FJs.adj)

CIlist <- vector(mode = "list", length = 2)
CJlist <- vector(mode = "list", length= 2)

names(CIlist) <- c("Dim1", "Dim2")
names(CJlist) <- c("Dim1", "Dim2")

for (i in 1:3){
  CIlist[[i]] <- signed.ctrI.adj[which(abs(signed.ctrI.adj[,i]) > 1/nrow(signed.ctrI.adj)),i]
  CJlist[[i]] <- signed.ctrJ.adj[which(abs(signed.ctrJ.adj[,i]) > 1/nrow(signed.ctrJ.adj)),i]
}
```

```{r contributionsAcode, fig.width=10}
# plot contributions of rows for component 1
ctradjI.1 <- PrettyBarPlot2(CIlist[[1]],
                         threshold = 1 / NROW(signed.ctrI.adj),
                         font.size = 3,
                         color4bar = cols$ex.oc[which(abs(signed.ctrI.adj[,1]) > 1/nrow(signed.ctrI.adj))], # we need hex code
                         ylab = 'Contributions',
                         #sortValues = TRUE,
                         ylim = c(1.2*min(CIlist[[1]]), 1.2*max(CIlist[[1]]))
) + ggtitle("Component 1", subtitle = 'Excerpts') + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 14, face = "italic", family = "serif"))

# plot contributions of columns for component 1
ctradjJ.1 <- PrettyBarPlot2(CJlist$Dim1,
                         threshold = 1 / NROW(signed.ctrJ.adj),
                         font.size = 3,
                         color4bar = cols$adj.oc[which(abs(signed.ctrJ.adj[,1]) > 1/nrow(signed.ctrJ.adj))], # we need hex code
                         ylab = 'Contributions',
                        # sortValues = TRUE,
                         ylim = c(1.2*min(CJlist[[1]]), 1.2*max(CJlist[[1]]))
) + ggtitle("", subtitle = 'Adjectives') + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 14, face = "italic", family = "serif"))
# plot contributions of rows for component 2
ctradjI.2 <- PrettyBarPlot2(CIlist[[2]],
                         threshold = 1 / NROW(signed.ctrI.adj),
                         font.size = 3,
                         color4bar = cols$ex.oc[which(abs(signed.ctrI.adj[,2]) > 1/nrow(signed.ctrI.adj))], # we need hex code
                         ylab = 'Contributions',
                        # sortValues = TRUE,
                         ylim = c(1.2*min(signed.ctrI.adj[,2]), 1.2*max(signed.ctrI.adj[,2]))
) + ggtitle("Component 2", subtitle = 'Excerpts') + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 14, face = "italic", family = "serif"))

# plot contributions of columns for component 2
ctradjJ.2 <- PrettyBarPlot2(CJlist$Dim2,
                         threshold = 1 / NROW(signed.ctrJ.adj),
                         font.size = 3,
                         color4bar = cols$adj.oc[which(abs(signed.ctrJ.adj[,2]) > 1/nrow(signed.ctrJ.adj))], # we need hex code
                         ylab = 'Contributions',
                        # sortValues = TRUE,
                         ylim = c(1.2*min(signed.ctrJ.adj[,2]), 1.2*max(signed.ctrJ.adj[,2]))
) + ggtitle("", subtitle = 'Adjectives') + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 14, face = "italic", family = "serif"))

#grid.arrange(
#    as.grob(ctradjI.1),as.grob(ctradjJ.1),
#    as.grob(ctradjI.2),as.grob(ctradjJ.2),
#    ncol = 2,nrow = 2#, top = textGrob("Contributions, Adjectives Survey", gp = gpar(fontsize = 18, font = 3))
#  )

#Ctradj.IJ <- recordPlot()

#yellow is 1, blue is 2, green is 3, red is 4.

```

```{=latex}
\begin{figure}   
  \centering  
  \caption{CA: Adjective survey. Important signed contributions from rows and columns, colored according to clusters identified by their respective HCAs. The $y$-axis represents the value of the contributions.}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/contributionsAcode-1.png}
  \label{fig:contributionsA}
  \caption*{}
\end{figure}
```

### Participants
```{=latex}
%\begin{wrapfigure}{h}{.4\textwidth}  
%  \begin{center}
%    \includegraphics{./Music-Descriptor-Space_files/figure-latex/a.part.scree-1.png}
%  \caption{This plot shows the explained variance per dimension for this analyisis.}(\#fig:apartscree)  
% \end{center}
%\end{wrapfigure}
```

```{=latex}
\begin{figure}   
  \centering  
  \caption{MDS: Distance analysis of the co-occurrence matrix for the adjectives survey, including group means and bootstrap-derived confidence intervals, colored by nationality. Axis labels indicate dimension, eigenvalue, and explained variance for that dimension.}
    \includegraphics[width=0.7\columnwidth]{./Music-Descriptor-Space_files/figure-latex/map4RVAcode-1.png}
  \label{fig:map4RVA}
\end{figure}
```

#### MDS  
  Figure \@ref(fig:map4RVA) displays the factor scores obtained from the MDS performed on the co-occurrence matrix for the AS, along with group means and bootstrap-derived confidence intervals. The separation between the confidence intervals indicates significant differences between French and American participants, $\textit{p}$ < .01. Additional analyses using gender identity and level of music training as factors did not reveal any significant difference. 

```{r map4RVAcode, fig.height=6, out.height = "30%"}
Shortnames4Participants <-  dimnames(adjbrick[[3]])
F4Plot <- F4Cmat.adj
rownames(F4Plot) <- Shortnames4Participants
# Make labels
labels4RV <- createxyLabels.gen(1,2,lambda = eig4Cmat.adj, tau = tau4Cmat.adj)

#Here we calculate the means for the factor groupings, and then bootstrap them:
n.adjmeans <- getMeans(F4Plot, nat.factor)
BootCadj.N <- PTCA4CATA::Boot4Mean(F4Cmat.adj, design = nat.factor,
                                   niter = 1000,
                                   suppressProgressBar = TRUE)
dimnames(BootCadj.N$BootCube)[[2]] <- paste0('Dimension ',
                                             1:dim(BootCadj.N$BootCube)[[2]])
# Create ellipses for the map
n.elliadj <- MakeCIEllipses(BootCadj.N$BootCube[,1:2,], p.level = .99,
                            names.of.factors = c("Dimension 1", "Dimension 2"),
                            col = cols$n.gc)
#Base map
BaseMap.Participants <- createFactorMap(X = F4Plot ,
                              axis1 = 1, axis2 = 2,
                              display.points = TRUE,
                              col.points = cols$n.oc,
                              pch = 19, cex = 2.5,
                              display.labels = TRUE,
                              col.labels = cols$n.oc,
                              text.cex = 4, font.face = "bold",
                              font.family = "sans",
                              col.axes = "darkorchid", 
                              alpha.points = .25,
                              alpha.axes = 0.2,
                              width.axes = 1.1,
                              col.background = adjustcolor("lavender",
                                                       alpha.f = 0.2),
                              force = 1, segment.size = 3) 

#Nationality map
title4RV <- "RV Analysis of Participants \nIncluding Group Means and Confidence Intervals"
n.rv.means <- createFactorMap(n.adjmeans,
                              axis1 = 1, axis2 = 2, 
                              constraints = BaseMap.Participants$constraints, 
                              col.points =  cols$n.gc,
                              alpha.points = 1, # no transparency
                              alpha.labels = 1,
                              display.points = TRUE,
                              pch = 17, cex = 5,
                              display.labels = TRUE, 
#                              title = title4RV,
                              col.labels = cols$n.gc, 
                              text.cex = 6,font.face = "bold",
                              font.family = "sans", col.axes = "darkorchid", 
                              alpha.axes = 0.2, width.axes = 1.1, 
                              col.background = adjustcolor("lavender", alpha.f = 0.2), 
                              force = 1, segment.size = 0)

a.03adj.map4part <- BaseMap.Participants$zeMap_background + 
                  n.rv.means$zeMap_text + n.rv.means$zeMap_dots +
                    BaseMap.Participants$zeMap_dots + n.elliadj + labels4RV + ggtitle(" ") +
                theme(plot.title = element_text(size = 13, family = "serif"),
                      axis.title = element_text(size = 13, face = "italic", family = "serif"))


print(a.03adj.map4part)
```

```{r ttest4adj}

A.dim14test <- F4Cmat.adj[,1]
A.dim24test <- F4Cmat.adj[,2]

ttdat <- cbind(F4Cmat.adj[,1:2], as.factor(partcols$nationality)) %>% as.data.frame
colnames(ttdat) <- c("dim1", "dim2", "Nationality")

atest1 <- aov(A.dim14test ~ nat.factor) %>% apa_print
atest1.Tuk <- aov(A.dim14test ~ nat.factor) %>% TukeyHSD()


atest1t <- t.test(x = ttdat$dim1[ttdat$Nationality==1], 
                  y = ttdat$dim1[ttdat$Nationality==2]) %>% apa_print

t.summary <- ttdat %>% group_by(Nationality) %>% summarise(m.d1 = mean(dim1), s.d1 = sd(dim1),
                                              m.d2 = mean(dim2), s.d2 = sd(dim2))  


atest2 <- aov(A.dim24test ~ nat.factor) %>% apa_print
atest2t <- ttdat %>% rstatix::t_test(dim2 ~ Nationality) %>% rstatix::add_significance()


```


#### MFA

  Figure \@ref(fig:mfasbs) displays the results of the MFAs as partial factor score plots (see "Multiple Factor Analysis" above) highlighting differences in descriptions from the perspective of the excerpts (left) and the adjectives (right) between French and American participants. The two separate MFAs revealed slightly different factorial dimensions,  as shown by the percentage of extracted variance on each axis (tau), but the general space for both plots is similar to the space revealed by the CA for Experiment 2 (Figure \@ref(fig:factormapsA)). Thus, we can interpret the space similarly, relative to the valence-arousal plane. However, in this case, we cannot compare elements between maps.  
  
  The diamonds represent the compromise between the mental spaces of the French and American participants for each item, and the lines extending from the diamonds to the circles point to the partial factor scores for the items from the perspective of each group [@Abdi2013]. Excerpts and adjectives that were rated similarly by each group have short lines extending from them, and those that were rated differently by each group have longer lines. Examples of excerpts that were rated differently are numbers 6, 8, and 12. Adjectives that were used differently include "Disturbing", "Round", "Solemn", and "Bright". 

```{r A.MFA.excode, fig.height=12, message=FALSE, warning=FALSE, include = FALSE}
suppressMessages(library(MExPosition))

adjbrick.AM <- adjbrick[,,1:length(which(adj.catadata.list$partcols$nationality == "US"))]
adj.cont.AM <- apply(adjbrick.AM, c(1,2), sum)

adjbrick.FR <- adjbrick[,,(length(which(adj.catadata.list$partcols$nationality == "US"))+1):dim(adjbrick)[[3]]]
adj.cont.FR <- apply(adjbrick.FR, c(1,2), sum)

adj4MFA <- abind(adj.cont.FR, adj.cont.AM, along = 2)

frvec <- t(as.data.frame(rep("France", length.out = dim(adj.cont.FR)[2])))
amvec <- t(as.data.frame(rep("US", length.out = dim(adj.cont.AM)[2])))

colnames(frvec) <- colnames(amvec) <- colnames(adj.cont.FR)
rownames(frvec) <- rownames(amvec) <- "group"


mfagroups <- abind(frvec, amvec, along = 2)


mfares <- mpMFA(adj4MFA, mfagroups)

renameCols <- function(x){
   colnames(x) <- paste("Dimension", 1:ncol(x))
   x
}

RVmat <- mfares$mexPosition.Data$InnerProduct$RVMatrix

#corrplot(RVmat, method = "color", addCoefasPercent = TRUE) 

Eig4scree <- mfares$mexPosition.Data$Table$eigs

#mfascree <- PlotScree(Eig4scree, plotKaiser = TRUE)

fi4pfs <- mfares$mexPosition.Data$Table$fi

fi4pfs[,2] <- fi4pfs[,2]*-1
rownames(fi4pfs) <- c(1:16,18:30)

MFA_FMap <- createFactorMap(
                            fi4pfs,
                            col.points = cols$ex.oc,
                            col.labels = cols$ex.oc,
                            alpha.points = .6,
                            pch = 18,
                            cex = 5, text.cex = 5,
                            display.labels = TRUE,
                            constraints = minmaxHelper4Partial(FactorScores = mfares$mexPosition.Data$Table$fi,
                              partialFactorScores = 1.25*mfares$mexPosition.Data$Table$partial.fi.array)
                            )
                            
label4Map <- createxyLabels.gen(1,2,
                                lambda = mfares$mexPosition.Data$Table$eigs,
                                tau = mfares$mexPosition.Data$Table$t,
                                axisName = "Dimension ")





fi4pfs <- renameCols(fi4pfs)

pfi4pfs <- mfares$mexPosition.Data$Table$partial.fi.array

pfi4pfs[,2,c(1:2)] <- pfi4pfs[,2,c(1:2)]*-1

pfi4pfs <- renameCols(pfi4pfs)
rownames(pfi4pfs) <- c(1:16,18:30)
dimnames(pfi4pfs)[[3]] <- c("France", "US")

map4PFS <- createPartialFactorScoresMap(
                                        factorScores = fi4pfs,
                                        partialFactorScores = pfi4pfs,
                                        axis1 = 1, axis2 = 2,
                                        colors4Items = cols$ex.oc,
                                        names4Partial = c("FR", "US"),
                                        font.labels = 'bold', shape.points = 1
                                        )

partialfsmap <- MFA_FMap$zeMap + 
                  label4Map + 
                    map4PFS$linesColByItems + 
                      map4PFS$pointsColByItems + 
                        map4PFS$labelsColByItems + 
              ggtitle("Excerpts")+ 
                theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 12, face = "italic", family = "serif"))

adj4MFA.T <- abind(t(adj.cont.FR), t(adj.cont.AM), along = 2)

natvec <- rep(c("France", "US"), times = dim(adj4MFA.T)[2]/2)
natvec <- data.frame(natvec[order(natvec, decreasing = T)]) %>% t(.)

colnames(natvec) <- colnames(adj4MFA.T)
rownames(natvec) <- "group"

mfares.t <- mpMFA(adj4MFA.T, natvec)

RVmat.t <- mfares.t$mexPosition.Data$InnerProduct$RVMatrix

#corrplot(RVmat, method = "color", addCoefasPercent = TRUE) 

Eig4scree <- mfares$mexPosition.Data$Table$eigs

#mfascree <- PlotScree(Eig4scree, plotKaiser = TRUE)

MFA_FMap.t <- createFactorMap(
                            mfares.t$mexPosition.Data$Table$fi,
                            col.points = cols$adj.oc,
                            col.labels = cols$adj.oc,
                            alpha.points = .6,
                            pch = 18,
                            cex = 5,
                            display.labels = TRUE,
                            constraints = minmaxHelper4Partial(FactorScores = mfares.t$mexPosition.Data$Table$fi,
                              partialFactorScores = mfares.t$mexPosition.Data$Table$partial.fi.array)
                            )
                            
label4Map.t <- createxyLabels.gen(1,2,
                                lambda = mfares.t$mexPosition.Data$Table$eigs,
                                tau = mfares.t$mexPosition.Data$Table$t,
                                axisName = "Dimension ")




fi4pfs.t <- mfares.t$mexPosition.Data$Table$fi

fi4pfs.t <- renameCols(fi4pfs.t)

pfi4pfs.t <- mfares.t$mexPosition.Data$Table$partial.fi.array

pfi4pfs.t <- renameCols(pfi4pfs.t)

rownames(pfi4pfs.t) <- colnames(adj.contingency)

dimnames(pfi4pfs.t)[[3]] <- c("France", "US")

map4PFS.t <- createPartialFactorScoresMap(
                                        factorScores = fi4pfs.t,
                                        partialFactorScores = pfi4pfs.t,
                                        axis1 = 1, axis2 = 2,
                                        colors4Items = cols$adj.oc,
                                        names4Partial = c("FR", "US"),
                                        font.labels = 'bold', shape.points = 1
                                       # alpha.lines = .75, size.lines = 3
                                        )

partialfsmap.t <- MFA_FMap.t$zeMap + 
                  label4Map.t + 
                    map4PFS.t$linesColByItems + 
                      map4PFS.t$pointsColByItems + 
                        map4PFS.t$labelsColByItems + 
                ggtitle("Adjectives")+ 
                theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 12, face = "italic", family = "serif"))

```


```{r mfattests}

atest1t <- t.test(x = ttdat$dim1[ttdat$Nationality==1], 
                  y = ttdat$dim1[ttdat$Nationality==2]) %>% apa_print

mfatees <- vector(mode = "list", length = )



```


```{r mfasbscode, fig.height=12, include = FALSE}
print(partialfsmap)

mfasbs <- recordPlot()
```
```{r mfasbs-tcode, fig.height = 12, include = FALSE}

print(partialfsmap.t)

mfasbs_t <- recordPlot()
```

```{r mfatogether, fig.width = 12}

#grid.arrange(
#    as.grob(partialfsmap),as.grob(partialfsmap.t),
#    ncol = 2,nrow = 1# ,top = textGrob("Factor Plots for the Adjectives Survey", gp = gpar(fontsize = 22, font = 3))
# )

#mfatogether <- recordPlot()

```

```{=latex}

\begin{figure}   
  \centering  
  \caption{Compromise (diamonds) and partial factor scores (small circles) for MFA analyses on the Excerpts and Adjectives, colored according to clusters identified by the respective HCAs. Axis labels include dimension, eigenvalue, and explained variance for that dimension.}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/mfatogether-1.png}
  \label{fig:mfasbs}
\end{figure}

```

## Experiment 2 Discussion

  As suggested by the MDS on the participants (Figure \@ref(fig:map4RVA)), American and French participants differed in both their mean and their variance. The larger variance of the American participants likely indicates that American participants constitute a more heterogeneous group than French participants. This heterogeneity of the American participants is reflected in their varied responses to the nationality question (with nine different answers), compared to the French participants who all responded "French" (except for one participant who responded with "French - Belgian").

  Because participants only rated half of the excerpts, the mean group differences and confidence intervals are meaningful, but the proximity between individual participants can not be directly interpreted as similarity. A better estimation of between-subject similarity would need to weight the similarity (i.e., the number of common adjectives chosen) between two participants by the number of common excerpts presented.^[The results of the CA, on the other hand, are not affected by the fact that participants only rated half of the excerpts.]
  
  The adjectives used in Experiment 2 were selected to engage a cognitive appraisal, but the first two factorial dimensions of the MFA reveal that participants were answering using emotional dimensions such as valence and arousal---a result that resonates with previous work investigating conceptual organization [@Osgood1955] and music and emotion (Wedin, 1969, 1972).
  
  As a consequence, differences between French and American participants include a large proportion of evaluative adjectives such as "Bright", "Light", "Round", "Solemn", "Melancholy", and "Disturbing". "Bright" (Brillant) may be the most extreme example of this intercultural difference, as the French partial factor score is close to the origin and the American partial factor score is  further away, a difference suggesting that this word has a more positive valence in English than in French. Additionally, the location of the American partial factor score for "Bright" suggests that Americans commonly grouped it with "Colorful" (Coloré) and "Dancing" (Dansant), a contrast to how the French participants used it. "Light" (Clair) shows a similar effect to that of "Bright" with respect to the magnitude of difference. The inverse of "Bright" and "Light" might be "Round", (Tendre), whose French partial factor score is further from the origin than the American. "Melancholy" (Mélancolique) and "Sad" (Triste) were almost synonymous in English, but not in French. The location of "Solemn" (Solennel) suggests that it carries more valence in English, but more arousal in French. "Disturbing" (inquiétant) is far from the origin for French participants but not for American participants. All of these differences highlight possible differences in semantic associations and frequency of use between languages. 
  

# Experiment 3: Combined Surveys

```{r loadthedataPLSC}
rm(list = ls())

load("catadatamusdim.RData")
load("adj.catadata.list.RData")
load("adjdesign.RData")
load("adjectivecolors.RData")

source('~/GitHub/MusicDescriptorsBackup/barplot_sigonly.R')

dimcontingency <- catadata.list$contingency
adjcontingency <- adj.catadata.list$adjcontingency

dimcontingency <- dimcontingency[-c(6,14,17),]
dimcontingency <- dimcontingency[,order(colnames(dimcontingency))]
adjcontingency <- adjcontingency[-c(6,14),]

```

```{r}
library(TExPosition)
library(TInPosition)
library(data4PCCAR)
pls.res <- tepPLS(dimcontingency, adjcontingency, DESIGN = adj.design$thedesign[-c(6,14)])
resPerm4PLSC <- perm4PLSC(dimcontingency, adjcontingency, nIter = 1000)

```

```{r thefirst3eigs}

e1 <- pls.res$TExPosition.Data$eigs[1]
e2 <- pls.res$TExPosition.Data$eigs[2]
e3 <- pls.res$TExPosition.Data$eigs[3]

t1 <- pls.res$TExPosition.Data$t[1]
t2 <- pls.res$TExPosition.Data$t[2]
t3 <- pls.res$TExPosition.Data$t[3]
t4 <- pls.res$TExPosition.Data$t[4]

```

## Methods

  Because Experiment 3 used the data tables computed for Experiments 1 and 2 for its analysis---Partial Least Squares Correlation (PLSC)---no additional data collection was necessary. However, because PLSC requires the same sets of observations, and because Experiments 1 and 2 removed different excerpts, we removed from the data the excerpts present in only one table. Specifically, Excerpt 17 was removed from the table used in Experiment 1 and Excerpts 6 and 14 were removed from the table used in Experiment 2. This way, both data tables comprised data from the same 27 Excerpts.  

## Results

```{=latex}
\begin{figure}  
  \begin{center}
  \caption{PLSC: Scree plot showing explained variance per dimension. Horizontal line represents the average variance extracted per dimension.}
    \includegraphics[width=0.6\columnwidth]{./Music-Descriptor-Space_files/figure-latex/screePLSCcode-1.png}
  \label{fig:screePLSC}  
 \end{center}
\end{figure}
```
  
  The PLSC performed using the pseudo-contingency tables from Experiments 1 and 2 revealed two significant dimensions which together accounted for `r round(sum(t1,t2), 2)`% of the total variance.  

```{r screePLSCcode}

PlotScree(ev = pls.res$TExPosition.Data$eigs,
          p.ev = resPerm4PLSC$pEigenvalues,
          title = ' ',
          plotKaiser = TRUE, 
          color4Kaiser = "red",
          lwd4Kaiser  = 2
          ) + theme(axis.title = element_text(size = 12, face = "italic", family = "serif")) 
a000.scree4plsc <-  recordPlot()

```


  PLSC displays the latent variable scores of one table against its equivalent for the other table (e.g., LV1 from Table 1 versus LV1 for Table 2). Figure \@ref(fig:factorplotsPLSC) displays the LVs plot for LVs 1 and 2. In these plots, the excerpts are colored according to the clusters identified by the HCA for Experiment 2, along with tolerance intervals comprising the elements from each cluster. The first LVs (Figure \@ref(fig:factorplotsPLSC), left) separate the excerpts with positive valence and low arousal (gold) from those with negative valence and high arousal (green). The second LVs (Figure \@ref(fig:factorplotsPLSC), right) separate the groups with positive valence and high arousal (red) from excerpts with negative valence and low arousal (blue).
  

```{r factorplotsPLSCcode, fig.width = 12, fig.height = 6}
latvar.1 <- cbind(pls.res$TExPosition.Data$lx[,1],pls.res$TExPosition.Data$ly[,1])
colnames(latvar.1) <- c("Lx 1", "Ly 1")

zedesign <- adj.design$thedesign[-c(6,14)]
lescoleurs <- adj.design$ex.cols[-c(6,14)]
coleur4group <- adj.design$col4exgrp



rownames(latvar.1) <- c(1:5,7:13,15:16,18:30)


# compute means
lv.1.group <- getMeans(latvar.1, zedesign)

# get bootstrap intervals of groups
lv.1.group.boot <- Boot4Mean(latvar.1, zedesign)
colnames(lv.1.group.boot$BootCube) <- c("Lx 1", "Ly 1")

#Next, we can start plotting:

plot.lv1 <- createFactorMap(latvar.1,
                         col.points = lescoleurs,
                         col.labels = lescoleurs,
                         alpha.points = 0.8, alpha.labels = 0.8,
                         text.cex = 5, title = "Latent Variable Plot 1"
                         )

plot1.mean <- createFactorMap(lv.1.group,
                              col.points = coleur4group,
                              col.labels = coleur4group,
                              cex = 4,
                              pch = 17,
                              alpha.labels = 0.5,
                              text.cex = 6)

plot1.meanCI <- MakeCIEllipses(lv.1.group.boot$BootCube[,c(1:2),], # get the first two components
                              col = adj.design$col4exgrp,
                              names.of.factors = c("Lx 1", "Ly 1"), alpha.ellipse = .2,
                              alpha.line = 0, line.size = 0
                              )

plot1.ti <- MakeToleranceIntervals(latvar.1
                                   , zedesign
                                   , col = coleur4group
                                   )

plot1 <- plot.lv1$zeMap_background + plot.lv1$zeMap_dots + plot.lv1$zeMap_text + plot1.ti + 
                      theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"))
#                      plot.subtitle = element_text(size = 10, face = "italic", family = "serif"))#plot1.meanCI 
#           plot1.mean$zeMap_text + 

latvar.2 <- cbind(pls.res$TExPosition.Data$lx[,2],pls.res$TExPosition.Data$ly[,2])
colnames(latvar.2) <- c("Lx 2", "Ly 2")

rownames(latvar.2) <- c(1:5,7:13,15:16,18:30)

# compute means
lv.2.group <- getMeans(latvar.2, zedesign)

# get bootstrap intervals of groups
lv.2.group.boot <- Boot4Mean(latvar.2, zedesign)
colnames(lv.2.group.boot$BootCube) <- c("Lx 2", "Ly 2")

#Next, we can start plotting:

plot.lv2 <- createFactorMap(latvar.2,
                         col.points = lescoleurs,
                         col.labels = lescoleurs,
                         alpha.points = 0.8, alpha.labels = 0.8,
                         text.cex = 5, title = "Latent Variable Plot 2"
                         )

plot2.mean <- createFactorMap(lv.2.group,
                              col.points = coleur4group,
                              col.labels = coleur4group,
                              cex = 4,
                              pch = 17,
                              alpha.labels = 0.5,
                              text.cex = 6)

plot2.meanCI <- MakeCIEllipses(lv.2.group.boot$BootCube[,c(1:2),], # get the first two components
                              col = coleur4group,
                              names.of.factors = c("Lx 2", "Ly 2"), alpha.ellipse = .2,
                              alpha.line = 0, line.size = 0
                              )

plot2.ti <- MakeToleranceIntervals(latvar.2
                                   , zedesign
                                   , col = coleur4group
                                   )


plot2 <- plot.lv2$zeMap_background + plot.lv2$zeMap_dots + plot.lv2$zeMap_text + plot2.ti + 
                theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 14, face = "italic", family = "serif"))
#                      plot.subtitle = element_text(size = 10, face = "italic", family = "serif"))#plot2.meanCI
         #  plot2.mean$zeMap_text + 


#grid.arrange(as.grob(plot1),
#             as.grob(plot2),
#             ncol = 2,nrow = 1
#             )
#plsc.fplot <- recordPlot()
```

```{=latex}
\begin{figure}   
  \centering  
  \caption{PLSC: Latent variables for Experiment 1 contingency table (horizontal, $x$) plotted against latent variables for Experiment 2 contingency table (vertical, $y$), including tolerance intervals, colored according to the groups revealed by Experiment 2.}
  \label{fig:factorplotsPLSC}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/factorplotsPLSCcode-1.png}
  \caption*{}
\end{figure}
```


  Figure \@ref(fig:contsplsc) displays the contributions from the variables from each data table that are important for the first and second LVs. For these plots, the important levels of variables from Experiment 1 are displayed in green and the important adjectives from Experiment 2 are in blue. The first LVs from each table feature contributions from levels of variables identified as contributing to an arousal dimension in Experiment 1 and the adjectives identified as contributing to a valence dimension in Experiment 2. The second LVs from each table feature contributions from levels of variables identified as contributing to the genre or complexity dimension from Experiment 1 and adjectives identified as contributing to an arousal dimension in Experiment 2. 
  

```{r contsplsccode, fig.width = 10, fig.height = 6, fig.show='hold', message=F}

ctri <- pls.res$TExPosition.Data$ci*sign(pls.res$TExPosition.Data$fi)
ctrj <- pls.res$TExPosition.Data$cj * sign(pls.res$TExPosition.Data$fj)

conts.sigonly <- barplot.sigonly(x = ctri,
                                 y = ctrj,
                                 th = "mean",
                                 type = "cont")

#cavalcanti 1; 2, 5

contribution1colors <- c(rep("#000C02", 18), rep(wes_palettes$GrandBudapest2[4], 15))
contribution2colors <- c(rep("#000C02", 24), rep(wes_palettes$GrandBudapest2[4], 14))


contribution1 <- PrettyBarPlot2(bootratio = conts.sigonly$data$Dim1, 
                       threshold = conts.sigonly$t.hold$thr.tog, 
                       ylim = c(2*min(conts.sigonly$data$Dim1), 3*max(conts.sigonly$data$Dim1)),
                       color4bar = contribution1colors,
                       color4ns = "gray75", 
                       plotnames = TRUE, 
                       main = 'Contributions to the First Latent Variables', 
                       ylab = "Signed Contributions",
                       font.size = 3, line.col = "gray"
                       
                       ) + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 16, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 16, face = "italic", family = "serif"))
  
contribution2 <- PrettyBarPlot2(bootratio = conts.sigonly$data$Dim2, 
                       threshold = conts.sigonly$t.hold$thr.tog, 
                       ylim =c(2*min(conts.sigonly$data$Dim2), 3*max(conts.sigonly$data$Dim2)),
                       color4bar = contribution2colors,
                       color4ns = "gray75", 
                       plotnames = TRUE, 
                       main = 'Contributions to the Second Latent Variables', 
                       ylab = "Signed Contributions",
                       font.size = 3, line.col = "gray"
                       )   + theme(plot.title = element_text(size = 16, family = "serif"),
                      axis.title = element_text(size = 16, face = "italic", family = "serif"),
                      plot.subtitle = element_text(size = 16, face = "italic", family = "serif"))

#grid.arrange(as.grob(contribution1),
#             as.grob(contribution2),
#             ncol = 1,nrow = 2
#             )

#contributionsplsc <- recordPlot()
```

```{=latex}
\begin{figure}   
  \centering  
  \caption{PLSC: Signed contributions important for the first and second latent variables, colored by survey of origin.}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/contsplsccode-1.png}
  \label{fig:contsplsc}
  \caption*{}
\end{figure}
```
## Experiment 3: Discussion

  The goal of this experiment was to identify the common information in the data tables used in Experiments 1 and 2. The first and second latent variables separated the excerpts along dimensions similar to the dimensions extracted by Experiments 1 and 2. Specifically, the first LVs combined the arousal dimension from Experiment 1 with the valence dimension from Experiment 2, and the second LVs combined the complexity or genre dimension from Experiment 1 with the arousal dimension from Experiment 2. 
  
# General Discussion
  
  We collected survey responses to musical stimuli and used multivariate analyses to explore the musical and cognitive spaces created by participants from France and the United States. The results revealed commonalities and differences between these two national groups. French and American participants agreed on: 1) a clear valence-arousal plane common to participants from both countries when describing the stimuli using adjectives, and 2) a space defined by arousal and complexity when evaluating stimuli using musical qualities. However, French and American participants disagreed on the way in which they used the adjectives when describing the stimuli, a result that suggests either cultural differences in the affective response to the stimuli or, more likely, differences in the use of the adjectives between the two languages.
  
  The results of the MDS analyses across experiments showed group differences between French and American participants when they described excerpts using adjectives (Experiment 2), but these results did not show group differences when experts rated excerpts on specific musical qualities (Experiment 1). This pattern of results suggests that Experiment 1 reveals more about the excerpts themselves rather than about the behavior of participants.   
  
  Experiment 3 integrates the results of Experiments 1 and 2, because the first and second latent variables of Experiment 3 essentially combine the dimensions of Experiments 1 and 2. For example, Excerpt 26---a very distal point in the first LV plot in Figure \@ref(fig:factorplotsPLSC)---is an important contributor to the first dimensions of the CAs for both Experiments 1 and 2 (see Figures \@ref(fig:contributionsQ) and \@ref(fig:contributionsA) for the contributions), but is not an important contributor to the second dimensions of Experiments 1 and 2, and is therefore close to the origin in the second LV plot. By contrast, Excerpt 7---a large contributor to the first and second dimensions of the CAs of both Experiments 1 and 2---is far from the origin in both plots in Figure \@ref(fig:factorplotsPLSC).   
  
  The differences in results between Experiments 1 and 2---specifically with regard to Excerpts 6 and 14---demonstrate how small differences in experimental paradigm can provide large differences in perspective. In Experiment 1 (by contrast with Experiment 2), the experts rating the excerpts on specific musical qualities isolated two Excerpts: 6---a minimalist, ostinato based excerpt---and 14---a jazzy excerpt, each the only representative of their style. There are a few possible reasons for this pattern of results, including differences 1) in participant characteristics---experts in Experiment 1 versus non-experts in Experiment 2, and 2) in the way the way the questions in each survey assessed the excerpts---with specific musical qualities in Experiment 1 and subjective evaluations in Experiment 2. Of these two, the second is more likely, because the few participants in Experiment 2 with significant musical training did not differ in their descriptions of the excerpts from the untrained participants. 

  The different experimental paradigms in the present study all provide useful perspectives. For example, the paradigm from Experiment 1---which separates stimuli along concrete musical dimensions---effectively reveals stimulus differences, whereas the paradigm from Experiment 2 reveals stimulus cognitive and affective similarity. In addition, the combination of these two paradigms (as in Experiment 3) probes the "why" of the stimulus affective impact.
  
## Limitations & future directions

  Although we evaluated scores and ratings of participants from different countries, we did not explicitly address multiculturality, because France and the United States are both Western countries that share the same Western musical culture. To address this multicultural question, an experiment would need to include music and/or participants from multiple and contrasted musical cultures. However, specific musical qualities, such as harmony, may not apply or translate well to other musical cultures, because the concepts of melodic and harmonic material are not the same across all musical cultures [@Cohn2001; @Raman2017].  We also suggest that data collected in this way have a much greater hypothetical reach, but the data collected for these experiments represent a convenience sample, and many of the participants were students. However, this limitation could be easily remedied in future studies.  
  One question that fell beyond the scope of this study was to pinpoint the source of the semantic differences between languages (i.e.,  "Bright", "Light", "Round", "Solemn", "Melancholy", and "Disturbing"), illustrated in Figure \@ref(fig:mfasbs). These differences may not reflect true cultural influence of music listening or preference, but simply linguistic differences, including the adjectives' frequency of use in either language or the cultural associations of the words [@Thompson2020]. Diving more into these questions would be, of course, a fascinating future study.  

# Conclusions
  On-line data collection and multivariate analysis are not simply a palliative to be used in a time of pandemic. In fact, this paradigm not only enriches the psychologist's methodological tool-box, but it also may be one of the best ways of reaching a more representative population than first year undergraduate students in psychology.


  
```{r saveGraphs, message = FALSE, warning = FALSE, error = FALSE}
powerpointFilename <- 'Music-Descriptor-Space.pptx'
path2pptx    <- './Analysis/'
name4Graphs  <- paste0(path2pptx,powerpointFilename)
title4Graphs <- 'Music Descriptor Space '



pptx4musdim <- PTCA4CATA::saveGraph2pptx(file2Save.pptx = name4Graphs, 
                 title = title4Graphs, 
                 addGraphNames = TRUE)
```

\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
