---
title             : "Cognitive Music Listening Space: A Multivariate Approach"
shorttitle        : "Music Descriptor Space"

author: 
  - name          : "Brendon Mizener"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "800 W. Campbell Rd., Richardson Tex"
    email         : "bmizener@utdallas.edu"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Stimuli creation
      - Survey design & creation
      - Data collection & processing
      - Statistical analyses
      - Writing - Original draft preparation
  - name          : "Mathilde Vandenberghe"
    affiliation   : "2"
    role:
      - Original concept
      - Survey design & creation
  - name          : "Hervé Abdi"
    affiliation   : "1"
    role:
      - Writing - Review & Editing
      - Statistical guidance
  - name          : "Sylvie Chollet"
    affiliation   : "2"
    role:
      - Original concept

affiliation:
  - id            : "1"
    institution   : "University of Texas at Dallas"
  - id            : "2"
    institution   : "YNCREA"

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  French and American participants listened to new music stimuli and evaluated the stimuli using either adjectives or quantitative musical dimensions. Results were analyzed using Correspondence Analysis (CA), Hierarchical Cluster Analysis (HCA), Multiple Factor Analysis (MFA), and Partial Least Squares Correlation (PLSC). All except the HCA used Bootstrapping and Permutation testing for inferences. French and American listeners differed when they described the musical stimuli using adjectives, but not when using the quantitative dimensions. The present work serves as a case study in research methodology that allows for a balance between relaxing experimental control and maintaining statistical rigor.
  
keywords          : "Music, Emotion, Multivariate Analyses"
wordcount         : "5631"

bibliography      : ["Music Descriptor Space.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no

documentclass     : "apa6"
csl               : "apa7.csl"
classoption       : "man"
output            : 
  papaja::apa6_pdf: 
    latex_engine    : "xelatex"
header-includes   :
          - \usepackage{caption}
          - \usepackage{subcaption}
          - \usepackage{wrapfig}

---

```{r setup, include = FALSE}
# Seed for random number generation
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message=FALSE, fig.align = "center",cache.extra = knitr::rand_seed)
set.seed(42)

papaja::r_refs("r-references.bib")
```

```{r analysis-preferences}
library("papaja")
suppressMessages(library(ExPosition))
suppressMessages(library(InPosition))
suppressMessages(library(MExPosition))
library(PTCA4CATA)
library(purrr)
library(plyr)
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
library(rlist)
library(wesanderson)
#library(kableExtra)
library(ggplotify)
library(gridExtra)
library(grid)
library(abind)

```

```{R graphPath}
powerpointFilename <- 'Music-Descriptor-Space.pptx'
path2pptx    <- './Analysis/'
name4Graphs  <- paste0(path2pptx,powerpointFilename)
title4Graphs <- 'Music Descriptor Space '
```


```{r citations, eval = FALSE, echo=FALSE, include=FALSE}




```
---
  We have a data collection problem: World events over the last year have shown that we need to be able to collect good data outside of the lab. In the lab, because we control error sources, we measure, on relatively small sets of observations, a few well-defined, quantitative variables, analyzed using standard techniques such as analysis of variance (ANOVA). But, with the labs closed (remember COVID?), how can we collect good data? Away from the controlled environment of the lab, quantitative variables are hard to measure, but we can collect, on large sets of observations, qualitative variables that can only be analyzed by newer multivariate techniques. In the present paper, we present a case study illustrating this tradeoff.  

  Doesn’t beer taste better in a bar? Or when you’re listening to your favorite song? The present study was designed to quantify a music listening ‘space’ that captures perceptual and cognitive dimensions for the sake of investigating cross-modal sensory mapping between beer drinking and music listening. It also addresses other questions: Are there differences in how people from different countries --- and by extension musical cultures --- perceive and describe music? And: What parallels exist between qualitative and quantitative descriptions of music?

  For the present study, we have defined 1) perceptual dimensions as quantitative musical qualities, such as tempo, range, and meter and 2) cognitive dimensions as qualitative descriptions of music, such as 'dark', 'warm', and 'round'. These cognitive/qualitative dimensions are similar to the commonly investigated affective or emotional dimensions, but do not specifically assess affective quality. To quantify individual and combined spaces for these two concepts, we created two separate surveys, using simple multiple choice questions and a check-all-that-apply paradigm (CATA, Katz & Braly, 1933; Meyners & Castura, 2014; Coombs et al., 1956), both of which are easy for researchers to present and for participants to complete. 
  
  To analyze our data, we selected a set of multivariate analyses that allowed us to visualize answers to each of our questions. The mental spaces revealed by the individual surveys were calculated and visualized using Correspondence Analysis (CA), a method similar to Principal Components Analysis (PCA) that analyzes qualitative data. We used Multidimensional Scaling (MDS), a distance analysis, to visualize the differences between participants and participant groups. To find parallels between the surveys, we used Partial Least Squares Correlation (PLSC) --- a method that analyzes two data tables with different sets of variables measured on the same observations. We used a Multiple Factor Analysis to evaluate how French and American participants' responses differed.
 
## Music Perception

  Quantifying music perception is an interesting test case for this kind of data gathering and analytical paradigm. Most music or auditory perception studies have the inherent confound that small changes can affect listeners' perception, especially when the study involves timing, tuning, or sound localization. However, the experimental controls may be loosened slightly when investigating holistic music listening, because no single musical element is more important than the whole.  
  
  Quantitative and qualitative elements of music are theoretically distinct but practically inseparable [@BrunerII1990]. Listeners respond affectively to technical aspects of music using internal perceptual and cognitive schemata informed by their individual musical experiences and personality traits [@Kopacz2005], and composers use various musical and compositional techniques to convey the emotions they want to express [@BrunerII1990; @Battcock2019]. However, quantifying the perceptual interactions between more than one or two musical qualities is a challenge. One reason is that models like ANOVA and its variations are limited by how many variables a researcher can include while remaining coherent. Another is that asking participants to respond to multiple aspects of a stimulus taxes participants' perceptual capacity and is thus difficult to measure [@Thompson1994].  

  One specific area that has attempted to capture a greater dimensionality is music emotion research. This is a well trod domain --- see, for example @Juslin2010 --- and the application of multivariate analyses to these questions is similarly well established. Early studies, including @Gray1967, @Wedin1969, and @Wedin1972 used MDS to capture the affective space of various musical stimuli. MDS continues to be used commonly in more modern studies [@Madsen1997; @Bigand2005; @Roda2014], with a narrow focus on valence and arousal, two dimensions first proposed to be the most salient dimensions of perception by @Osgood1955. 
  
  A few studies have specifically investigated dimensions beyond those first two (for example Rodà et al., 2014), and there is  recent conflicting evidence as to whether the valence-arousal plane represents the fundamental dimensionality behind music emotion perception [@Cowen2020]. Some hypotheses suggest there are "at least 13 dimensions" [@Cowen2020] to the subjective music and emotion perceptual space [@Juslin2008a].    
 
  An important distinction between the present study and work in music emotion perception is that the adjectives we chose were informed by music composition and performance, rather than emotion [@Wallmark2019]. The present study, therefore, is in some ways more aligned with studies that evaluate timbre (for a full treatment see Wallmark & Kendall, 2018). 

### Intercultural music perception

  There are a few common goals in intercultural studies of music perception. Some aim to quantify the shared emotional experience between musical cultures [@Fritz2009; @Balkwill1999; @Cowen2020; @Gregory1996; @Darrow1987; @Balkwill2004], and some ask participants to identify technical aspects of the intercultural music [@Raman2016; @Raman2017]. There are fewer studies that include semantics in their evaluation of music perception [@Zacharakis2014; @Zacharakis2015], which makes this a prime area for research.

 The research program presented in @Zacharakis2014 and @Zacharakis2015 deal specifically with timbre perception (as opposed to holistic music perception, as in the present study). However, their use of adjectives is similar. @Zacharakis2014 and @Zacharakis2015 asked Greek and English participants to describe timbre in their own languages, and found that while there are some specific differences, overall, participants' descriptions of timbre do not differ much between languages.  


## Present questions & methods of analysis

  The basic question was simple: how do French and American participants describe music? Our investigative paradigm, along with sample and size, are addressed in the methods section below, but we felt it may be useful to provide a quick overview of the data collection and analytical techniques for readers who may be unfamiliar.  

### Check-all-that-apply (CATA)

  The CATA technique --- a method widely used in sensory evaluation --- measures how participants evaluate a set of stimuli [@Katz1933; @Meyners2014; @Coombs1956; @Valentin2012]. In a CATA task, stimuli are presented one at a time, and for each stimulus, participants are shown a list of descriptors and are asked to select the descriptors that describe the presented stimulus [@Meyners2014]. CATA easily assesses questions with multiple 'correct' responses [@Coombs1956], and places little cognitive demand on participants because they do not have to generate responses [@Ares2010].  
  CATA data are analyzed by 1) computing a pseudo contingency table that records the number of times descriptors were associated with stimuli and 2) analyzing this data table with Corresponence Analysis (CA) in order to visualize the patters of association between a) stimuli, b) descriptors, and c) stimuli and descriptors.  
  
### Correspondence Analysis

  The primary analysis used on the data collected in the surveys is Correspondence Analysis (CA) [@Escofier-Cordier1965; @Benzecri1973; @Greenacre1984]. CA analyzes a contingency table, or any data structured similarly, and calculates the relationships between rows (observations) and columns (variables); in our case, musical excerpts and descriptors. The nature of the CA allows for observations and variables to be visualized in the same space using biplots.
  
### Partial Least Squares Correlation

  Partial Least Squares Correlation (PLSC) [@Tucker1958; @Abdi2013a] analyzes two data tables that describe a single set of observations (rows) with different sets of variables (columns). PLSC computes a matrix of correlations between the sets of variables which is then analyzed to find latent variables with the largest covariance, i.e., the greatest amount of information common to the two data tables. This technique is commonly used in neuroimaging studies to evaluate correlations between matrices of imaging data and of behavioral or task data [@Krishnan2011].   

### Multidimensional Scaling

  Multidimensional Scaling (MDS) [@Borg2005] --- a technique commonly used in music perception studies [@Wedin1969; @Wedin1972; @Roda2014; @Madsen1997; @Bigand2005] analyzes a distance matrix computed between observations and visualizes them, positioning these observations on a map such that the distance between observations on the map best approximates their distance in the data table.    

### Multiple Factor Analysis

  Multiple Factor Analysis (MFA) [@Abdi2013] is an extension of PCA that analyzes and visualizes multiple tables or sets of variables that each describe the same observations. MFA visualizations are focused on the relationships between observations, and, for each observation, the relationships between the tables that contributed to that observation.  
  
### Inference Methods

  Because the methods outlined above are not inferential methods, and do not inherently allow for hypothesis testing, we use permutation testing [@Berry2011] and bootstrapping [@Hesterberg2011]. For both of these methods, the significance level to which we can infer depends on the number of iterations, with more iterations required for stricter significance levels.
  Permutation testing indicates the overall significance of our observed data. This technique depends on the fact that for any data table, extracting larger eigenvalues means that there is a clearer signal in the data. To see whether our data have a signal that is more salient than a random table, we shuffle the data, compute eigenvalues on each iteration, and compare those eigenvalues to the ones computed from the original data. If our observed data are less random than the randomly shuffled permutations, then the original eigenvalues should be larger than at least 95% of the permuted eigenvalues (for the standard $\alpha$ of .05). 
  Bootstrapping indicates whether our data are stable. This technique involves resampling the data with replacement --- which means that the same observation may be selected multiple times in the same iteration --- and calculating the mean for each iteration. If the data are stable, as we add iterations, each mean that we calculate will fall somewhere near the original mean. The narrower the distribution, the more stable the data. Calculating the distribution of these means gives us a confidence interval from which we can infer significance, that can be displayed visually in our multivariate plots. There are two primary applications for this: 1) to see if mean differences between groups of observations are significantly different and 2) to see if the individual observations or variables are consistent across participants.   
  
# Methods

## Participants
  Participants (*N* = 604) with self-reported normal hearing were recruited in multiple ways for both experiments: Participants in the United States (*N* = 292) were recruited using the traditional method of offering experimental participation credit, and also via social media. French participants (*N* = 312) were recruited by word of mouth, email, and social media. Although we suggest that data collected in this way hypothetically have a much greater reach, we recognize that the data collected for these experiments represent a convenience sample that is limited to participants that have access to the internet. Additionally because of the nature of social media, many of the participants in the researchers' social circles are themselves students. 
  The population we recruited was different for the two experiments. For Experiment 1, we specifically sought out highly trained musicians (*N* = 84) with ten years or more of music training. We recruited this population because trained musicians would be able to more precisely evaluate the perceptual dimensions of the stimuli as it relates specifically to the musical qualities, and would be able to to ascertain whether the stimuli truly reflected the composer's intent of varying on a wide range of musical dimensions [@Raman2017]. Participants were recruited for Experiment 2 (*N* = 520) without regard to level of music training.  
  Of the responses to Experiment 1, 51 were removed to incomplete data ($\textit{N}_F$ = 45, $\textit{N}_A$ = 6), leaving a total of 33 for the analysis. Of the responses to Experiment 2, 160 were removed for not completing the survey ($\textit{N}_F$ = 140, $\textit{N}_A$ = 20), leaving a total of 360. Responses to the survey administered in the US on which participants indicated a nationality other than American were excluded from analysis. "Ghanian", for example, was not included, but responses such as "Asian-American" were. This left a total of 279 survey responses for Experiment 2 and 312 for analysis across both experiments.  
  All recruitment measures were approved by the UT Dallas IRB.  

## Material

### Stimuli
  All stimuli were new, original musical excerpts, in various Western styles, composed by the first author specifically for this study (scores and audio files available upon request). The stimuli were all string quartets, designed to control for the confounding factor that different instruments are described in different ways [@Zacharakis2014; @Zacharakis2015] and otherwise vary along a number of music perceptual dimensions. The stimuli were composed to be coherent snippets approximately 30 s in length (actual range: 27 - 40 s, *M* = 32.4 s). Stimuli were composed using Finale composition software (Finale v25, MakeMusic, Inc.). Each stimulus was a wav file generated using the Finale human playback engine and embedded into a qualtrics question in that format.  

### Surveys
  There were two separate surveys presented to participants, one for each experiment, both administered using Qualtrics. The survey used in Experiment 1 (hereafter: Qualities Survey/QS) evaluated the musical stimuli on ten music perceptual dimensions such as tempo, range, and meter. The survey used in Experiment 2 (hereafter: Adjectives Survey/AS) consisted of a CATA task in which participants evaluated the stimuli using 33 adjectives such as 'dark', 'warm', and 'round'. Both surveys also gathered demographic data, including age, gender identity, nationality, occupation, and musical experience.  
  The qualities assessed in the QS were selected from standard music-theoretical descriptors of western music. The responses for each quality were presented in the vernacular, not using musical terminology. For example, when rating the excerpts on tempo, participants were asked to rate the excerpt using the scale *Very Slow*, *Slow*, *Moderately Slow*, *Moderate*, *Moderately Fast*, *Fast*, and *Very Fast*. The full list of musical qualities and answer choices is listed in the supplementary materials. The words for the AS were selected using @Wallmark2019 as a guide and in consult with a French professional musician. Some words were initially selected in French and some in English. In all cases, words were selected for which there was a clear French (vis-à-vis English) translation. The words are listed in English and in French in the supplementary materials.  

## Procedure
  Participants were provided with a link to either the QS or the AS. After standard informed consent procedures, participants listened to 15 excerpts presented one at time in a random order, and answered questions. Participants were instructed to listen to the excerpts presented either using headphones or in a quiet listening environment, but that was not controlled, nor was it assessed as part of the survey. Participants in Experiment 1 answered 10 questions per excerpt, one for each of the musical qualities being assessed. Participants in Experiment 2 answered a single CATA question per excerpt. All adjectives were presented, in a random order, for each question. Demographic survey questions followed the experimental task.  

### Data Processing
  Raw data were cleaned and processed in Excel and R. As described above, each of the analyses requires data in a different format. CA requires a contingency table or something like it, PLSC requires two tables with the same rows, MFA requires multiple tables with the same rows, and MDS requires a distance matrix. 
  To transform the data into these formats, we first translated all French responses into English. Then the response data for each participant was transformed into a pseudo contingency table, with the stimuli, as observations, on the rows, and the responses, as variables, on the columns. This way, instead of a table with qualitative information in each cell, we had a table with the response options as variables and ones and zeros as counts in each cell. These individual tables were then compiled into three-dimensional arrays, or "bricks", of data, one for each survey, such that each 'page' was an individual participant's responses. 
  To get the contingency table for CA, we summed each array along the pages into a pseudo-contingency table, which contained the responses as count data. The CAs for the experiments were performed on each pseudo-contingency table separately, and the PLSC was performed using both at the same time. 
  To get the distance matrix for the MDS, we computed a distance matrix for each of the bricks, so that the distance in each cell represented the distance between participants.  
  We only performed one MFA, on the results of the AS. To get the tables for MFA, we separated the AS brick into separate bricks for French and American participants and summed each along the pages. 
  To establish groups for inferences and visualization, the variables from the QS were grouped by quality (e.g., levels of tempo, types of genre). However, since we did not use *a priori* grouping variables for the excerpts or adjectives, the pseudo-contingency tables were evaluated using hierarchical cluster analyses (see supplementary materials) to see what groupings arose during evaluation.    

# Results
## Experiment 1: Musical Qualities Survey

```{r importQualdata}

load("catadatamusdim.RData")
musdimdata <- catadata.list$contingency
numberofdims <- catadata.list$numberofdims
thebrick <- catadata.list$thebrick

rows2drop <- c(6,14) 

musdimdata.no6 <- musdimdata[-rows2drop,]
thebrick.no6 <- thebrick[-rows2drop,,]
```

```{r Q.parts}

# reorder some of the columns in the french experts dataset, 
# taking only the ones we want to analyse for now
fr.ex.data <- catadata.list$french.expert.data[c(1:3,6,7,9:12),c(1,4,5,6,7)]
colnames(fr.ex.data) <- c("age", "gen", "nat", "tr_yrs", "tr_type")
fr.ex.data$gen[which(fr.ex.data$gen == "Homme")] <- "M"
fr.ex.data$gen[which(fr.ex.data$gen == "Femme")] <- "F"
fr.ex.data$nat <- "FR"
fr.ex.data$tr_type[which(fr.ex.data$tr_type == "Instrumentale")] <- "Inst"
fr.ex.data$tr_type[which(fr.ex.data$tr_type == "Vocale")] <- "Voc"

am.ex.data <- catadata.list$expert.data[,c(1:3,6,7)]
colnames(am.ex.data) <- colnames(fr.ex.data)
am.ex.data$nat <- "AM"
am.ex.data$gen[which(am.ex.data$gen == "Male")] <- "M"
am.ex.data$gen[which(am.ex.data$gen == "Female")] <- "F"
am.ex.data$tr_type[which(am.ex.data$tr_type == "Instrumental")] <- "Inst"
am.ex.data$tr_type[which(am.ex.data$tr_type == "Vocal")] <- "Voc"

# Bind it all together
ex.data <- rbind(am.ex.data, fr.ex.data)

bygender <- as.factor(ex.data$gen)
bynationality <- as.factor(ex.data$nat)

```

```{r Q.ca, cache = T, message=FALSE, warning=FALSE, include = FALSE}

dimcares.inf <- epCA.inference.battery(musdimdata.no6, 
                 masses= NULL, weights= NULL, 
                 hellinger = FALSE, symmetric = TRUE, 
                 graphs =FALSE, test.iters = 1000)

# Factor Scores
FIsym  <- dimcares.inf$Fixed.Data$ExPosition.Data$fi
#FIasym <- RenormFi$G_A
FJs    <- dimcares.inf$Fixed.Data$ExPosition.Data$fj
CA.Q.Eigs <- dimcares.inf$Fixed.Data$ExPosition.Data$eigs
CA.Q.pEig <- dimcares.inf$Inference.Data$components$eigs.perm
```

```{r someQcolors}
# Participant colors:
col4M <- wes_palettes$Rushmore1[3]
col4F <- wes_palettes$Rushmore1[5]
col4FR <- wes_palettes$Darjeeling1[1]
col4AM <- wes_palettes$Darjeeling2[2]
# 
col4byG <- as.character(bygender)
col4byG[col4byG == "F"] <- col4F
col4byG[col4byG == "M"] <- col4M

col4byN <- as.character(bynationality)
col4byN[col4byN == "FR"] <- col4FR
col4byN[col4byN == "AM"] <- col4AM

# To account for the fact that we removed some rows above:
numberofdims[c(1,7,8,9,10)] <- c(8,7,3,4,6)
numberofdims <- numberofdims[-11]

col4cols <- wes_palette("FantasticFox1", 
                        length(numberofdims), type = "continuous")
col4cols <- rep(col4cols, numberofdims)

```

```{r bootQCA, cache=TRUE}

bootCA <- Boot4PTCA(ZeDataCube = thebrick.no6,
           fi = FIsym,
           fj = FJs,
           eigs = CA.Q.Eigs,
           nf2keep = 3,
           nBootIter = 500)
# Compute Bootstrapped ratios
bootRatios.I <- PTCA4CATA::boot.ratio.test(bootCA$RowsBoot,
                                            critical.value = 2)
bootRatios.J <- PTCA4CATA::boot.ratio.test(bootCA$ColumnsBoot,
                                              critical.value = 2)
# Probabilities 
probBR.I  <- bootRatios.I$prob.boot.ratios
probBR.J  <- bootRatios.J$prob.boot.ratios
```

```{r ca4Judges.Q}
# We have a problem here because most matrices
#  have lines with zeros. A symmetric difference matrix 
#  would do better than an RV or a 
#  chi2 distance so we use createSymDist4PTCA

Cmat.Q <- createSymDist4PTCA(thebrick)$CrossProduct

# Calculate the eigenvalues and the percentage of variance extracted (tau)
eigenCmat.Q <- eigen(Cmat.Q, symmetric = TRUE)
eig4Cmat.Q <-  eigenCmat.Q$values
tau4Cmat.Q <- round( (100*eig4Cmat.Q) / sum(eig4Cmat.Q))

# Calculate factor scores for the first three dimensions
nk       <- 3
F4Cmat.Q   <- eigenCmat.Q$vectors[,1:nk] %*% diag(eig4Cmat.Q[1:nk]^(1/2))

# Prep for plotting
Shortnames4Participants.Q <-  dimnames(thebrick[[3]])
rownames(F4Cmat.Q) <- Shortnames4Participants.Q

# Make labels
labels4RV.Q <- createxyLabels.gen(1,2,lambda = eig4Cmat.Q, tau = tau4Cmat.Q)
```

### Participants

```{r screeRV, fig.height = 4, fig.width = 8, include = FALSE}
# Scree plot with significance
ScreeInf <- PlotScree(ev = eig4Cmat.Q,
                      max.ev = NULL, alpha = 0.05,
                      col.ns = "#006D2C", plotKaiser = TRUE,
                      title = "Participants Distance Analysis, Musical Qualities Survey: \nExplained Variance per Dimension")
a000.00.screeRV <-  recordPlot()
```
```{=latex}
\begin{wrapfigure}{h}{.5\textwidth}  
  \begin{center}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/screeRV-1.png}
  \caption{ }(\#fig:screeRVQ)  
 \end{center}
\end{wrapfigure}
```
  The scree plot in Figure \@ref(fig:screeRVQ) shows the eigenvalues for the distance analysis between musical experts. The usual guideline of analyzing only dimensions with eigenvalues greater than one seems prohibitive here, as all dimensions except the last have $\lambda$ > 1. For the purposes of this case study, we've opted to focus on the first two dimensions, with $\lambda$ = `r round(eig4Cmat.Q[1], 3)` and $\lambda$ = `r round(eig4Cmat.Q[2], 3)`, respectively. The fact that there are no dimensions that are exceptionally prominent suggests that each of the participants is contributing similarly to the dimensionality of this analysis. The MDS of the participants in this analysis revealed no significant differences between the experts based on any of the grouping variables used. The factor plots in Figure \@ref(fig:judgesplotQ) show how the means of the factor scores, grouped by nationality and gender identity, respectively, show the means clustered on top of one another, right at the origin. The overlapping ellipses are the confidence intervals for the means. The individual data points are the same between the two plots, but the means and confidence intervals are different because they were calculated using different grouping variables.


```{r judgesplotQ, fig.height = 5, out.width = '75%'}

BaseMap.Nationality <- createFactorMap(X = F4Cmat.Q ,
                              axis1 = 1, axis2 = 2,
                              display.points = TRUE,
                              col.points = col4byN,
                              pch = 19, cex = 2.5, 
                              title = "Colored according to Nationality",
                              display.labels = TRUE,
                              col.labels = col4byN,
                              text.cex = 4, font.face = "bold",
                              font.family = "sans",
                              col.axes = "darkorchid",
                              alpha.axes = 0.2,
                              width.axes = 1.1,
                              col.background = adjustcolor("lavender",
                                                       alpha.f = 0.2),
                              force = 1, segment.size = 3)

BaseMap.Gender <- createFactorMap(X = F4Cmat.Q ,
                              axis1 = 1, axis2 = 2,
                              display.points = TRUE,
                              col.points = col4byG,
                              pch = 19, cex = 2.5,
                              title = "Colored according to Gender",
                              display.labels = TRUE,
                              col.labels = col4byG,
                              text.cex = 4, font.face = "bold",
                              font.family = "sans",
                              col.axes = "darkorchid",
                              alpha.axes = 0.2,
                              width.axes = 1.1,
                              col.background = adjustcolor("lavender",
                                                       alpha.f = 0.2),
                              force = 1, segment.size = 3)

gendermeans <- getMeans(F4Cmat.Q, bygender)
nationmeans <- getMeans(F4Cmat.Q, bynationality)

BootCube.N <- PTCA4CATA::Boot4Mean(F4Cmat.Q, design = bynationality,
                      niter = 100,
                      suppressProgressBar = TRUE)
dimnames(BootCube.N$BootCube)[[2]] <- paste0('Dimension ',
                                             1: dim(BootCube.N$BootCube)[[2]])

BootCube.G <- PTCA4CATA::Boot4Mean(F4Cmat.Q, design = bygender,
                      niter = 100,
                      suppressProgressBar = TRUE)
dimnames(BootCube.G$BootCube)[[2]] <- paste0('Dimension ',
                                             1: dim(BootCube.G$BootCube)[[2]])

n.ellipse <- MakeCIEllipses(BootCube.N$BootCube[,1:2,], 
                            names.of.factors = c("Dimension 1","Dimension 2"),
                            col = c(col4AM, col4FR))
g.ellipse <- MakeCIEllipses(BootCube.G$BootCube[,1:2,], 
                            names.of.factors = c("Dimension 1","Dimension 2"),
                            col = c(col4M, col4F))

n.symdist.means <- createFactorMap(nationmeans,
                              axis1 = 1, axis2 = 2, 
                              title = "Colored according to Nationality",
                              col.points =  c(col4AM, col4FR),
                              alpha.points = 1, # no transparency
                              constraints = BaseMap.Nationality$constraints,
                              display.points = TRUE,
                              pch = 19, cex = 5,
                              display.labels = TRUE,
                              col.labels = c(col4AM, col4FR), 
                              text.cex = 4,font.face = "bold",
                              font.family = "sans", col.axes = "darkorchid", 
                              alpha.axes = 0.2, width.axes = 1.1, 
                              col.background = adjustcolor("lavender", alpha.f = 0.2), 
                              force = 1, segment.size = 0)

g.symdist.means <- createFactorMap(gendermeans,
                              axis1 = 1, axis2 = 2, 
                              title = "Colored according to Gender",
                              col.points =  c(col4M, col4F),
                              alpha.points = 1, # no transparency
                              constraints = BaseMap.Gender$constraints,
                              display.points = TRUE,
                              pch = 19, cex = 5,
                              display.labels = TRUE,
                              col.labels = c(col4M, col4F), 
                              text.cex = 4,font.face = "bold",
                              font.family = "sans", col.axes = "darkorchid", 
                              alpha.axes = 0.2, width.axes = 1.1, 
                              col.background = adjustcolor("lavender", alpha.f = 0.2), 
                              force = 1, segment.size = 0)

a.01.map4part <- BaseMap.Nationality$zeMap_background + labels4RV.Q +
                   n.symdist.means$zeMap_dots + n.ellipse +
                    BaseMap.Nationality$zeMap_dots + n.symdist.means$zeMap_text
                    

a.02.map4part <- BaseMap.Gender$zeMap_background + labels4RV.Q +
                  g.symdist.means$zeMap_dots + g.ellipse +
                    BaseMap.Gender$zeMap_dots + g.symdist.means$zeMap_text

grid.arrange(as.grob(a.01.map4part), 
             as.grob(a.02.map4part), ncol = 2,
             top = textGrob("Factor Scores for Participants in the Qualities Survey", 
                            gp = gpar(fontsize = 18, font = 3)))


```



### Excerpts

```{r getQeigs}
dim1eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[1]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)

dim2eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[2]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)

dim3eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[3]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)
```
```{r scree4excerptsq, include = FALSE}
mus.scree <- PlotScree(dimcares.inf$Fixed.Data$ExPosition.Data$eigs, 
                       dimcares.inf$Inference.Data$components$p.vals, 
                       plotKaiser = T, color4Kaiser = "red"
                                              ) 

mus.00.scree <- recordPlot()

```
```{=latex}
\begin{wrapfigure}{h}{.5\textwidth}  
  \begin{center}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/scree4excerptsq-1.png}
  \caption{ }(\#fig:scree4excerptsq)  
 \end{center}
\end{wrapfigure}
```

The scree plot for the analysis of the musical quality ratings survey, Figure \@ref(fig:scree4excerptsq), shows the high dimensionality of this space, with the first three dimensions extracting a total of `r dim1eigperc`%, `r dim2eigperc`% and `r dim3eigperc`% respectively, totaling only `r sum(dim1eigperc, dim2eigperc, dim3eigperc)`% of the variance. It isn't until we get to the 11th dimension that we see >80% of the variance explained. However, given that the assumption in an analysis like this is that the sample is random, it's important to take these numbers with a grain of salt. Music itself is not random, and in a single excerpt of music of the type that was presented in this study, repetition is common, and some musical qualities are inextricably linked, for example some stylistic elements with genre. 
  Graphing the variable loadings (see Figure \@ref(fig:contributionsQ)) of the musical qualities shows which ones contribute the most to the first two dimensions. Because of how CA is calculated, we know that the excerpts that load on the same dimension and direction as the musical qualities are the excerpts that are most associated with those qualities. The contributions shown here are only those that contribute significantly to the first two dimensions.
  There are some obvious groups of variables, especially tempo and articulation in the first dimension, with fewer contributions from the dynamics group. The tempo variables, which are a continuum, load from high (tempo.F6 and tempo.F7) in the positive direction to low (tempo.F2 and tempo.F1) in the negative direction. Other contributions are one-off: major harmony, triple meter, classical genre, undulating contour, and disjunct motion. The excerpts that load positively, and are therefore associated with the qualities that load in the positive direction, are all from group 2: Excerpts 4, 13, 23, and 26. The ones that load in the negative direction are from mostly from group 4: Excerpts 7, 10, 24, and 27, with one from group 3, Excerpt 3.  
  The second dimension seems to dominated by a few groups: harmony, meter, genre, dynamics. The one-offs are slow tempo, ascending contour, and "no melody". The excerpts that load significantly on this dimension are from all four groups. In the positive direction, it's Excerpts 7, 12, 15, and 27 from Group 4, and Excerpt 19 from Group 1. In the negative direction it's Excerpts 2, 3, 11, and 17. All are from group 3 except for Excerpt 2, which is from Group 2. A full enumeration of contributions, loadings, and boostrap ratios is available at the github url in the author note.

```{r justsomecontsQ}

load("excerptsdesign.RData")

col4exgrp <- excerptsdesign$ex.design$col4exgrp
ex.cols <- excerptsdesign$ex.design$ex.cols

signed.ctrI <- dimcares.inf$Fixed.Data$ExPosition.Data$ci * sign(FIsym)
signed.ctrJ <- dimcares.inf$Fixed.Data$ExPosition.Data$cj * sign(FJs)

CIlist.dim <- vector(mode = "list", length = 3)
CJlist.dim <- vector(mode = "list", length= 3)

names(CIlist.dim) <- c("Dim1", "Dim2", "Dim3")
names(CJlist.dim) <- c("Dim1", "Dim2", "Dim3")

for (i in 1:3){
  CIlist.dim[[i]] <- signed.ctrI[which(abs(signed.ctrI[,i]) > 1/nrow(signed.ctrI)),i]
  CJlist.dim[[i]] <- signed.ctrJ[which(abs(signed.ctrJ[,i]) > 1/nrow(signed.ctrJ)),i]
}

col4barsQ <- vector(mode = "list", length = 6)
names(col4barsQ) <- c("IDim1", "JDim1", "IDim2", "JDim2", "IDim3", "JDim3")

nrows <- nrow(signed.ctrI)

```

```{r contributionsQ, fig.width=10}
# plot contributions of rows for component 1
ctrI.1 <- PrettyBarPlot2(CIlist.dim$Dim1,
                         threshold = 1 / NROW(signed.ctrI),
                         font.size = 3,
                         color4bar = col4exgrp[which(abs(signed.ctrI[,1]) > 1/nrow(signed.ctrI))] , # we need hex code
                         ylab = 'Contributions', #sortValues = TRUE,
                         ylim = c(1.2*min(signed.ctrI[,1]), 1.2*max(signed.ctrI[,1]))
) + ggtitle("Component 1", subtitle = 'Rows')

# plot contributions of columns for component 1
ctrJ.1 <- PrettyBarPlot2(CJlist.dim$Dim1,
                         threshold = 1 / NROW(signed.ctrJ),
                         font.size = 3,
                         color4bar = col4cols[which(abs(signed.ctrJ[,1]) > 1/nrow(signed.ctrJ))], # we need hex code
                         ylab = 'Contributions',
                         ylim = c(1.2*min(signed.ctrJ[,1]), 1.2*max(signed.ctrJ[,1]))
) + ggtitle("", subtitle = 'Columns')

# plot contributions of rows for component 2
ctrI.2 <- PrettyBarPlot2(CIlist.dim$Dim2,
                         threshold = 1 / NROW(signed.ctrI),
                         font.size = 3,
                         color4bar = col4exgrp[which(abs(signed.ctrI[,2]) > 1/nrow(signed.ctrI))] , # we need hex code
                         ylab = 'Contributions',
                         ylim = c(1.2*min(signed.ctrI[,2]), 1.2*max(signed.ctrI[,2]))
) + ggtitle("Component 2", subtitle = 'Rows')

# plot contributions of columns for component 2
ctrJ.2 <- PrettyBarPlot2(CJlist.dim$Dim2,
                         threshold = 1 / NROW(signed.ctrJ),
                         font.size = 3,
                         color4bar = col4cols[which(abs(signed.ctrJ[,2]) > 1/nrow(signed.ctrJ))], # we need hex code
                         ylab = 'Contributions',
                         ylim = c(1.2*min(signed.ctrJ[,2]), 1.2*max(signed.ctrJ[,2]))
) + ggtitle("", subtitle = 'Columns')


grid.arrange(
    as.grob(ctrI.1),as.grob(ctrJ.1),
    as.grob(ctrI.2),as.grob(ctrJ.2),
    ncol = 2,nrow = 2,
    top = textGrob("Contributions, Qualities Survey", gp = gpar(fontsize = 18, font = 3))
  )

Ctr.IJ <- recordPlot()

#1 - blue, 2 - red, 3 - green, 4 - yellow
```

### Discussion

  The graph depicted in Figure \@ref(fig:factormapsQ) is a biplot depicting how excerpts and variables plot in the same space.  This biplot is possible because of the nature of correspondence analysis. Because the rows and columns of the contingency table X by definition have the same variance, the eigenvalues extracted from any matrix $\textit{X}$ are the same as $\textit{X}^\top$. Thus the axes on which the factor scores are plotted are the same for both the rows and the columns. However, interpretation requires some discernment. The distance between the excerpts can be interpreted directly as similarity, and the distance between the musical qualities can be interpreted directly as similarity, but the distance between a quality and an excerpt cannot. Instead, the angle between an excerpt and a quality is indicative of their correlation. An angle of 0 indicates a correlation of 1, an angle of 90 indicates a correlation of 0, and an angle of 180 indicates a correlation of -1.  
  Overall, this helps us to evaluate what qualities contribute to the excerpt groupings. These first two dimensions suggest that the hierarchical cluster analysis (see supplementary materials) revealed groupings roughly according to genre. However, there are two notable outliers. Excerpts 6 and 14 are unique in that they are each the only representative of their respective genres. Excerpt 6 is minimalist, à la Steve Reich, and Excerpt 14 is jazzy. Preliminary versions of this analysis showed that they dominated the 2nd and 3rd dimensions, respectively (see supplementary materials for visualizations). In the plot below, they are included instead as supplementary projections, essentially 'out of sample' elements. Their placement on the plot below alludes to the fact that the dimensionality of this space may in fact be related to musical genre or family. Although they dominated the space when included in the sample, they are much closer to the barycenter of the plot when included as out of sample. Were they to fall exactly on the origin, that would suggest that they shared no information whatsoever with the other excerpts included in the analysis. The disparity between their placement on the graph below and their placement on the graphs in which they are included in the main sample suggests that they share some information, but there is still a large amount of information that is not accounted for in the factor space depicted in Figure \@ref(fig:factormapsQ).  
  One perceptual element that is revealed here is that tempo and dynamics seem to contribute, intensity-wise, similarly to the first dimension. This points to two specific things. Firstly, it highlights possible bias in the compositional process. The excerpts were not intentionally composed with those characteristics being similar in mind, but it's entirely possible that the high or low arousal levels of the various excerpts that participants respond to also drove some of the compositional process, and that turned up in the results. Secondly, it's possible that the level of arousal was conflated between various musical qualities. For example, the intensity and therefore tempo of a stimulus may have been affected by the volume or dynamics [@Kamenetsky1997]. Perception of tempo is also affected by note rate or event density, which is also tied to arousal. In two pieces played at the same tempo, the one with more notes per unit time is more likely to be judged faster than one with fewer [@Drake1999].
  There are also a few musical elements revealed from the associations. The term staccato means short, or light and separated, and the term legato means smooth and connected. The participants in this experiment didn't have access to the notation, so they would be judging the excerpts aurally only. Between faster and slower excerpts, notes of the same rhythmic value take up less time in the faster excerpts, and may be more likely to be judged as light and separate, regardless of what the actual articulation was. Slow tempo and legato are associated differently. In terms of performance practice or pedagogy, slow notes are often intended to be connected as smoothly as possible, in order to create a sense of continuity. In terms of genre and harmony, many genres have harmonies associated with them [@Kennedy2013], and the coordinate mapping of jazz/blues harmony and genre (on the third dimension) is the most extreme example of this. A glance back at the factor scores plot shows us more detail: the older styles, baroque, classical, and romantic, are negative on the 2nd dimension, as are the simpler harmonies of major and minor. Likewise the newer western styles, impressionist, modern, and contemporary, load positively on the 2nd dimension, along with the more complex harmonies of chromatic, whole tone, and ambiguous. A brief historical survey of the development of western harmony provides an interpretation for this. The classical genre has fairly structured rules for both harmony and voice leading, but the romantic era relaxed those rules and introduced more complex harmonies. The gradual devolution of those rules and the increase in complexity of harmony continued through the modern and contemporary styles [@Kennedy2013]. Historically speaking, the whole tone scale wasn't used commonly until the impressionist era. 
  It is worth remembering, however, that because of the nature of this survey, these results tell us more about the perception of the excerpts themselves rather than the behavior of the participants. Because the excerpts were composed with the intent of varying across all of these musical dimensions, what we see is a sort of validation that there is, in fact, that variety among these excerpts, and that they are different enough to create a large and varied factor space. 

```{r factormapsQ, fig.width = 6, fig.show = 'hold', out.width='75%'}

axisone = 1
axistwo = 2

rownames(FIsym)<- c(1:5,7:13,15:30)
unsignedCJ <- dimcares.inf$Fixed.Data$ExPosition.Data$cj[,1:2]
signedCJ <- dimcares.inf$Fixed.Data$ExPosition.Data$cj * sign(FJs)

sig.colsonly <-  rownames(FJs)[(unsignedCJ[,1] > (1/nrow(FJs))) | 
                                 (unsignedCJ[,2] > (1/nrow(FJs))) ]

sig.FJs <- FJs[sig.colsonly,1:4]

col4sigcolsonly <- col4cols[(unsignedCJ[,1] > (1/nrow(FJs))) | 
                              (unsignedCJ[,2] > (1/nrow(FJs))) ]

mat6 <- as.matrix(catadata.list$contingency[c(6,14),])
colnames(mat6) <- colnames(catadata.list$contingency)

#test <- epCA(musdimdata.no6, 
#                  masses= NULL, weights= NULL, 
#                 hellinger = FALSE, symmetric = TRUE, 
#                 graphs =FALSE)

proj6 <- supplementaryRows(mat6, dimcares.inf$Fixed.Data)

rownames(proj6$fii) <- c("6","14")

scoresw6 <- rbind(FIsym, proj6$fii)

cols4proj <- c(col4exgrp, gplots::col2hex(c("blueviolet", "blueviolet")))

exmap.sym.12 <- createFactorMapIJ(scoresw6,
                                sig.FJs,
                                axis1 = axisone,axis2 = axistwo,
                                col.points.i = cols4proj, 
                                col.labels.i = cols4proj, 
                                col.points.j = col4sigcolsonly, 
                                col.labels.j = col4sigcolsonly,
                                text.cex.i = 4, text.cex.j = 2.5,
                                cex.i = 4, cex.j = 4,
                                font.face.j = "italic",
                                alpha.labels.i = 1, alpha.labels.j = 1
                                )

vc.labels.12 <- createxyLabels(resCA = dimcares.inf$Fixed.Data)

#ti.qs.12 <- MakeToleranceIntervals(scoresw6)

mus.012 <- exmap.sym.12$baseMap +  
            exmap.sym.12$I_points + 
              exmap.sym.12$I_labels + 
                exmap.sym.12$J_points + 
                  exmap.sym.12$J_labels + 
                    vc.labels.12 + ggtitle('Factor Map, Qualities Survey: Dimensions 1 and 2')
  
axisone = 3
axistwo = 2

exmap.sym.23 <- createFactorMapIJ(scoresw6,
                                sig.FJs,
                                axis1 = axisone,axis2 = axistwo,
                                col.points.i = cols4proj, 
                                col.labels.i = cols4proj, 
                                col.points.j = col4sigcolsonly, 
                                col.labels.j = col4sigcolsonly,
                                text.cex.i = 4, text.cex.j = 2.5,
                                font.face.i = "italic",
                                alpha.labels.i = 1, alpha.labels.j = 1
                                )

vc.labels.23 <- createxyLabels(resCA = dimcares.inf$Fixed.Data, 
                               x_axis = axisone,
                               y_axis = axistwo)

mus.023 <- exmap.sym.23$baseMap + #zePoly.J + 
            exmap.sym.23$I_points + 
              exmap.sym.23$I_labels + 
                exmap.sym.23$J_points + 
                  exmap.sym.23$J_labels + 
                    vc.labels.23 + ggtitle('Dimensions 2 and 3')


print(mus.012)
#grid.arrange(
#    as.grob(mus.012),as.grob(mus.023),
#    ncol = 2,nrow = 1,
#    top = textGrob("Symmetric Maps of the Row and Column Factor Scores", gp = gpar(fontsize = 18, font = 3))
#  )

#mus.012.023 <- recordPlot()


```

## Experiment 2: Musical Adjectives Survey

```{r Adatain}
rm(list = ls())

load("adj.catadata.list.RData")
load("excerptsdesign.RData")
load("adjdesign.RData")
load("adjectivecolors.RData")

partcols <- adj.catadata.list$partcols
adjbrick <- adj.catadata.list$adjbrick
adj.contingency <- adj.catadata.list$adjcontingency
adjcols <- adj.catadata.list$adjcols
listofwords <- adj.catadata.list$listofwords

nat.factor <- partcols$nationality
col4nat <- nat.factor
nat.factor <- as.factor(nat.factor)

train.factor <- as.double(partcols$tr_yrs)
train.factor[train.factor < 2] <- "Tr.none"
train.factor[train.factor >= 2 & train.factor <= 5] <- "Tr.little"
train.factor[train.factor != "Tr.none" & train.factor != "Tr.little"] <- "Tr.some"
train.factor <- as.factor(train.factor)

gen.factor <- partcols$gender
gen.factor[gen.factor != "Female" & gen.factor != "Male" 
           & gen.factor != "Femme" & gen.factor != "Homme"] <- "NB"
gen.factor[gen.factor == "Female" | gen.factor == "Femme"] <- "F"
gen.factor[gen.factor == "Male" | gen.factor == "Homme"] <- "M"
gen.factor <- as.factor(gen.factor)

```

```{r A.CA}
adjsym.cares <- epCA(adj.contingency, 
                     symmetric = TRUE)

adjrenorm <- CARenormalization(adjsym.cares$ExPosition.Data$fi,
                               delta = adjsym.cares$ExPosition.Data$pdq$Dv,
                               singularValues = T,
                               masses = adjsym.cares$ExPosition.Data$M
                               )

FIsym.adj <- adjsym.cares$ExPosition.Data$fi
FIasym.adj <- adjrenorm$G_A
FJs.adj <- adjsym.cares$ExPosition.Data$fj
CAEigs.adj <- adjsym.cares$ExPosition.Data$eigs
```

```{r inferences.A, cache = TRUE}
# Bootstrapping
bootCA.adj <- Boot4PTCA(ZeDataCube = adjbrick,
                        fi = FIsym.adj,
                        fj = FJs.adj,
                        eigs = CAEigs.adj,
                        nf2keep = 3,
                        nBootIter = 500)
# Compute Bootstrapped ratios
bootRatadj.I <- PTCA4CATA::boot.ratio.test(bootCA.adj$RowsBoot,
                                            critical.value = 2)
bootRatadj.J <- PTCA4CATA::boot.ratio.test(bootCA.adj$ColumnsBoot,
                                              critical.value = 2)
# Probabilities 
probBRadj.I  <- bootRatadj.I$prob.boot.ratios
probBRadj.J  <- bootRatadj.J$prob.boot.ratios

# Permutation tests
adjca.inf <- perm4PTCA(aCube = adjbrick,
                       nIter = 1000,
                       permType = 'byRows' ,
                       Malinvaud = TRUE)
Ind.Permu.adj    <- adjca.inf$permInertia
InertiaFixed.adj <- adjca.inf$fixedInertia
prob.cpt.lst.adj <- adjca.inf$MalinvaudQ['p-perm',]
# Get the p values for the components
prob.cpt.adj <- (unlist(prob.cpt.lst.adj[2:length(prob.cpt.lst.adj)]))
prob.cpt.adj[is.na(prob.cpt.adj)] <- 1
```

```{r partdistance.A}

Cmat.adj <- createSymDist4PTCA(adjbrick)$CrossProduct

eigenCmat.adj <- eigen(Cmat.adj, symmetric = TRUE)
eig4Cmat.adj <-  eigenCmat.adj$values
tau4Cmat.adj <- round( (100*eig4Cmat.adj) / sum(eig4Cmat.adj))

nk       <- 3
F4Cmat.adj   <- eigenCmat.adj$vectors[,1:nk] %*% diag(eig4Cmat.adj[1:nk]^(1/2))

rownames(F4Cmat.adj) <- rownames(Cmat.adj)
```

```{r apartscree, include = FALSE}
ScreeInf <- PlotScree(ev = eig4Cmat.adj,
             max.ev = NULL, alpha = 0.05,
             col.ns = "#006D2C", col.sig = "#54278F",
             title = "Participants Distance Analysis, Adjectives Survey: \nExplained Variance per Dimension",
             plotKaiser = T)

a000.adj.screeRV <-  recordPlot()
```  
### Participants
```{=latex}
\begin{wrapfigure}{h}{.5\textwidth}  
  \begin{center}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/a.part.scree-1.png}
  \caption{ }(\#fig:apartscree)  
 \end{center}
\end{wrapfigure}
```
The scree plot depicted in Figure \@ref(fig:apartscree) shows the explained variance per dimension for the distance analysis of participants in the adjectives survey. Again, having a high number of participants means that the dimensionality is high, and each dimension is only extracting a little variance. The first five dimensions all have $\lambda$ > 1: `r round(eig4Cmat.adj[1], 2)`, `r round(eig4Cmat.adj[2], 2)`, `r round(eig4Cmat.adj[3], 2)`, `r round(eig4Cmat.adj[4], 2)`, and `r round(eig4Cmat.adj[5], 2)`, respectively, but because of the high dimensionality here, the first dimension extracts only ~3% of the overall variance. Again, as above, for the purposes of this case study, we're focusing on the first two dimensions.  
  An MDS analysis of a distance matrix calculated from the pages of the brick revealed significant group differences in how French and American participants described the excerpts, $\textit{p}$. < .01. The factor scores of the participants are plotted in Figure \@ref(fig:map4RVA), with with group means and bootstrapped confidence intervals shown for those means. The bootstrapping resampling was performed with 1000 iterations. We also analyzed the data using two other participant groupings as factors: gender identity, with three levels: Male, Female, or Non-Binary, and level of music training, with three levels: < 2 years, 2-5 years, and >5 years. Neither of these analyses revealed any significant differences between groups.  

```{r map4RVA, fig.height=6, out.height = "30%", include = FALSE}
Shortnames4Participants <-  dimnames(adjbrick[[3]])
F4Plot <- F4Cmat.adj
rownames(F4Plot) <- Shortnames4Participants
# Make labels
labels4RV <- createxyLabels.gen(1,2,lambda = eig4Cmat.adj, tau = tau4Cmat.adj)

#Here we calculate the means for the factor groupings, and then bootstrap them:
n.adjmeans <- getMeans(F4Plot, nat.factor)
BootCadj.N <- PTCA4CATA::Boot4Mean(F4Cmat.adj, design = nat.factor,
                                   niter = 1000,
                                   suppressProgressBar = TRUE)
dimnames(BootCadj.N$BootCube)[[2]] <- paste0('Dimension ',
                                             1:dim(BootCadj.N$BootCube)[[2]])
# Create ellipses for the map
n.elliadj <- MakeCIEllipses(BootCadj.N$BootCube[,1:2,],
                            names.of.factors = c("Dimension 1", "Dimension 2"),
                            col = cols$n.gc)
#Base map
BaseMap.Participants <- createFactorMap(X = F4Plot ,
                              axis1 = 1, axis2 = 2,
                              display.points = TRUE,
                              col.points = cols$n.oc,
                              pch = 19, cex = 2.5,
                              display.labels = TRUE,
                              col.labels = cols$n.oc,
                              text.cex = 4, font.face = "bold",
                              font.family = "sans",
                              col.axes = "darkorchid", 
                              alpha.points = .25,
                              alpha.axes = 0.2,
                              width.axes = 1.1,
                              col.background = adjustcolor("lavender",
                                                       alpha.f = 0.2),
                              force = 1, segment.size = 3)

#Nationality map
title4RV <- "RV Analysis of Participants \nIncluding Group Means and Confidence Intervals"
n.rv.means <- createFactorMap(n.adjmeans,
                              axis1 = 1, axis2 = 2, 
                              constraints = BaseMap.Participants$constraints, 
                              col.points =  cols$n.gc,
                              alpha.points = 1, # no transparency
                              alpha.labels = 1,
                              display.points = TRUE,
                              pch = 17, cex = 5,
                              display.labels = TRUE, 
#                              title = title4RV,
                              col.labels = cols$n.gc, 
                              text.cex = 6,font.face = "bold",
                              font.family = "sans", col.axes = "darkorchid", 
                              alpha.axes = 0.2, width.axes = 1.1, 
                              col.background = adjustcolor("lavender", alpha.f = 0.2), 
                              force = 1, segment.size = 0)

a.03adj.map4part <- BaseMap.Participants$zeMap_background + 
                  n.rv.means$zeMap_text + n.rv.means$zeMap_dots +
                    BaseMap.Participants$zeMap_dots + n.elliadj + labels4RV


print(a.03adj.map4part)
```

```{=latex}
\begin{figure}   
  \centering  
  \caption{${R_V}$ Analysis of Participants in the Adjectives Survey}
    \includegraphics[width=0.7\columnwidth]{./Music-Descriptor-Space_files/figure-latex/apartrvmap.png}
  \label{fig:map4RVA}
  \caption*{\footnotesize \textit{Note.}  Group means are indicated with triangles and labled with AM and FR. The ellipse around the group mean indicates the confidence interval, after bootstrapping 1000 iterations. The fact that there is a clear separation between the group means and the confidence intervals suggests that there is a significant difference between the groups, \textit{p} > .001.}
\end{figure}
```

### Excerpts

```{r}
adj.tau <- adjsym.cares$ExPosition.Data$t
```


  The plot in Figure \@ref(fig:scree4descriptors) shows the explained variance per dimension in the analysis of the excerpts contingency table. Although there are no components with $\lambda$ > 1, there are two strong dimensions that extract a majority of the variance. The first two dimensions extract `r round(sum(adj.tau[c(1,2)]), 2)`% of the variance, with the first dimension extracting a majority: `r round(adj.tau[1], 2)`%, and the second dimension extracting almost a quarter of the overall variance: `r round(adj.tau[1],2)`%. 
```{=latex}
\begin{wrapfigure}{h}{.5\textwidth}  
  \begin{center}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/scree4descriptors-1.png}
  \caption{ }(\#fig:scree4descriptors)  
 \end{center}
\end{wrapfigure}
```
This plot also suggests that there are multiple 'elbows', at the 3rd, 5th, and 7th dimensions, respectively, with the third and fourth dimensions forming an 'eigen-plane', of two dimensions which extract similar amounts of variance and should be considered together. For this analysis, however, we're focused on the two first dimensions. Additionally, although excerpts 6 and 14 are outliers in the musical qualities survey, for reasons detailed above, they were not outliers in this analysis. We therefore included them in all of the analyses for Experiment 2.
```{r scree4descriptors, include = FALSE}
adj.scree <- PlotScree(adjsym.cares$ExPosition.Data$eigs, 
                       p.ev = adjca.inf$pEigenvalues,
                       plotKaiser = T, color4Kaiser = "red")
  
mus.00.scree <- recordPlot()
```




  The contributions to the first two dimensions are depicted in Figure \@ref(fig:contributionsA). Contributing significantly to the positive end of the first dimension are excerpts from group three (green) and to the negative end are excerpts from group one (yellow). Strong contributions on the positive end of the dimension from the adjectives "Sad", "Dark", "Melancholy", "Slow", "Mysterious", "Solemn", and "Disturbing". The negative end of the first dimension is defined by the adjectives "Fast", "Happy", "Dancing", "Colorful", and "Bright". 
  The second dimension is dominated by excerpts from group 4 (red) in the positive direction and group 2 (blue) in the negative direction. Two excerpts from group 3 also contribute significantly, excerpts 7 in the positive direction and excerpt 10 in the negative direction. The columns contributing strongly in the positive direction are "Aggressive", "Fast", "Disturbing", "Mysterious", "Surprising" and "Complex". The columns contributing in the negative direction are "Warm, "Soft", "Happy", "Slow", "Round", and "Light".  

```{r justsomecontsA}

signed.ctrI.adj <- adjsym.cares$ExPosition.Data$ci * sign(FIsym.adj)
signed.ctrJ.adj <- adjsym.cares$ExPosition.Data$cj * sign(FJs.adj)

CIlist <- vector(mode = "list", length = 2)
CJlist <- vector(mode = "list", length= 2)

names(CIlist) <- c("Dim1", "Dim2")
names(CJlist) <- c("Dim1", "Dim2")

for (i in 1:3){
  CIlist[[i]] <- signed.ctrI.adj[which(abs(signed.ctrI.adj[,i]) > 1/nrow(signed.ctrI.adj)),i]
  CJlist[[i]] <- signed.ctrJ.adj[which(abs(signed.ctrJ.adj[,i]) > 1/nrow(signed.ctrJ.adj)),i]
}
```

```{r contributionsA, fig.width=10}
# plot contributions of rows for component 1
ctradjI.1 <- PrettyBarPlot2(CIlist[[1]],
                         threshold = 1 / NROW(signed.ctrI.adj),
                         font.size = 3,
                         color4bar = cols$ex.oc[which(abs(signed.ctrI.adj[,1]) > 1/nrow(signed.ctrI.adj))], # we need hex code
                         ylab = 'Contributions',
                         #sortValues = TRUE,
                         ylim = c(1.2*min(CIlist[[1]]), 1.2*max(CIlist[[1]]))
) + ggtitle("Component 1", subtitle = 'Rows')

# plot contributions of columns for component 1
ctradjJ.1 <- PrettyBarPlot2(CJlist$Dim1,
                         threshold = 1 / NROW(signed.ctrJ.adj),
                         font.size = 3,
                         color4bar = cols$adj.oc[which(abs(signed.ctrJ.adj[,1]) > 1/nrow(signed.ctrJ.adj))], # we need hex code
                         ylab = 'Contributions',
                        # sortValues = TRUE,
                         ylim = c(1.2*min(CJlist[[1]]), 1.2*max(CJlist[[1]]))
) + ggtitle("", subtitle = 'Columns')

# plot contributions of rows for component 2
ctradjI.2 <- PrettyBarPlot2(CIlist[[2]],
                         threshold = 1 / NROW(signed.ctrI.adj),
                         font.size = 3,
                         color4bar = cols$ex.oc[which(abs(signed.ctrI.adj[,2]) > 1/nrow(signed.ctrI.adj))], # we need hex code
                         ylab = 'Contributions',
                        # sortValues = TRUE,
                         ylim = c(1.2*min(signed.ctrI.adj[,2]), 1.2*max(signed.ctrI.adj[,2]))
) + ggtitle("Component 2", subtitle = 'Rows')

# plot contributions of columns for component 2
ctradjJ.2 <- PrettyBarPlot2(CJlist$Dim2,
                         threshold = 1 / NROW(signed.ctrJ.adj),
                         font.size = 3,
                         color4bar = cols$adj.oc[which(abs(signed.ctrJ.adj[,2]) > 1/nrow(signed.ctrJ.adj))], # we need hex code
                         ylab = 'Contributions',
                        # sortValues = TRUE,
                         ylim = c(1.2*min(signed.ctrJ.adj[,2]), 1.2*max(signed.ctrJ.adj[,2]))
) + ggtitle("", subtitle = 'Columns')

grid.arrange(
    as.grob(ctradjI.1),as.grob(ctradjJ.1),
    as.grob(ctradjI.2),as.grob(ctradjJ.2),
    ncol = 2,nrow = 2,
    top = textGrob("Contributions, Adjectives Survey", gp = gpar(fontsize = 18, font = 3))
  )

Ctradj.IJ <- recordPlot()

#yellow is 1, blue is 2, green is 3, red is 4.

```

  The barplots in Figure \@ref(fig:thebootsA) show the bootstrap ratios calculated for the rows and columns. Here we've included all of the rows and columns, because it's useful to see both which are significant and which are not. This is an inferential method that tells us is how consistently each of the observations and variables load on the first two dimensions. The threshold in this case is *p* < .05. From this we get an idea of which of the rows and columns are stable, in other words, which ones tended to be rated in a certain way consistently across all participants, and also how likely these are to be observations reflective of the population as a whole. In this plot, the more extreme value of the bootstrap ratio, the more likely that it is a reflection of the 'real' value. The values in the center of each plot that are grayed out identify the rows or columns that are not consistently loading on the dimensions. With the observations and variables ordered like this, it makes it easy to see how the consistently the clusters are distributed in the space. This plot was not included for Experiment 1 because it would be less informative given what the survey in Experiment 1 was assessing. Experiment 1 doesn't evaluate the behavior of participants, but the nature of the excerpts.
  Note that there are far more significant bootstrap ratios than there are significant contributions. That just means that while not everything is contributing, overall the model seems to be stable. Fewer significant bootstrap ratios would suggest that there was a greater amount of variance in the observations and variables than were accounted for, at least in the first two dimensions. Looking at the nonsignificant values for the adjectives may inform our understanding of the participants' use of the adjectives. 'Incisive', 'transparent', 'poweful', 'dense', 'round', and 'sparse', are all nonsignificant on the first dimension, and 'weak', 'dull', 'sparse', 'valiant', and 'short' are all nonsignificant on the second dimension. All but 'sparse' are significant on one dimension or the other. Looking at the column sum for 'sparse' tells us that it was used, so this isn't an effect of participants not using this word. It's more likely that 'sparse' doesn't really fit into the Valence-arousal plane. It's a neutrally valenced word that could describe excerpts that fall anywhere within that plane. 'Weak' and 'transparent' give us another important perspective. These were the two least commonly used adjectives, but the fact that they are consistently loading on one dimension or the other suggests that when they were used, they were used in the same way. 
  
```{r bootstraps}
BR.I <- bootRatadj.I$boot.ratios
BR.J <- bootRatadj.J$boot.ratios

laDim = 1

# Plot the bootstrap ratios for Dimension 1
badj001.BR1.I <- PrettyBarPlot2(BR.I[,laDim],
                        threshold = 2,
                        font.size = 3,
                   color4bar = cols$ex.oc[order(BR.I[,laDim])], # we need hex code
                  ylab = 'Bootstrap ratios',
                  sortValues = TRUE,
) + ggtitle(paste0('Component ', laDim), subtitle = 'Rows')

badj002.BR1.J <- PrettyBarPlot2(BR.J[,laDim],
                        threshold = 2,
                        font.size = 3,
                   color4bar = cols$adj.oc[order(BR.J[,laDim])],
                  ylab = 'Bootstrap ratios',
                  sortValues = TRUE,
) + ggtitle("", subtitle = 'Columns')

# Plot the bootstrap ratios for Dimension 2
laDim = 2
badj003.BR2.I <- PrettyBarPlot2(BR.I[,laDim],
                        threshold = 2,
                        font.size = 3,
                   color4bar = cols$ex.oc[order(BR.I[,laDim])], # we need hex code
                  ylab = 'Bootstrap ratios',
                  sortValues = TRUE,
) + ggtitle(paste0('Component ', laDim), subtitle = 'Rows')

badj004.BR2.J <- PrettyBarPlot2(BR.J[,laDim],
                        threshold = 2,
                        font.size = 3,
                   color4bar = cols$adj.oc[order(BR.J[,laDim])],
                  ylab = 'Bootstrap ratios',
                  sortValues = TRUE, 
) + ggtitle("", subtitle = 'Columns')

```

```{r thebootsA, fig.width=14}

grid.arrange(
    as.grob(badj001.BR1.I),as.grob(badj002.BR1.J),
    as.grob(badj003.BR2.I),as.grob(badj004.BR2.J),
    ncol = 2,nrow = 2,
    top = textGrob("Bootstrap ratios", gp = gpar(fontsize = 18, font = 3))
  )

BRadj.IJ <- recordPlot()

```  

### Discussion
  
  The factor maps below show the row and column factor scores for the American and French participants. These are once again symmetric plots, interpretation is the same as the factor plot for the musical qualities. There's a clear valence-arousal plane apparent for both, and in both cases valence seems to define the first dimension and arousal defines the second dimension. However, the difference in the amount of variance extracted by the first two dimensions between the French and American participants is notable. The French data show a weaker first dimension but a stronger second dimension relative to the Americans, both in terms of variance extracted (tau), effect size (lambda). This tells us that French participants were less affected by the excerpts than the American participants, but they responded more to the arousal of the excerpts.
  There are also differences in how the adjectives and the excerpts are distributed in the space. One clear example is that Excerpt 6 is in quadrant two in the American plot, but quadrant one in the French. This is a small change, but it suggests that the French participants were more likely to assign negative valence to this excerpt, and American Participants were more likely to assign positive valence. For the adjectives, 'bright' and 'dancing' are directly on top of one another in the American plot, but there is some space between the two in the French plot.  It's possible that this reflects the idea that although the meaning is shared between languages, there are semantic or associational differences between the words.

```{=latex}
\begin{figure}   
  \centering  
  \caption{Symmetric Plots for Rows and Columns of the Adjectives Surveys, by Participant Nationality}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/factormapsA.png}
  \label{fig:factormapsA}
  \caption*{\footnotesize \textit{Note.}  For these plots, the survey responses were split by nationality and analyzed separately. Note the differences in variance extracted by each of the first two dimensions.}
\end{figure}
```


```{r factormapsA, fig.height = 8, fig.show = 'hold', out.width='100%', include = FALSE}

adjbrick.AM <- adjbrick[,,1:length(which(adj.catadata.list$partcols$nationality == "AM"))]
adj.cont.AM <- apply(adjbrick.AM, c(1,2), sum)

adjbrick.FR <- adjbrick[,,(length(which(adj.catadata.list$partcols$nationality == "AM"))+1):dim(adjbrick)[[3]]]
adj.cont.FR <- apply(adjbrick.FR, c(1,2), sum)

adj.fr.cares <- epCA(adj.cont.FR, symmetric = TRUE)
adj.am.cares <- epCA(adj.cont.AM, symmetric = TRUE)

adj.fr.cares$ExPosition.Data$fi[,2] <- adj.fr.cares$ExPosition.Data$fi[,2]*-1
adj.fr.cares$ExPosition.Data$fj[,2] <- adj.fr.cares$ExPosition.Data$fj[,2]*-1

am.FI <- adj.am.cares$ExPosition.Data$fi
am.FJ <- adj.am.cares$ExPosition.Data$fj

fr.FI <- adj.fr.cares$ExPosition.Data$fi
fr.FJ <- adj.fr.cares$ExPosition.Data$fj

rownames(am.FI) <- rownames(fr.FI) <- rownames(FIsym.adj) <- c(1:30)


colnames(adjrenorm$G_A) <- colnames(FJs.adj)

axisone <- 1
axistwo <- 2

exmap <- createFactorMapIJ(FIsym.adj,
                           FJs.adj,
                           axis1 = axisone,axis2 = axistwo,
                           col.points.i = cols$ex.oc, 
                           col.labels.i = cols$ex.oc, 
                           col.points.j = cols$adj.oc, 
                           col.labels.j = cols$adj.oc,
                           text.cex.i = 3.5, text.cex.j = 3.5,
                           font.face.j = 'italic',
                           
                           )

vc.labels <- createxyLabels(resCA = adjsym.cares)

am.labels <- createxyLabels(resCA = adj.am.cares)

fr.labels <- createxyLabels(resCA = adj.fr.cares)

exmap.am <- createFactorMapIJ(am.FI,
                                am.FJ,
                                axis1 = axisone,axis2 = axistwo,
                                col.points.i = cols$ex.oc, 
                                col.labels.i = cols$ex.oc, 
                                col.points.j = cols$adj.oc, 
                                col.labels.j = cols$adj.oc,
                                text.cex.i = 5, text.cex.j = 3.5, font.face.j = 'italic'
                                
                                )



exmap.fr <- createFactorMapIJ(fr.FI,
                                fr.FJ,
                                axis1 = axisone,axis2 = axistwo,
                                col.points.i = cols$ex.oc, 
                                col.labels.i = cols$ex.oc, 
                                col.points.j = cols$adj.oc, 
                                col.labels.j = cols$adj.oc,
                                text.cex.i = 5, text.cex.j = 3.5, font.face.j = 'italic'
                                )


mus.adj.am <- exmap.am$baseMap + 
            exmap.am$I_points + 
              exmap.am$I_labels + 
                exmap.am$J_points + 
                  exmap.am$J_labels + 
                    am.labels + ggtitle('American Participants')

mus.adj.fr <- exmap.fr$baseMap +  
            exmap.fr$I_points + 
              exmap.fr$I_labels + 
                exmap.fr$J_points + 
                  exmap.fr$J_labels + 
                    fr.labels + ggtitle('French Participants')

mus.adj.004 <- exmap$baseMap + #zePoly.J + 
            exmap$I_points + 
              exmap$I_labels + 
                exmap$J_points + 
                  exmap$J_labels + 
                    vc.labels + ggtitle('Symmetric Map of Row and Column Factor Scores')
  

grid.arrange(
    as.grob(mus.adj.am),as.grob(mus.adj.fr),
    ncol = 2,nrow = 1 
#    top = textGrob("Symmetric Maps of the Row and Column Factor Scores", gp = gpar(fontsize = 22, font = 3))
 )

am_fr_adjmaps <- recordPlot()


#print(mus.adj.004)
```


```{r A.MFA.ex, fig.height=10, message=FALSE, warning=FALSE, include = FALSE}
suppressMessages(library(MExPosition))

adj4MFA <- abind(adj.cont.FR, adj.cont.AM, along = 2)

frvec <- t(as.data.frame(rep("FR", length.out = dim(adj.cont.FR)[2])))
amvec <- t(as.data.frame(rep("AM", length.out = dim(adj.cont.AM)[2])))

colnames(frvec) <- colnames(amvec) <- colnames(adj.cont.FR)
rownames(frvec) <- rownames(amvec) <- "group"


mfagroups <- abind(frvec, amvec, along = 2)


mfares <- mpMFA(adj4MFA, mfagroups)

renameCols <- function(x){
   colnames(x) <- paste("Dimension", 1:ncol(x))
   x
}

RVmat <- mfares$mexPosition.Data$InnerProduct$RVMatrix

#corrplot(RVmat, method = "color", addCoefasPercent = TRUE) 

Eig4scree <- mfares$mexPosition.Data$Table$eigs

#mfascree <- PlotScree(Eig4scree, plotKaiser = TRUE)

fi4pfs <- mfares$mexPosition.Data$Table$fi
rownames(fi4pfs) <- c(1:30)

MFA_FMap <- createFactorMap(
                            fi4pfs,
                            col.points = cols$ex.oc,
                            col.labels = cols$ex.oc,
                            alpha.points = .6,
                            pch = 17,
                            cex = 5, text.cex = 5,
                            display.labels = TRUE,
                            constraints = minmaxHelper4Partial(FactorScores = mfares$mexPosition.Data$Table$fi,
                              partialFactorScores = mfares$mexPosition.Data$Table$partial.fi.array)
                            )
                            
label4Map <- createxyLabels.gen(1,2,
                                lambda = mfares$mexPosition.Data$Table$eigs,
                                tau = mfares$mexPosition.Data$Table$t,
                                axisName = "Dimension ")





fi4pfs <- renameCols(fi4pfs)

pfi4pfs <- mfares$mexPosition.Data$Table$partial.fi.array
pfi4pfs <- renameCols(pfi4pfs)
rownames(pfi4pfs) <- c(1:30)
dimnames(pfi4pfs)[[3]] <- c("FR", "AM")

map4PFS <- createPartialFactorScoresMap(
                                        factorScores = fi4pfs,
                                        partialFactorScores = pfi4pfs,
                                        axis1 = 1, axis2 = 2,
                                        colors4Items = cols$ex.oc,
                                        names4Partial = c("FR", "AM"),
                                        font.labels = 'bold', 
                                        )

partialfsmap <- MFA_FMap$zeMap + 
                  label4Map + 
                    map4PFS$linesColByItems + 
                      map4PFS$pointsColByItems + 
                        map4PFS$labelsColByItems +
                          ggtitle("Contributions to the Excerpts Factor Scores")

adj4MFA.T <- abind(t(adj.cont.FR), t(adj.cont.AM), along = 2)

natvec <- rep(c("FR", "AM"), times = dim(adj4MFA.T)[2]/2)
natvec <- data.frame(natvec[order(natvec, decreasing = T)]) %>% t(.)

colnames(natvec) <- colnames(adj4MFA.T)
rownames(natvec) <- "group"

mfares.t <- mpMFA(adj4MFA.T, natvec)

RVmat.t <- mfares.t$mexPosition.Data$InnerProduct$RVMatrix

#corrplot(RVmat, method = "color", addCoefasPercent = TRUE) 

Eig4scree <- mfares$mexPosition.Data$Table$eigs

#mfascree <- PlotScree(Eig4scree, plotKaiser = TRUE)

MFA_FMap.t <- createFactorMap(
                            mfares.t$mexPosition.Data$Table$fi,
                            col.points = cols$adj.oc,
                            col.labels = cols$adj.oc,
                            alpha.points = .6,
                            pch = 17,
                            cex = 5,
                            display.labels = TRUE,
                            constraints = minmaxHelper4Partial(FactorScores = mfares.t$mexPosition.Data$Table$fi,
                              partialFactorScores = mfares.t$mexPosition.Data$Table$partial.fi.array)
                            )
                            
label4Map.t <- createxyLabels.gen(1,2,
                                lambda = mfares.t$mexPosition.Data$Table$eigs,
                                tau = mfares.t$mexPosition.Data$Table$t,
                                axisName = "Dimension ")




fi4pfs.t <- mfares.t$mexPosition.Data$Table$fi

fi4pfs.t <- renameCols(fi4pfs.t)

pfi4pfs.t <- mfares.t$mexPosition.Data$Table$partial.fi.array

pfi4pfs.t <- renameCols(pfi4pfs.t)

rownames(pfi4pfs.t) <- colnames(adj.contingency)

dimnames(pfi4pfs.t)[[3]] <- c("FR", "AM")

map4PFS.t <- createPartialFactorScoresMap(
                                        factorScores = fi4pfs.t,
                                        partialFactorScores = pfi4pfs.t,
                                        axis1 = 1, axis2 = 2,
                                        colors4Items = cols$adj.oc,
                                        names4Partial = c("FR", "AM"),
                                        font.labels = 'bold', 
                                       # alpha.lines = .75, size.lines = 3
                                        )


partialfsmap.t <- MFA_FMap.t$zeMap + 
                  label4Map.t + 
                    map4PFS.t$linesColByItems + 
                      map4PFS.t$pointsColByItems + 
                        map4PFS.t$labelsColByItems +
                          ggtitle("Contributions to the Adjectives Factor Scores")
```


Another way to visualize the relative contributions of the groups to the factor space is to use an MFA, the results of which are displayed in Figure \@ref(fig:mfasbs). In these plots, we can see the differences in behavior between the groups more clearly. A few examples of excerpts that were rated differently are Excerpts 6, 8, 12, and 17. Words that were used differently include "Disturbing", "Round", "Solemn", and "Bright". It appears that the valence-arousal plane uncovered in the CA is also present here, and this provides a framework for interpreting the differences in behavior between the groups. Excerpt 17 is perhaps the most extreme example. American participants rated this excerpt with much lower arousal and slightly less negative valence than the French participants, so much so that for the American participants, the excerpt landed in the "low arousal/negative valence" quadrant, and for the French participants it landed in the "high arousal/negative valence" quadrant. Another interesting case is for Excerpt 8, which lands in the same quadrant for both groups, but much further from the origin for the French participants than the Americans. The way in which the two groups used the words is also curious. For example, Disturbing seems to be more extreme for the French participants than the Americans. On the other hand, "Solemn" seems to be more a function of arousal in French and valence in English. "Bright" is another example of a word that seems to have the same intent but different extremity between cultures. For American participants, "Bright" seems to carry much more positive valence than for French participants.

```{=latex}
\begin{figure}
     \centering
     \caption{Partial Factor Scores Plots from the MFA}
     \begin{subfigure}[b]{0.49\textwidth}
         \centering
         \includegraphics[width=\textwidth]{./Music-Descriptor-Space_files/figure-latex/mfasbs-1}
         %\caption{$y=x$}
         \label{fig:excerptspfs}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.49\textwidth}
         \centering
         \includegraphics[width=\textwidth]{./Music-Descriptor-Space_files/figure-latex/mfasbs-2}
         %\caption{$y=3sinx$}
         \label{fig:adjectivespfs}
     \end{subfigure}
    \label{fig:mfasbs}
      \caption*{\footnotesize \textit{Note.}  In each plot, the triangles represent the combined factor scores and the small circles represent the partial factor scores contributed by each of the groups.}
\end{figure}

```

```{r mfasbs, fig.height=6, include=FALSE}
print(partialfsmap)
print(partialfsmap.t)
#grid.arrange(as.grob(partialfsmap),
#             as.grob(partialfsmap.t),
#             ncol = 2, nrow = 1,
#             top = textGrob("Partial Factor Scores Plots for French and American Participants")
#             )

mfasbs <- recordPlot()
```



## Experiment 3: Combined Surveys

```{r loadthedataPLSC}
rm(list = ls())

load("catadatamusdim.RData")
load("adj.catadata.list.RData")
load("adjdesign.RData")
load("adjectivecolors.RData")

source('~/GitHub/MusicDescriptorsBackup/barplot_sigonly.R')

dimcontingency <- catadata.list$contingency
adjcontingency <- adj.catadata.list$adjcontingency

dimcontingency <- dimcontingency[-c(6,14),-9]
adjcontingency <- adjcontingency[-c(6,14),]

```

```{r}
library(TExPosition)
library(TInPosition)
library(data4PCCAR)
pls.res <- tepPLS(dimcontingency, adjcontingency, DESIGN = adj.design$thedesign[-c(6,14)])
resPerm4PLSC <- perm4PLSC(dimcontingency, adjcontingency, nIter = 1000)

```

```{r thefirst3eigs}

e1 <- pls.res$TExPosition.Data$eigs[1]
e2 <- pls.res$TExPosition.Data$eigs[2]
e3 <- pls.res$TExPosition.Data$eigs[3]

t1 <- pls.res$TExPosition.Data$t[1]
t2 <- pls.res$TExPosition.Data$t[2]
t3 <- pls.res$TExPosition.Data$t[3]
t4 <- pls.res$TExPosition.Data$t[4]

```

  Experiment 3 used the pseudo-contingency tables from Experiments 1 and 2 together. Since excerpts 6 and 14 were excluded from analysis for Experiment 1, we also removed those rows from the contingency table for Experiment 2. This is so that the dimensions of the two tables for this PLSC would be conformable (remember that we need the same rows or columns in both tables for this analysis). The point of this experiment is to identify the strongest covariance, or the strongest shared signal, between the two tables. Now, this is not to say that these two tables are evaluating the same thing. Instead it allows us to see what is most common between two sets of different information - how often an excerpt was associated with *both* a musical quality and an adjective. The visualizations below allow us to see which variables from each of the two tables correspond with one another; which adjectives are associated with which musical dimensions. Even though both individual tables have their own factor spaces, plotting the common factor space between the two should allow us to see which excerpts are separated from one another using data from both surveys.

### Results

```{=latex}
\begin{wrapfigure}{h}{.5\textwidth}  
  \begin{center}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/screePLSC-1.png}
  \caption{ }(\#fig:screePLSC)  
 \end{center}
\end{wrapfigure}
```
This analysis revealed two dimensions that extracted the majority of the variance (`r round(sum(t1,t2), 2)`%). Of that total extracted by the first two dimensions, the first dimension extracted `r round(t1, 2)`% and the second dimension extracted `r round(t2, 2)`%. The scree plot below shows that it's possible that there are two elbows in this graph, at the 3rd and 5th dimensions. The 3rd and 4th dimensions are also significant, extracting `r round(t3, 2)`% and `r round(t4, 2)`% of the variance, respectively. Interpretations of the third dimension and beyond is beyond the scope of this paper, but seeing that there are multiple significant dimensions beyond the second suggests possible future analyses and interpretations using this method.  

```{r screePLSC,include = FALSE}

PlotScree(ev = pls.res$TExPosition.Data$eigs,
          p.ev = resPerm4PLSC$pEigenvalues,
          title = 'PLSC Music Features: Inertia Scree Plot',
          plotKaiser = TRUE, 
          color4Kaiser = ggplot2::alpha('darkorchid4', .5),
          lwd4Kaiser  = 2
          )
a000.scree4plsc <-  recordPlot()

```

  The plot below shows which variables from each data table load the most on the first and second dimensions. For the purposes of this visualization, we are showing only the variables for which 70% or more of the variance is explained. The nature of the PLSC also suggests that these are the variables that are most associated with one another between the two tables. The strongest signal on the first dimension juxtaposes the slow and legato musical qualities in the positive direction with the fast, staccato, marcato, and conjunct musical qualities in the negative direction. The adjectives associated with the qualities in the positive direction are "Dark", "Dull", "Long", "Melancholy", "Sad", "Slow", "Solemn", and "Weak." The adjectives associated with the negative direction are "Bright", "Colorful", "Dancing", "Fast", "Happy", and "Light".  
  The second dimension identified in the positive direction major harmony and mezzo dynamics, associated with "Light", "Round", "Soft", and "Warm." The negative direction is driven by the impressionist genre being associated with "Aggressive", "Complex", "Dense", "Disturbing", "Powerful", and "Surprising".

```{r loadingsplsc, fig.width = 10,  fig.height = 4, fig.show='hold', message=F}

ps <- pls.res$TExPosition.Data$pdq$p
qs <- pls.res$TExPosition.Data$pdq$q

th <- .7

pslist <- vector(mode = "list", length = 2)
qslist <- vector(mode = "list", length= 2)

names(qslist) <- c("Dim1", "Dim2")
names(pslist) <- c("Dim1", "Dim2")

p.names <- rownames(ps)
q.names <- rownames(qs)

for (i in 1:2){
  pslist[[i]] <- ps[which(abs(ps[,i]) > th*max(abs(ps[,i]))),i]
  qslist[[i]] <- qs[which(abs(qs[,i]) > th*max(abs(qs[,i]))),i]
  names(pslist[[i]]) <- p.names[abs(ps[,i]) > th*max(abs(ps[,i]))]
  names(qslist[[i]]) <- q.names[abs(qs[,i]) > th*max(abs(qs[,i]))]
  }

colors4plsc <- vector(mode = "list", length = 5)
names(colors4plsc) <- c("colors", "p.all","q.all","p.vec", "q.vec" )

colors4plsc$colors <- c(wes_palettes$Darjeeling1[c(1,2,4)],
                        wes_palettes$Darjeeling2[2])

colors4plsc$p.all <- ps
colors4plsc$p.all[colors4plsc$p.all > 0] <- colors4plsc$colors[1]
colors4plsc$p.all[colors4plsc$p.all != colors4plsc$colors[1]] <- colors4plsc$colors[2]

colors4plsc$q.all <- qs
colors4plsc$q.all[colors4plsc$q.all > 0] <- colors4plsc$colors[3]
colors4plsc$q.all[colors4plsc$q.all != colors4plsc$colors[3]] <- colors4plsc$colors[4]

colors4plsc$p.vec <- vector(mode = "list", length = 2)
colors4plsc$q.vec <- vector(mode = "list", length = 2)

names(colors4plsc$p.vec) <- c("Dim1", "Dim2")
names(colors4plsc$q.vec) <- c("Dim1", "Dim2")


for (i in 1:2){
  colors4plsc$p.vec[[i]] <- colors4plsc$p.all[which(abs(ps[,i]) > th*max(abs(ps[,i]))),i]
  colors4plsc$q.vec[[i]] <- colors4plsc$q.all[which(abs(qs[,i]) > th*max(abs(qs[,i]))),i]

}

loading1 <- PrettyBarPlot2(bootratio = c(pslist$Dim1, qslist$Dim1), 
                       threshold = min(c(th*max(abs(ps[,1])), th*max(abs(qs[,1])))), 
                       ylim = c(1.2*min(c(pslist$Dim1, qslist$Dim1)), 1.2*max(c(pslist$Dim1, qslist$Dim1))),
                       color4bar = c(colors4plsc$p.vec$Dim1, colors4plsc$q.vec$Dim1),
                       color4ns = "gray75", 
                       plotnames = TRUE, 
                       main = 'Loadings for variables on the factor plot for LV 1', 
                       ylab = "Signed Loadings"
                       #font.size = 1
                       )
  
loading2 <- PrettyBarPlot2(bootratio = c(pslist$Dim2, qslist$Dim2), 
                       threshold = min(c(th*max(abs(ps[,2])), th*max(abs(qs[,2])))), 
                       ylim = c(1.2*min(c(pslist$Dim2, qslist$Dim2)), 1.2*max(c(pslist$Dim2, qslist$Dim2))),
                       color4bar = c(colors4plsc$p.vec$Dim2, colors4plsc$q.vec$Dim2),
                       color4ns = "gray75", 
                       plotnames = TRUE, 
                       main = 'Loadings for variables on the factor plot for LV 2', 
                       ylab = "Signed Loadings",
                       #font.size = 1
                       )  
  

grid.arrange(as.grob(loading1),
             as.grob(loading2),
             ncol = 2,nrow = 1
             )

loads_plsc <- recordPlot()

```

  Contributions and loadings are similar, but not exactly the same. A variable's contributions to a dimension are the ratio of the squared factor score to the eigenvalue representing that dimension [@Abdi2010f], and loadings are the correlation between a variable and a component, effectively indicating the shared information between the two. For a more complete disambiguation, see [@Abdi2010f]. Figures \@ref(fig:contsplsc) and \@ref(fig:loadingsplsc) show us that there are quite a few more variables that contribute significantly to these dimensions than for which a significant portion of the variance is explained. We do see similar groups, however: on the first dimension, the tempo variables are contributing significantly, along with some from harmony, density, genre, dynamics, motion, range, and articulation. The adjectives contributing significantly are Bright, colorful, Dancing, Fast, Happy, Light, and Valiant in the negative direction, and Dark, Dull, Long, Melancholy, Monotonous, Sad, Slow, Solemn, and Weak in the positive direction. What's notable here is that while some of these variables did contribute significantly in the plots above (see Figure \@ref(fig:factormapsA) and Figure \@ref(fig:factormapsQ)), some didn't contribute much at all and fell near the barycenter of the factor plot. We also see that this juxtaposes some negatively and positively valenced adjectives, which allows us to identify which of the musical qualities contributes to the valence dimension. 
  The second dimension tells us a similar story. Here we see more of the harmony variables, along with one tempo variable, some density, genre, a few dynamics, contour, motion, range, and articulation. The adjectives contributing negatively are Aggressive, Complex, Dense, Disturbing, Incisive, Mysterious, Powerful, Surprising, and Varied, and those contributing positively are Light, Round, Soft, Transparent, and Warm. Again we see similar effects of variables that may not have contributed significantly to their respective plots above, but are contributing significantly here. Also, this second latent variable seems to be defining the arousal dimension.  
```{r contsplsc, fig.width = 10, fig.show='hold', message=F}

ctri <- pls.res$TExPosition.Data$ci*sign(pls.res$TExPosition.Data$fi)
ctrj <- pls.res$TExPosition.Data$cj * sign(pls.res$TExPosition.Data$fj)

conts.sigonly <- barplot.sigonly(x = ctri,
                                 y = ctrj,
                                 th = "mean",
                                 type = "cont")


contribution1 <- PrettyBarPlot2(bootratio = conts.sigonly$data$Dim1, 
                       threshold = conts.sigonly$t.hold$thr.tog, 
                       ylim = conts.sigonly$data$y.limits$ylims.tog$Dim1,
                       color4bar = c(conts.sigonly$color$x.vec$Dim1, conts.sigonly$color$y.vec$Dim1),
                       color4ns = "gray75", 
                       plotnames = TRUE, 
                       main = 'Contributions to the First LV', 
                       ylab = "Signed Contributions"
                       #font.size = 1
                       )
  
contribution2 <- PrettyBarPlot2(bootratio = conts.sigonly$data$Dim2, 
                       threshold = conts.sigonly$t.hold$thr.tog, 
                       ylim =conts.sigonly$data$y.limits$ylims.tog$Dim2,
                       color4bar = c(conts.sigonly$color$x.vec$Dim2, conts.sigonly$color$y.vec$Dim2),
                       color4ns = "gray75", 
                       plotnames = TRUE, 
                       main = 'Contributions to the Second LV', 
                       ylab = "Signed Contributions",
                       #font.size = 1
                       )  

grid.arrange(as.grob(contribution1),
             as.grob(contribution2),
             ncol = 1,nrow = 2
             )

contributionsplsc <- recordPlot()
```
  
### Discussion
The factor score plots for this analysis shows that the first two sets of latent variables extracted by the analysis effectively separate the groups of excerpts into the clusters defined in the HCA for the adjectives survey. This factor plot shows us how the strongest correlated signal between the two data tables separates Excerpts groups 2 and 3, but groups 1 and 2 didn't contribute much to this dimension, instead contributing to the 2nd latent variables. The second latent variable separates Groups 1 and 4, with Groups 2 and 3 more barycentric. This suggests that, generally speaking, the excerpts that were clustered in groups 2 and 3 are those that could be defined by positive and negative valence, respectively, and those in groups 1 and 4 would be defined more by high and low arousal. That being said, these excerpts are not defined exclusively along these dimensions, but rather more by one than the other. For example, Excerpt 26 is characterized by being one of the most extreme examples of positive valence, but doesn't score as highly on the arousal dimension, similarly with Excerpt 27 with negative valence. This is contrasted with Excerpt 7, which is one of the most negatively valenced stimuli, but also scores very high on arousal, although the barycenter for that group is near the origin of that plot.

```{r factorplotsPLSC, fig.width = 12, fig.height = 6}
latvar.1 <- cbind(pls.res$TExPosition.Data$lx[,1],pls.res$TExPosition.Data$ly[,1])
colnames(latvar.1) <- c("Lx 1", "Ly 1")

zedesign <- adj.design$thedesign[-c(6,14)]
lescoleurs <- adj.design$ex.cols[-c(6,14)]
coleur4group <- adj.design$col4exgrp

rownames(latvar.1) <- c(1:5,7:13,15:30)


# compute means
lv.1.group <- getMeans(latvar.1, zedesign)

# get bootstrap intervals of groups
lv.1.group.boot <- Boot4Mean(latvar.1, zedesign)
colnames(lv.1.group.boot$BootCube) <- c("Lx 1", "Ly 1")

#Next, we can start plotting:

plot.lv1 <- createFactorMap(latvar.1,
                         col.points = lescoleurs,
                         col.labels = lescoleurs,
                         alpha.points = 0.8, alpha.labels = 0.8,
                         text.cex = 5, title = "Latent Variable Plot 1"
                         )

plot1.mean <- createFactorMap(lv.1.group,
                              col.points = coleur4group,
                              col.labels = coleur4group,
                              cex = 4,
                              pch = 17,
                              alpha.labels = 0.5,
                              text.cex = 6)

plot1.meanCI <- MakeCIEllipses(lv.1.group.boot$BootCube[,c(1:2),], # get the first two components
                              col = adj.design$col4exgrp,
                              names.of.factors = c("Lx 1", "Ly 1"), alpha.ellipse = .2,
                              alpha.line = 0, line.size = 0
                              )

plot1 <- plot.lv1$zeMap_background + plot.lv1$zeMap_dots + plot.lv1$zeMap_text +
           plot1.mean$zeMap_text + plot1.meanCI


latvar.2 <- cbind(pls.res$TExPosition.Data$lx[,2],pls.res$TExPosition.Data$ly[,2])
colnames(latvar.2) <- c("Lx 2", "Ly 2")

rownames(latvar.2) <- c(1:5,7:13,15:30)

# compute means
lv.2.group <- getMeans(latvar.2, zedesign)

# get bootstrap intervals of groups
lv.2.group.boot <- Boot4Mean(latvar.2, zedesign)
colnames(lv.2.group.boot$BootCube) <- c("Lx 2", "Ly 2")

#Next, we can start plotting:

plot.lv2 <- createFactorMap(latvar.2,
                         col.points = lescoleurs,
                         col.labels = lescoleurs,
                         alpha.points = 0.8, alpha.labels = 0.8,
                         text.cex = 5, title = "Latent Variable Plot 2"
                         )

plot2.mean <- createFactorMap(lv.2.group,
                              col.points = coleur4group,
                              col.labels = coleur4group,
                              cex = 4,
                              pch = 17,
                              alpha.labels = 0.5,
                              text.cex = 6)

plot2.meanCI <- MakeCIEllipses(lv.2.group.boot$BootCube[,c(1:2),], # get the first two components
                              col = coleur4group,
                              names.of.factors = c("Lx 2", "Ly 2"), alpha.ellipse = .2,
                              alpha.line = 0, line.size = 0
                              )

plot2 <- plot.lv2$zeMap_background + plot.lv2$zeMap_dots + plot.lv2$zeMap_text +
           plot2.mean$zeMap_text + plot2.meanCI


grid.arrange(as.grob(plot1),
             as.grob(plot2),
             ncol = 2,nrow = 1
             )
plsc.fplot <- recordPlot()
```


# General Discussion

  Although this study was designed to evaluate the sensory or cognitive response to music, and not specifically the emotional response, there is significant overlap in the results observed here and the results of the work investigating music and emotion. The appearance of the valence-arousal plane in the results of Experiment 2 was not unexpected, even though the adjectives we selected were not intended to be explicitly emotional. This goes to show difficult it is to avoid any emotional content when selecting descriptors, and from another perspective, how much emotional contagion the musical examples carry. Overall, this supports the idea that the first two dimensions on which music is judged holistically are valence and arousal. 
  Some of the results discussed in Experiment 1 require more explanation. In that experiment, there was an issue of having two individual excerpts dominate the factor space, numbers 6 and 14, which did not happen in Experiment 2. One of the differences between CA and PCA is that PCA is distorted by raw values, so bigger numbers have more influence on the overall factor space, but CA finds the average observation. Information that is common, therefore, falls towards the center of the plot, while information that is further from the average, in other words, more rare, ends up further from the center of the factor plots [@Abdi2010d]. Therefore, if a survey like the one used in Experiment 1 includes a item that is wildly different than the others in the set, the ratings will be very different, and that item will dominate the factor space. In this case we have two such examples: excerpts 6 and 14. Excerpt 6 was written as a Steve-Reich-esque minimalist, ostinato based excerpt, and excerpt 14 was written to be jazzy. The reason this effect occurs with the first survey and not the second is that the musical qualities on which the excerpts were rated were explicit and designed to separate the excerpts along the various musical dimensions, while the adjectives survey was designed to evaluate the excerpts more generally on holistic qualities. Excerpt 6 still appears as a minor outlier in the visualizations for the second survey, but does not dominate the space the way it does in the results of the first.
  What we did to mitigate that is to use those two excerpts as *supplementary projections*, sometimes also referred to as *out of sample observations*. This allows us to evaluate what information is shared by those outliers with the other elements in the dataset without having them dominate the visualization of the factor space. If, when we projected those values into the factor space, they projected onto the origin or very close to it, we would know that those observations shared no information with the other variables. The fact that they are where they are offers support to the idea that the first survey separates the excerpts approximately by genre. Because the 'genre' information isn't shared with the other observations, they are being projected onto the space sharing only the information that does not deal with genre, like tempo or range. What this tells us is that musical qualities surveys captured a result that may have characterized by 4-6 factors, each approximating genre and the qualities associated with that genre and the general affective space captured an entirely different set of information about the stimuli and the perception of the stimuli.  
  The hierarchical cluster analyses revealed different groupings in how the stimuli were rated between the two surveys. The PLSC then showed that when including both sets of data, there was a coherent interpretable factor space on which the excerpts were plotted. Another way to look at the results of the two surveys together would be to run a MFA, similar to the one above that plotted the difference between French and American raters on the adjective survey. This would allow us to calculate a common factor space for the two surveys without separating the first and second dimensions of each. We should note that the results of an MFA would provide us with a picture of the data that is fundamentally different from that provided by the PLSC, as it would be a true 'common factor space' instead of a space defined by the covariance. The important question here is simply which question is more important. In the case of these experiments, the PLSC more effectively answered our question about what musical information is commonly associated between the technical and affective qualities.   
  An important overall takeaway from this is that with a deep understanding of the stimuli, we may be able to predict the approximate dimensionality of the solution factor space. In the first survey, the solution was that the first two dimensions separated the stimuli along genre or stylistic lines. Because we used only one stimulus from the minimalist and jazz genres, we had a factor space that was distorted by outliers. To have a solution in which we don't see these specific excerpts as outliers, but as coherent members of a factor space, we would need more examples of those styles. This suggests that when creating surveys or designing stimuli, we should keep in mind that we need multiple items per group, or presumed dimension. This is not to say that we will always be able to a priori predict the factor space of the solution. For example, Experiment 2 may also have benefitted from more minimalist or jazz examples. In a system in which the overall structure is obtained by evaluating the stimuli holistically, having a single outlier will necessarily distort the space, either because it is an outlier in sensory terms or because it is the only stimulus against which there is no direct reference. This in a way embodies the issue described in the introduction, in which a single dimension is noisy. The noise, specifically in Experiment 2, comes from the fact that those participants were likely to be less familiar with mimalism and/or jazz than the trained musicians who took the QS, but the reason the results are overall robust to that noise is that the participants were not asked to rate the excerpts on any explicit dimensions or qualities. 

## Limitations & future directions

 Although we evaluate the scores and ratings of participants from different countries, we recognize that the issue of multiculturality is not addressed to a significant degree in this study. The sample was still largely students, and France and the United States are both western countries that share western musical culture. To truly address this question, it would be very interesting to include participants from multiple, contrasting musical cultures, with languages that are more distinct than English and French. This presents new problems, however, as the specific musical qualities included in the surveys may not all apply to or translate well to other musical cultures. One specific example is harmony. The idea of the scale as the basis for both melodic and harmonic material may not be the same across all musical cultures in which scales exist. For example, in western music, the scale represents the notes that are used in a composition to form both melodies and chords, which are the harmonic material, but also specifically infer an order [@Cohn2001]. In carn$\bar{a}$tic music, the notes that make up the ragas are not used to create chords, and do not imply a specific order [@Raman2017]. Therefore asking participants to identify the harmonic material may not make sense in all situations, and a better question would be to ask what kind of scale or scales are used in a given excerpt.
  Another question that fell beyond the scope of this study is the concept of semantic drift between languages. Although illustrated in Figure \@ref(fig:mfasbs), the source of the differences between French and American participants is not entirely clear. We humbly hazard to guess that some of the sources of the difference include aspects of perception that extend beyond the musical. These could be linguistic sources, such as the physical characteristics of the words themselves [@Reilly2012], the cultural associations with the words, or the frequency of use in either language [@Thompson2020]. Diving more into those questions of linguistics and semantic drift between languages would be a fascinating future study.
 Another interesting study would be to repeat this study using adjectives from specific domains or that that avoid explicit emotional or musical content, to see how music maps onto different sensory spaces. For example, 'moist', 'slimy', 'dry', 'puckered', 'smooth'. Although some of these adjectives may carry musical weight, in the context of other words that all relate to haptic sensation, it may provide some interesting feedback regarding how the music maps into other sensory domains.
 Finally, using these studies may provide pilot work for the way in which people without language react to music, nonverbal autistic people, for example. Whereas this study explicitly uses language as an interlocutor for music perception, it offers insight into ways to better communicate with people who do not have that ability.  

# Conclusions
  Expanding the collection and analytical paradigms, and thus expanding scientific scope and perspective, has the added benefit of increasing reach. By expanding the ways in which we collect data, we are able to more readily and consistently reach participants who might normally be excluded from everday research paradigms, specifically racially and ethnically diverse populations, poorer populations, those with limited access to transportation, or who have a disability, or are immunocompromised.   Developing investigative paradigms that are accessible on mobile platforms and that reduce participant demand while maintaining rigor and integrity will similarly enable us to reach a much greater subset of the population. If we are able to pair this kind of data gathering with appropriate analysis, we can maintain the standards of scientific integrity that we as a community expect from traditional hypothesis testing. The literature to date in the music cognition domain has focused on a fairly small subset of the multivariate analyses available to investigate these questions. As presented here, the number of ways that exist to analyze the data from a single set of experiments is considerable, and the results of each analysis illuminate different parts of the story the data are telling. Not every form of analysis is appropriate in every context, but understanding how, and perhaps more importantly when, to apply a technique or type of analysis is an important to uncovering new perspectives or insights.

  
```{r saveGraphs, message = FALSE, warning = FALSE, error = FALSE}
powerpointFilename <- 'Music-Descriptor-Space.pptx'
path2pptx    <- './Analysis/'
name4Graphs  <- paste0(path2pptx,powerpointFilename)
title4Graphs <- 'Music Descriptor Space '



pptx4musdim <- PTCA4CATA::saveGraph2pptx(file2Save.pptx = name4Graphs, 
                 title = title4Graphs, 
                 addGraphNames = TRUE)
```

\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
