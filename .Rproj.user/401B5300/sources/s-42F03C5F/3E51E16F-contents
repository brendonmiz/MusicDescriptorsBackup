---
title             : "Cognitive Music Listening Space: A Multivariate Approach"
shorttitle        : "Music Descriptor Space"

author: 
  - name          : "Brendon Mizener"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "800 W. Campbell Rd., Richardson Tex"
    email         : "bmizener@utdallas.edu"
    role:         # Contributorship roles (e.g., CRediT, https://casrai.org/credit/)
      - Stimuli creation
      - Survey design & creation
      - Data collection & processing
      - Statistical analyses
      - Writing - Original draft preparation
  - name          : "Mathilde Vandenberghe"
    affiliation   : "2"
    role:
      - Original concept
      - Survey design & creation
  - name          : "Hervé Abdi"
    affiliation   : "1"
    role:
      - Writing - Review & Editing
      - Statistical guidance
  - name          : "Sylvie Chollet"
    affiliation   : "2"
    role:
      - Original concept

affiliation:
  - id            : "1"
    institution   : "University of Texas at Dallas"
  - id            : "2"
    institution   : "Junia, Univ. Artois, Université de Liège, Univ. Littoral Côte d’Opale, UMRT 1158 BioEcoAgro, F-62000 Arras, France"

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  French and American participants listened to new music stimuli and evaluated the stimuli using either adjectives or quantitative musical dimensions. Results were analyzed using Correspondence Analysis (CA), Hierarchical Cluster Analysis (HCA), Multiple Factor Analysis (MFA), and Partial Least Squares Correlation (PLSC). All except the HCA used Bootstrapping and Permutation testing for inferences. French and American listeners differed when they described the musical stimuli using adjectives, but not when using the quantitative dimensions. The present work serves as a case study in research methodology that allows for a balance between relaxing experimental control and maintaining statistical rigor.
  
keywords          : "Music, Perception, Cognition, Multivariate Analyses"
wordcount         : "5631"

bibliography      : ["Music Descriptor Space.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no

documentclass     : "apa6"
csl               : "apa7.csl"
classoption       : "man"
output            : 
  papaja::apa6_pdf: 
    latex_engine    : "xelatex"
header-includes   :
          - \usepackage{caption}
          - \usepackage{subcaption}
          - \usepackage{wrapfig}

---

```{r setup, include = FALSE}
dev.off()
rm(list = ls())
gc()

# Seed for random number generation
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message=FALSE, fig.align = "center",cache.extra = knitr::rand_seed)
set.seed(42)

papaja::r_refs("r-references.bib")
```

```{r analysis-preferences}
library("papaja")
suppressMessages(library(ExPosition))
suppressMessages(library(InPosition))
suppressMessages(library(MExPosition))
library(PTCA4CATA)
library(purrr)
library(plyr)
library(tidyverse)
library(readxl)
library(stringr)
library(stringi)
library(rlist)
library(wesanderson)
#library(kableExtra)
library(ggplotify)
library(gridExtra)
library(grid)
library(abind)

```

```{R graphPath}
powerpointFilename <- 'Music-Descriptor-Space.pptx'
path2pptx    <- './Analysis/'
name4Graphs  <- paste0(path2pptx,powerpointFilename)
title4Graphs <- 'Music Descriptor Space '
```


```{r citations, eval = FALSE, echo=FALSE, include=FALSE}




```

  We have a data collection problem: World events over the last year have shown that we need to be able to collect good data outside of the lab. In the lab, because we control error sources, we measure, on relatively small sets of observations, a few well-defined, quantitative variables, analyzed using standard techniques such as analysis of variance (ANOVA). But, with the labs closed (remember COVID?), how can we collect good data? Away from the controlled environment of the lab, quantitative variables are hard to measure, but we can collect, on large sets of observations, qualitative variables that can only be analyzed by newer multivariate techniques. In the present paper, we present a case study illustrating this tradeoff.  

  "Doesn’t beer taste better in a bar? Or when you’re listening to your favorite song?" The present study was designed to quantify a music listening ‘space’ that captures objective stimulus and cognitive dimensions for the sake of investigating cross-modal sensory mapping between beer drinking and music listening. It also addresses other questions: Are there differences in how people from different countries --- and by extension musical cultures --- perceive and describe music? What parallels exist between stimulus dimensions and cognitive dimensions of music?

  For the present study, we have defined stimulus dimensions as quantitative musical qualities, such as tempo, range, and meter and cognitive dimensions as qualitative descriptions of music, such as "dark", "warm", and "round". These cognitive/qualitative dimensions are similar to the commonly investigated affective or emotional dimensions, but do not specifically assess affective quality. We designed three experiments to quantify individual and combined spaces for these concepts, using separate surveys. The first experiment included highly trained musicians and featured a multiple choice survey about the stimulus dimensions; the second included participants with any level of music training performing a check-all-that-apply task (CATA, Katz & Braly, 1933; Meyners & Castura, 2014; Coombs et al., 1956); the third experiment incorporated both surveys in a single analysis.  
  
  To analyze our data, we selected a set of multivariate analyses that allowed us to visualize answers to each of our questions. The mental spaces revealed by the individual surveys were calculated and visualized using Correspondence Analysis (CA), a method similar to Principal Components Analysis (PCA) that analyzes qualitative data. We used Multidimensional Scaling (MDS), a distance analysis, to visualize the differences between participants and participant groups. To find parallels between the surveys, we used Partial Least Squares Correlation (PLSC), a method that analyzes two data tables with different sets of variables measured on the same observations. We used a Multiple Factor Analysis to evaluate how French and American participants' responses differed. Each of these analyses provide different visualizations and interpretations of the data, which are discussed in more detail below.
 
## Music Perception

  Quantifying music perception is an interesting test case for this kind of data gathering and analytical paradigm. Most music or auditory perception studies have the inherent confound that small changes can affect listeners' perception, especially when the study involves timing, tuning, or sound localization. However, the experimental controls may be loosened slightly when investigating holistic music listening, because no single musical element is more important than the whole.  
  
  Quantitative and qualitative elements of music are theoretically distinct but practically inseparable [@BrunerII1990]. Listeners respond affectively to technical aspects of music using schemata informed by their individual musical experiences and personality traits [@Kopacz2005], and composers use various musical and compositional techniques to convey the emotions they want to express [@BrunerII1990; @Battcock2019]. However, quantifying the perceptual interactions between more than one or two musical qualities is a challenge. One reason is that models like ANOVA and its variations are limited by how many variables a researcher can include while remaining coherent. Another is that asking participants to respond to multiple aspects of a stimulus taxes participants' perceptual capacity and is thus difficult to measure [@Thompson1994].  
  
  One specific area that has attempted to capture a greater dimensionality is music emotion research. This is a well trod domain --- see, for example @Juslin2010 --- and the application of multivariate analyses to these questions is similarly well established. Early studies, including @Gray1967, @Wedin1969, and @Wedin1972 used MDS to capture the affective space of various musical stimuli. MDS continues to be used commonly in more modern studies [@Madsen1997; @Bigand2005; @Roda2014], with a narrow focus on valence and arousal, which were first proposed to be the most salient dimensions of perception by @Osgood1955. 
  
  A few studies have specifically investigated dimensions beyond those first two (for example Rodà et al., 2014), and there are conflicting hypotheses about whether the valence-arousal plane a different model of emotion perception represents the fundamental space around music emotion perception [@Juslin2008a; @Cowen2020]. However, an important distinction between the present study and work in music emotion perception is that the adjectives we chose were informed by music composition and performance, rather than emotion [@Wallmark2019]. 
  
  With regard to trained and untrained musicians, there are many studies that evaluate their differences, but the verdict as to whether trained musicians are better music listeners is still out, partially due to the fact that there is little standardization in how much training is required for a participant to be "highly trained" [@Bigand2006]. There are, however, reported benefits with regard to sensitivity to the emotional content in music [@Ladinig2012] and familiarity with tonal systems [@Dowling1978a; @Bartlett1980a]. Recent works suggest that these benefits may be limited to specific technical aspects, and depend on the extent of training (Raman & Dowling 2017). We included highly trained musicians because they are sensitive to these technical aspects of music and will be able to accurately quantify the stimuli. Additionally, some of the response options to questions on the survey for Experiment 1 would only be familiar to participants with significant music training.   
  
  
### Intercultural music perception

  There are a few common goals in intercultural studies of music perception. Some quantify the shared emotional experience between musical cultures [@Fritz2009; @Balkwill1999; @Cowen2020; @Gregory1996; @Darrow1987; @Balkwill2004], and some ask participants to identify technical aspects of music from other cultures [@Raman2016; @Raman2017]. There are fewer studies that include semantics in their evaluation of music perception [@Zacharakis2014; @Zacharakis2015], which makes this a prime area for research.  
  
  The research program presented in @Zacharakis2014 and @Zacharakis2015 deals specifically with timbre perception, and their use of adjectives is similar to the way they adjectives are used in the present study. In Zacharakis et al. (2014, 2015), Greek and English participants described timbre with adjectives from their native languages. These studies found that while there are some differences, overall, participants' descriptions of timbre do not differ much between languages [@Zacharakis2014; @Zacharakis2015]. 

## Present questions & methods of analysis

  The primary question addressed in this study is: Can we quantify a cognitive space around music listening defined by both stimulus and cognitive dimensions of music. Secondary questions include whether French and American participants describe music differently, and whether those differences may arise from cultural differences or are purely semantic. To answer these questions, we employed a set of multivariate analyses that each offered a different perspective on the results of each experiment. We felt it may be useful to provide a quick overview of the data collection and analytical techniques for readers who may be unfamiliar.  

### Check-all-that-apply (CATA)

  The CATA technique --- a method widely used in sensory evaluation --- measures how participants describe a set of stimuli [@Katz1933; @Meyners2014; @Coombs1956; @Valentin2012]. In a CATA task, stimuli are presented one at a time, and for each stimulus, participants are shown a list of descriptors and are asked to select the descriptors that describe the presented stimulus [@Meyners2014]. CATA easily assesses questions with multiple 'correct' responses [@Coombs1956], and places little cognitive demand on participants because they do not have to generate responses [@Ares2010].  
  CATA data are analyzed by 1) computing a pseudo contingency table that records the number of times descriptors were associated with stimuli and 2) analyzing this data table with Corresponence Analysis (CA) in order to visualize the patters of association between a) stimuli, b) descriptors, and c) stimuli and descriptors.  
  
### Correspondence Analysis

  The primary analysis used on the data collected in the surveys is Correspondence Analysis (CA) [@Escofier-Cordier1965; @Benzecri1973; @Greenacre1984]. CA analyzes a contingency table, or any data structured similarly, and calculates the relationships between rows (observations) and columns (variables); in our case, musical excerpts and descriptors. The nature of the CA allows for observations and variables to be visualized in the same space. 
  
### Hierarchical Cluster Analysis
  
  Hierarchical Cluster Analysis (HCA) [@Pielou1984] is a way of identifying groups, or clusters, of observations from the rows of a distance matrix, that displayed using trees to visualize that distance. This technique was used in the present study to determine whether there were any clusters of excerpts or adjectives that arose during participant ratings. These clusters were used as design or grouping variables and to select colors for visualizations.   
  
### Multidimensional Scaling

  Multidimensional Scaling (MDS) [@Borg2005] --- a technique commonly used in music perception studies [@Wedin1969; @Wedin1972; @Roda2014; @Madsen1997; @Bigand2005] analyzes a distance matrix computed between observations and visualizes them, positioning these observations on a map such that the distance between observations on the map best approximates their distance in the data table.    

### Multiple Factor Analysis

  Multiple Factor Analysis (MFA) [@Abdi2013] is an extension of PCA that analyzes and visualizes multiple tables or sets of variables that each describe the same observations. MFA visualizations, called are focused on the relationships between observations, and, for each observation, the relationships between the tables that contributed to that observation. These visualizations represent *partial factor score plots*, such that "partial" refers to each table's contributions to the overall factor scores. Practically speaking, the most basic difference between MFA and PLSC is that PLSC extracts commonalities between two data tables, whereas MFA extracts similarities and differences between two or more data tables.    
  
### Partial Least Squares Correlation

  Partial Least Squares Correlation (PLSC) [@Tucker1958; @Abdi2013a] analyzes two data tables that describe a single set of observations (rows) with different sets of variables (columns). PLSC computes a matrix of correlations between the sets of variables which is then analyzed to find latent variables with the largest covariance, i.e., the greatest amount of information common to the two data tables. This technique is commonly used in neuroimaging studies to evaluate correlations between matrices of imaging data and of behavioral or task data [@Krishnan2011].   

### Inference Methods

  Because the methods outlined above are not inferential methods, and do not inherently allow for hypothesis testing, we use permutation testing [@Berry2011] and bootstrapping [@Hesterberg2011]. Permutation testing evaluates whether our data have a signal that is more salient than a random table and bootstrapping evaluates the stability of the result of an experiment with confidence intervals computed from resampling the original observations [@Berry2011; @Hesterberg2011].

# Experiment 1: Musical Qualities Survey

## Methods

### Participants

For the first experiment, we recruited highly trained musicians with a minimum of 10 years of formal music training to evaluate the stimulus dimensions or musical qualities of the stimuli, and to ascertain whether the stimuli truly reflected the composer's intent of varying on a wide range of musical dimensions [@Raman2017]. Participants in the United States and in France were recruited by word of mouth and social media. There were a total of 84 responses to the survey, of which 57 were removed for not completing the survey, leaving a total of 27 (N$\mathrm{_{France}}$ = 9, N$\mathrm{_{USA}}$ = 18) for the analysis.  All recruitment measures were approved by the UT Dallas IRB.

### Stimuli
  
  All stimuli were new, original excerpts, in various Western styles, composed using Finale composition software (Finale v25, MakeMusic, Inc.) by the first author specifically for this study (scores and audio files available upon request). Each stimulus was a wav file generated using the Finale human playback engine, approximately 30 s in length (range: 27 - 40 s, *M* = 32.4 s). The stimuli were all string quartets, in order to control for effects of timbre and otherwise vary on a number of musical qualities, specifically Harmony, Tempo, Meter, Density, and Genre. The stimuli are numbered by the order in which they were composed and thus do not reflect any specific grouping.
  
### Survey

  American and French participants received links to surveys presented in English and French, respectively, both presented via Qualtrics. Participants were instructed to listen to the listen to the excerpts presented in the survey using headphones or in a quiet listening environment, but that was not controlled, nor was it assessed as part of the survey. After standard informed consent procedures, participants listened to 15 of the 30 excerpts, presented one at time in a random order, and answered ten questions per excerpt, one for each of the musical qualities being assessed. The musical qualities assessed and the levels associated with each are indicated in Table \@ref(tab:qualitiestable). Of these dimensions being assessed, all were multiple choice, allowing for a single response, except for meter, contour, and articulation, which were check-all-that-apply. See supplementary materials for the French translations of this table. After completion of the experimental task, participants were asked to provide demographic data, including including age, gender identity, nationality, occupation, and musical experience.
  
```{=latex}

\begin{lltable}
\begin{scriptsize}
\begin{longtable}{p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}}\noalign{\getlongtablewidth\global\LTcapwidth=\longtablewidth}
\caption{\label{tab:qualitiestable}Musical Qualities and the provided survey response options.}\\
\toprule[.8pt]
 \multicolumn{1}{c}{Harmonic Material} & \multicolumn{1}{c}{Tempo} & \multicolumn{1}{c}{Meter} & \multicolumn{1}{c}{Density} & \multicolumn{1}{c}{Genre} & \multicolumn{1}{c}{Articulation}\\
 \midrule
      Diatonic: Major & Very slow & Simple Duple & Very sparse & Baroque & Staccato \\
      Diatonic: Minor & Slow & Simple Triple & Moderately sparse & Classical & Marcato \\
      Blues & Moderately Slow & Simple Quadruple  & More sparse than dense & Romantic & Legato\\
      Chromatic & Moderate & Compound Duple & More dense than sparse & Impressionist & Tenuto\\
      Whole tone & Moderately Fast & Compound Triple & Moderately Dense & Modern & Other \\       
      Modal  & Fast & Compound Quadruple & Very Dense & Jazz/Blues & \\
      Quintal/Quartal  & Very Fast & Complex & & Contemporary & \\
      Ambiguous  & & & & Other & \\
      Other  & & & & & \\
\bottomrule\addlinespace[.5em]
 & \multicolumn{1}{c}{Contour} & \multicolumn{1}{c}{Motion} & \multicolumn{1}{c}{Range} & \multicolumn{1}{c}{Dynamics} & \\
 \cmidrule[.5pt]{2-5}
  & Ascending & Conjunct & Narrow & Soft & \\
  & Descending & Disjunct & Moderate & Moderate  & \\
  & Arch & \multirow{2}{0.2\textwidth}{Combination of conjunct and disjunct} & Wide & Loud  & \\
  & Undulating &  & Very Wide & Varied: gradual crescendo &\\
  & Pendulum & \multirow{2}{0.2\textwidth}{I do not think this excerpt has a melody} & \multirow{2}{0.2\textwidth}{I do not think this excerpt has a melody} & \multirow{2}{0.2\textwidth}{Varied: gradual decrescendo} &\\
  & Terrace & & & & \\
  & \multirow{2}{0.2\textwidth}{I do not think this excerpt has a melody} & Other & & \multirow{2}{0.2\textwidth}{Some of each, soft and loud}  &\\
  & & & & & \\
  & Other & & & Other & \\
  
\cmidrule[.75pt]{2-5}
\end{longtable}
\end{scriptsize}
\end{lltable}
```


### Data Processing

  To process the data, survey responses were converted into a "brick" of data. With the excerpts on the rows, the qualities on the columns, and the participants on the pages. For the current experiment, one quality is one variable, and we refer to the response options as levels of that variable. On any page, at the intersection of any row and column was a one or a zero, with a one indicating that this participant had selected this level of this quality (column) to describe this excerpt (row). The responses in the French "brick" were all translated into English, and then the brick was summed across pages to obtain a pseudo-contingency table^[Whereas, in a contingency table, there is a single one (1) in each row, indicating that each observation (row) is associated with a single variable (column), in a pseudo-contingency table, there are as many ones as variables the participant decided were associated with that observation.] in which the intersection of a row and a column was the total number participants who selected a level of a musical quality to describe an excerpt. Levels for which the column sum was equal to one were considered as outliers and removed from the data.
  
  After removing these columns, preliminary visualizations revealed a few variables that required recoding because they were having an outsized effect on the analysis. For the "Meter", variable, there were initially seven levels: "Simple Duple", "Simple Triple", "Simple Quadruple", "Compound Duple", "Compound Triple", "Compound Quadruple", and "Complex", but some participants misunderstood this question and selected multiple options for each level of "Duple", "Triple" or "Quadruple". These responses were recoded, removing "Simple", "Compound" and "Complex", (there were no excerpts with complex meter), and collapsed, so that each excerpt had only one meter response per participant, "Duple", "Triple", or "Quadruple".  
  
  There were multiple qualities for which a possible response was "I do not think this excerpt has a melody", and this pattern created a problem in which multiple columns represented the same response, which had a similar effect to the one caused by the "Meter" variable before it was recoded. To avoid this problem, these responses were also recoded. A new variable, "Melody", was created, with two levels/columns, yes and no, and if participants responded "I do not think this excerpt has a melody" to any of the Contour, Motion, or Range variables, a one was counted in the "No" column for that participant and that excerpt. The other levels for each of these three variables were then recoded so that each other column for that variable in that row had the value of one divided by the number of options for that variable --- a procedure called barycentric recoding. If the participant responded with "I do not think this excerpt has a melody" for some but not all three of those variables, a one was still counted in the "no melody" column, but only the variables for which "I do not think..." was selected were recoded using barycentric recoding. For all excerpts and participants for which "I do not think..." was never selected, a one was added to the "Yes" column for the melody variable. Once the data were recoded, the brick was once again summed across pages to obtain the data table that would be used for subsequent analyses. 

### Analysis
  
  After data processing, the data were in two usable forms, a brick and a contingency table. To analyze the similarity structure between participants, we computed a co-occurrence matrix from the brick with participants on the rows and columns, such that the intersection of a row and column represented the number of similar choices between participants. This was then analyzed using MDS.  
  
  To analyze the excerpts and musical qualities and obtain the music quality space, we performed a CA on the contingency table. To identify potential clusters among the excerpts, we ran an HCA on the row factor scores obtained from the CA.
  
```{r importQualdata}

load("catadatamusdim.RData")
musdimdata <- catadata.list$contingency#[,order(colnames(catadata.list$contingency))]
numberofdims <- catadata.list$numberofdims#[order(names(catadata.list$numberofdims))]
thebrick <- catadata.list$thebrick#[,order(colnames(catadata.list$contingency)),]

rows2drop <- c(6,14) 

musdimdata.no6 <- musdimdata[-rows2drop,]
thebrick.no6 <- thebrick[-rows2drop,,]

```

```{r Q.parts}

# reorder some of the columns in the french experts dataset, 
# taking only the ones we want to analyse for now
fr.ex.data <- catadata.list$french.expert.data[c(1:3,6,7,9:12),c(1,4,5,6,7)]
colnames(fr.ex.data) <- c("age", "gen", "nat", "tr_yrs", "tr_type")
fr.ex.data$gen[which(fr.ex.data$gen == "Homme")] <- "M"
fr.ex.data$gen[which(fr.ex.data$gen == "Femme")] <- "F"
fr.ex.data$nat <- "France"
fr.ex.data$tr_type[which(fr.ex.data$tr_type == "Instrumentale")] <- "Inst"
fr.ex.data$tr_type[which(fr.ex.data$tr_type == "Vocale")] <- "Voc"

am.ex.data <- catadata.list$expert.data[,c(1:3,6,7)]
colnames(am.ex.data) <- colnames(fr.ex.data)
am.ex.data$nat <- "USA"
am.ex.data$gen[which(am.ex.data$gen == "Male")] <- "M"
am.ex.data$gen[which(am.ex.data$gen == "Female")] <- "F"
am.ex.data$tr_type[which(am.ex.data$tr_type == "Instrumental")] <- "Inst"
am.ex.data$tr_type[which(am.ex.data$tr_type == "Vocal")] <- "Voc"

# Bind it all together
ex.data <- rbind(am.ex.data, fr.ex.data)

bygender <- as.factor(ex.data$gen)
bynationality <- as.factor(ex.data$nat)

```

```{r Q.ca, cache = T, message=FALSE, warning=FALSE, include = FALSE}

dimcares.inf <- epCA.inference.battery(musdimdata.no6, 
                 masses= NULL, weights= NULL, 
                 hellinger = FALSE, symmetric = TRUE, 
                 graphs =FALSE, test.iters = 1000)

# Factor Scores
FIsym  <- dimcares.inf$Fixed.Data$ExPosition.Data$fi
#FIasym <- RenormFi$G_A
FJs    <- dimcares.inf$Fixed.Data$ExPosition.Data$fj
CA.Q.Eigs <- dimcares.inf$Fixed.Data$ExPosition.Data$eigs
CA.Q.pEig <- dimcares.inf$Inference.Data$components$eigs.perm
```

```{r someQcolors}
# Participant colors:
col4M <- wes_palettes$Zissou1[1]
col4F <- wes_palettes$Zissou1[5]
col4FR <- wes_palettes$Darjeeling2[2]
col4AM <- wes_palettes$Darjeeling1[1]
# 
col4byG <- as.character(bygender)
col4byG[col4byG == "F"] <- col4F
col4byG[col4byG == "M"] <- col4M

col4byN <- as.character(bynationality)
col4byN[col4byN == "France"] <- col4FR
col4byN[col4byN == "USA"] <- col4AM

# To account for the fact that we removed some rows above:
#numberofdims[c(1,3,7,10,11)] <- c(6,7,8,3,4)
#numberofdims <- numberofdims[-2]

#numberofdims[c(1,7,8,9,10)] <- c(8,7,3,4,6)

#numberofdims <- numberofdims[-11]


col4cols <- wes_palette("FantasticFox1", 
                        length(numberofdims), type = "continuous")
col4cols <- rep(col4cols, numberofdims)

```

```{r bootQCA, cache=TRUE}

bootCA <- Boot4PTCA(ZeDataCube = thebrick.no6,
           fi = FIsym,
           fj = FJs,
           eigs = CA.Q.Eigs,
           nf2keep = 3,
           nBootIter = 500)
# Compute Bootstrapped ratios
bootRatios.I <- PTCA4CATA::boot.ratio.test(bootCA$RowsBoot,
                                            critical.value = 2)
bootRatios.J <- PTCA4CATA::boot.ratio.test(bootCA$ColumnsBoot,
                                              critical.value = 2)
# Probabilities 
probBR.I  <- bootRatios.I$prob.boot.ratios
probBR.J  <- bootRatios.J$prob.boot.ratios
```

```{r ca4Judges.Q}
# We have a problem here because most matrices
#  have lines with zeros. A symmetric difference matrix 
#  would do better than an RV or a 
#  chi2 distance so we use createSymDist4PTCA

Cmat.Q <- createSymDist4PTCA(thebrick)$CrossProduct

# Calculate the eigenvalues and the percentage of variance extracted (tau)
eigenCmat.Q <- eigen(Cmat.Q, symmetric = TRUE)
eig4Cmat.Q <-  eigenCmat.Q$values
tau4Cmat.Q <- round( (100*eig4Cmat.Q) / sum(eig4Cmat.Q))

# Calculate factor scores for the first three dimensions
nk       <- 3
F4Cmat.Q   <- eigenCmat.Q$vectors[,1:nk] %*% diag(eig4Cmat.Q[1:nk]^(1/2))

# Prep for plotting
Shortnames4Participants.Q <-  dimnames(thebrick[[3]])
rownames(F4Cmat.Q) <- Shortnames4Participants.Q

# Make labels
labels4RV.Q <- createxyLabels.gen(1,2,lambda = eig4Cmat.Q, tau = tau4Cmat.Q)

```

## Results

### Participants

  The MDS performed on the co-occurrence matrix of participants was intended to identify potential clusters of participants. Visual examination of the results did not reveal any clusters --- a pattern suggesting that the participants constituted a homogeneous group. To further assess this conclusion, we also computed average factor scores by nationality and gender identity and bootstrap-derived confidence intervals around these averages and did not find any significant differences. See supplementary materials for plots illustrating this. 

```{=latex}
\begin{wrapfigure}{h}{.4\textwidth}  
  \begin{center}
  \caption{Scree plot for the CA of the Musical Qualities Survey}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/scree4excerptsq-1.png}
  \caption*{\footnotesize \textit{Note.} The x-axis represents dimensions and the y-axis represens the amount of variance extracted by each dimension. }(\#fig:scree4excerptsq)  
 \end{center}
\end{wrapfigure}
```

### Excerpts

```{r getQeigs}
dim1eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[1]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)

dim2eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[2]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)

dim3eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[3]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)

dim4eigperc <- round(100*(dimcares.inf$Fixed.Data$ExPosition.Data$eigs[4]/sum(dimcares.inf$Fixed.Data$ExPosition.Data$eigs)), 2)
```
```{r scree4excerptsq, include = FALSE}
mus.scree <- PlotScree(dimcares.inf$Fixed.Data$ExPosition.Data$eigs, 
                       #dimcares.inf$Inference.Data$components$p.vals, 
                       plotKaiser = T, color4Kaiser = "red"
                                              ) 

mus.00.scree <- recordPlot()

```


  The results of the CA performed on the contingency table revealed two significant dimensions, accounting for `r sum(dim1eigperc, dim2eigperc)`% of the total variance. Figure \@ref(fig:scree4excerptsq) displays the scree plot, which shows for this analysis the percentage of variance explained by each dimension.  
  
```{r factormapsQbuild, fig.height = 10, fig.show = 'hold', out.width='75%'}


load("excerptsdesign.RData")

col4exgrp <- excerptsdesign$ex.design$col4exgrp
ex.cols <- excerptsdesign$ex.design$ex.cols

names(col4exgrp) <- rownames(musdimdata.no6)

axisone = 1
axistwo = 2

rownames(FIsym)<- c(1:5,7:13,15:30)
unsignedCJ <- dimcares.inf$Fixed.Data$ExPosition.Data$cj[,1:2]
signedCJ <- dimcares.inf$Fixed.Data$ExPosition.Data$cj * sign(FJs)

sig.colsonly <-  rownames(FJs)[(unsignedCJ[,1] > (1/nrow(FJs))) | 
                                 (unsignedCJ[,2] > (1/nrow(FJs))) ]

sig.FJs <- FJs[sig.colsonly,1:4]

col4sigcolsonly <- col4cols[(unsignedCJ[,1] > (1/nrow(FJs))) | 
                              (unsignedCJ[,2] > (1/nrow(FJs))) ]

mat6 <- as.matrix(catadata.list$contingency[c(6,14),])
colnames(mat6) <- colnames(catadata.list$contingency)

#test <- epCA(musdimdata.no6, 
#                  masses= NULL, weights= NULL, 
#                 hellinger = FALSE, symmetric = TRUE, 
#                 graphs =FALSE)

proj6 <- supplementaryRows(mat6, dimcares.inf$Fixed.Data)

rownames(proj6$fii) <- c("6","14")

scoresw6 <- rbind(FIsym, proj6$fii)

cols4proj <- c(col4exgrp, gplots::col2hex(c("blueviolet", "blueviolet")))

desc_groups <- excerptsdesign$ex.design$col4exgrp

dgf <- excerptsdesign$ex.design$thedesign

desc_groups[dgf == "ex.group1"] <- "Group 1"
desc_groups[dgf == "ex.group2"] <- "Group 2"
desc_groups[dgf == "ex.group3"] <- "Group 3"
desc_groups[dgf == "ex.group4"] <- "Group 4"
desc_groups <- c(desc_groups, "Projected", "Projected")
desc_groups <- as.factor(desc_groups)
#ti.qs.12 <- MakeToleranceIntervals(scoresw6, design = desc_groups, col = unique(cols4proj))
#+ ti.qs.12
exmap.sym.12 <- createFactorMapIJ(scoresw6,
                                sig.FJs,
                                axis1 = axisone,axis2 = axistwo,
                                col.points.i = cols4proj, 
                                col.labels.i = cols4proj, 
                                col.points.j = col4sigcolsonly, 
                                col.labels.j = col4sigcolsonly,
                                text.cex.i = 4, text.cex.j = 4,
                                cex.i = 4, cex.j = 4,
                                font.face.j = "italic",
                                alpha.labels.i = 1, alpha.labels.j = 1
                                )

vc.labels.12 <- createxyLabels(resCA = dimcares.inf$Fixed.Data)

mus.012.i <- exmap.sym.12$baseMap +  
              exmap.sym.12$I_points + 
                exmap.sym.12$I_labels + 
                  vc.labels.12 + ggtitle('Factor Map, Experts Survey: Excerpts') 
                    

mus.012.j <- exmap.sym.12$baseMap +  
              exmap.sym.12$J_points + 
                exmap.sym.12$J_labels + 
                  vc.labels.12 + ggtitle('Factor Map, Experts Survey: Musical Qualities')

#print(mus.012.i)
#print(mus.012.j)

#mus.012.023 <- recordPlot()
```

  Preliminary plots of the factor scores obtained from the CA revealed that Excerpts 6 and 14 distorted the factor space, with these two excerpts dominating the second and third dimensions, respectively. To help interpret the factor space, these two excerpts were removed from the data and the CA was recomputed. Excerpts 6 and 14 were then added back in as *supplementary observations*, a technique which visualizes the information these elements share with the other elements in the sample without distorting the factor space. The proximity of these supplementary observations to the origin helps identify how much information is shared with the rest of the sample. The closer the supplementary observations are to the origin, the less information they share with the rest of the sample, and if they appear directly on the origin, that suggests that they share no information.  
  
  The HCA revealed four clusters (see supplementary materials for the dendrogram). Figure \@ref(fig:factormapsQ)a displays these clusters represented by colors, with Excerpts 6 and 14 as supplementary observations colored separately. Figure \@ref(fig:factormapsQ)b displays the qualities, with the levels of a given quality colored the same. For clarity, only the levels of qualities that contributed significantly (see below, and Figure \@ref(fig:contributionsQ)) are displayed.

  The proximity between any two points in Figure \@ref(fig:factormapsQ) can only be interpreted directly as similarity when the points are on the same map. Proximity between points on separate maps must be interpreted relative to the center of mass. Because CA captures "average" information, greater proximity between an excerpt and the level of a quality can be interpreted as the two being associated with one another *more than the average* [@Abdi2010d]. 

```{r factormapsQcode, fig.width=12}
#grid.arrange(
#    as.grob(mus.012.i),as.grob(mus.012.j),
#    ncol = 2,nrow = 1#,
   # top = textGrob("Symmetric Maps of the Row and Column Factor Scores", gp = gpar(fontsize = 18, font = 3))
#  )
```  

```{=latex}
\begin{figure}   
  \centering  
  \caption{Factor Plots for Rows and Columns of the Qualities Survey}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/factormapsQ-1.png}
  \label{fig:factormapsQ}
  \caption*{\footnotesize \textit{Note.} Axes are labeled with the dimension, the eigenvalue, and the explained variance. Row and column factor scores displayed separately. Only levels of variables that contribute significantly to the first two dimensions are plotted.}
\end{figure}
```


  To evaluate the relative importance of the excerpts and musical qualities in defining each dimension, we computed the *contributions* of the excerpts and qualities to the factorial dimensions. Contributions are similar to a squared coefficient of correlation. They vary between zero and one with zero indicating no importance and one indicating maximum importance [@Abdi2010d]. Contributions---being squared---are positive, but to facilitate interpretation contributions are signed to express the sign of the factor scores. Contributions whose magnitude is larger than the average contribution are considered important for their factorial dimensions. A plot of the contributions for all variables is in the supplementary materials.  
  
  Figure \@ref(fig:contributionsQ) shows only the contributions of excerpts and qualities important for first two dimensions. For Dimension 1, Excerpts 4, 13, 23, and 26 contribute to the positive side of the dimension, whereas Excerpts 3, 7, 10, 24, and 27 contribute to the negative side of the dimension. Low tempi (tempo.F2 and tempo.F1) contribute to the negative side, along with legato (smooth) articulation and soft dynamics. Finally, high tempi contribute to the positive side, along with marcato and staccato (accented and separate, respectively) articulations and loud dynamics. Single levels from other variables also contribute to the first dimension: major harmony, classical genre, and undulating contour in the positive direction and disjunct motion and triple meter in the negative direction. 
  
  For Dimension 2, Excerpts 7, 12, 15, 27, and 29 contribute to the positive side of the dimension, whereas Excerpts 2, 3, 11, and 17 contribute to the negative side. Newer genres (Contemporary, Jazz/Blues, and Modern) contribute to the positive side of Dimension 2, along with Blues and Quintal harmony, Quadruple meter, Gradual decrescendo and loud dynamics, ascending contour, "no melody", and the slowest level of the tempo variable. Older genres (Baroque, Classical, and Romantic) contribute to the negative side of this dimension, along with soft dynamics, minor harmony, and triple meter. A full list of contributions is available at the URL in the author note.  

```{r justsomecontsQ}


signed.ctrI <- dimcares.inf$Fixed.Data$ExPosition.Data$ci * sign(FIsym)
signed.ctrJ <- dimcares.inf$Fixed.Data$ExPosition.Data$cj * sign(FJs)

CIlist.dim <- vector(mode = "list", length = 6)
CJlist.dim <- vector(mode = "list", length= 6)

names(CIlist.dim) <- c("Dim1", "Dim2", "Dim3", "Dim1cols", "Dim2cols", "Dim3cols")
names(CJlist.dim) <- c("Dim1", "Dim2", "Dim3", "Dim1cols", "Dim2cols", "Dim3cols")

for (i in 1:3){
  CIlist.dim[[i]] <- signed.ctrI[which(abs(signed.ctrI[,i]) > 1/nrow(signed.ctrI)),i]
  CJlist.dim[[i]] <- signed.ctrJ[which(abs(signed.ctrJ[,i]) > 1/nrow(signed.ctrJ)),i]
  CJlist.dim[[i]] <- CJlist.dim[[i]][order(names(CJlist.dim[[i]]))]
}

names(col4cols) <- colnames(musdimdata.no6)

for (i in 4:6){
  CIlist.dim[[i]] <- col4exgrp[names(col4exgrp) %in% names(CIlist.dim[[i-3]])]
  CJlist.dim[[i]] <- col4cols[names(col4cols) %in% names(CJlist.dim[[i-3]])]
  CJlist.dim[[i]] <- CJlist.dim[[i]][order(names(CJlist.dim[[i]]))]
}

col4barsQ <- vector(mode = "list", length = 6)
names(col4barsQ) <- c("IDim1", "JDim1", "IDim2", "JDim2", "IDim3", "JDim3")

nrows <- nrow(signed.ctrI)

```

```{r contributionsQcode, fig.width=10}
# plot contributions of rows for component 1
ctrI.1 <- PrettyBarPlot2(CIlist.dim$Dim1,
                         threshold = 1 / NROW(signed.ctrI),
                         font.size = 3,
                         color4bar = CIlist.dim$Dim1cols,  #col4exgrp[which(abs(signed.ctrI[,1]) > 1/nrow(signed.ctrI))] , # we need hex code
                         ylab = 'Contributions', #sortValues = TRUE,
                         ylim = c(1.2*min(signed.ctrI[,1]), 1.2*max(signed.ctrI[,1]))
) + ggtitle("Dimension 1", subtitle = 'Rows')

# plot contributions of columns for component 1
ctrJ.1 <- PrettyBarPlot2(CJlist.dim$Dim1,#[order(names(CJlist.dim$Dim1))],
                         threshold = 1 / NROW(signed.ctrJ),
                         font.size = 3,
                         color4bar = CJlist.dim$Dim1cols,  #cols4conts[which(abs(signed.ctrJ[,1]) > 1/nrow(signed.ctrJ))], # we need hex code
                         ylab = 'Contributions',
                         ylim = c(1.2*min(signed.ctrJ[,1]), 1.2*max(signed.ctrJ[,1]))
) + ggtitle("", subtitle = 'Columns')

# plot contributions of rows for component 2
ctrI.2 <- PrettyBarPlot2(CIlist.dim$Dim2,
                         threshold = 1 / NROW(signed.ctrI),
                         font.size = 3,
                         color4bar = col4exgrp[which(abs(signed.ctrI[,2]) > 1/nrow(signed.ctrI))] , # we need hex code
                         ylab = 'Contributions',
                         ylim = c(1.2*min(signed.ctrI[,2]), 1.2*max(signed.ctrI[,2]))
) + ggtitle("Dimension 2", subtitle = 'Rows')

# plot contributions of columns for component 2
ctrJ.2 <- PrettyBarPlot2(CJlist.dim$Dim2,
                         threshold = 1 / NROW(signed.ctrJ),
                         font.size = 3,
                         color4bar = CJlist.dim$Dim2cols, # we need hex code
                         ylab = 'Contributions',
                         ylim = c(1.2*min(signed.ctrJ[,2]), 1.2*max(signed.ctrJ[,2]))
) + ggtitle("", subtitle = 'Columns')


#grid.arrange(
#    as.grob(ctrI.1),as.grob(ctrJ.1),
#    as.grob(ctrI.2),as.grob(ctrJ.2),
#    ncol = 2,nrow = 2#, top = textGrob("Contributions, Qualities Survey", gp = gpar(fontsize = 18, font = 3))
#  )

#Ctr.IJ <- recordPlot()

#1 - blue, 2 - red, 3 - green, 4 - yellow
```

```{=latex}
\begin{figure}   
  \centering  
  \caption{Important contributions for the CA of the Musical Qualities}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/contributionsQ-1.png}
  \label{fig:contributionsQ}
  \caption*{\footnotesize \textit{Note.} The y-axis represents the value of the contributions. The excerpts are colored according to the clusters extracted by the HCA and the levels of each variable are all colored the same.}
\end{figure}
```

## Discussion

  Figure \@ref(fig:factormapsQ) reveals a few musical connections: for example between tempo and articulation (on Dimension 1), and between genre and harmony (on Dimension 2). Staccato articulations, associated on this factor plot with high tempi, are played light and separate, and legato articulations, associated with slow tempi, are played smooth and connected. In terms of performance practice, slow or long notes are played in a legato style to create a sense of continuity, and fast moving notes or phrases do not require the same technique. The coordinate mapping of jazz/blues harmony and genre, which are on top of one another is the most extreme example of a genre being associated with certain harmonic material, but other connections are also revealed. The second dimension separates the older styles, such as Baroque, Classical, and Romantic, from newer styles, Contemporary, Jazz/Blues, and Modern. Dimension 2 associates the simpler harmonies of major and minor and the more complex harmonies of quintal and blues with older and newer styles, respectively, following historical practice. The Classical era had fairly structured rules for both harmony and voice leading, but the Romantic era relaxed those rules and introduced more complex harmonies [@Cohn2001]. The gradual devolution of those rules and the increase in complexity of harmony continued through the modern and contemporary styles [@Cohn2001; @Kennedy2013].  
  
  These musical connections facilitate our interpretation of the first two dimensions. The first dimension can be interpreted as arousal---tempo, articulation, and dynamics all load from greater arousal in the positive direction to lesser arousal in the negative direction on the first dimension. Dimension 2 is less clear, and does not seem to be tied to valence. Minor and major harmony, for example, both score negatively on Dimension 2. Instead, Figure \@ref(fig:contributionsQ) shows that while two levels of the meter variable are the most important for this dimension, that genre is also important, based on the number of levels of genre that contribute significantly to Dimension 2. Considering these and the harmony variables, it may be that the second dimension represents complexity.  

  Finally, we note that because of the nature of this survey, these results tell us more about the excerpts themselves rather than the behavior of the participants. The participants rated the stimuli similarly, validating the variety among the excerpts, indicating that they are different enough to create a large and varied factor space. 


# Experiment 2: Musical Adjectives Survey
 
## Methods

### Participants

  Participants with self-reported normal hearing were recruited for Experiment 2 without regard to level of music training. Participants in the United States were recruited through the UT Dallas Psych Research Sign-up (SONA) System and by word of mouth and social media. French participants were recruited by word of mouth, email, and social media. Only participants who signed up via the SONA System were compensated with research participation credit, other participants were not compensated in any way. Of a total 520 survey responses, 160 were removed for being incomplete, leaving a total of 354. Additionally, participants from the US who indicated solely a nationality other than American were excluded from analysis. "Ghanian", for example, was not included, but responses such as "Indian-American" were. This left a total of 178 ($\textit{N}_F$ = 112, $\textit{N}_A$ = 166) survey responses for analysis. All recruitment measures were approved by the UT Dallas IRB.  
  
### Stimuli  
  
  The stimuli used for Experiment 2 are the same as those used for Experiment 1.
  
### Survey
  
  The procedure for participants in Experiments 1 and 2 was similar. They received a link to a Qualtrics survey presented in either English or French, depending on their location, and instructions regarding listening environment were the same. After standard informed consent procedures, the participants listened to 15 of the 30 excerpts, presented one at a time, in a random order, and performed a CATA task. The task was to evaluate the stimuli using thirty-three adjectives such as 'dark', 'warm', and 'colorful' (French: 'sombre', 'chaleureux', and 'colore'). The adjectives for the AS were selected using @Wallmark2019 as a guide and in consult with a French professional musician. Some adjectives were initially selected in French and some in English. In all cases, adjectives were selected for which there was a clear French (vis-à-vis English) translation. The adjectives are listed in English and in French in the supplementary materials. Following the experimental task, the participants were asked to provide demographic data, including age, gender identity, nationality, occupation, and musical experience.  

### Data Processing & Analysis

  Data for the survey for Experiment 2 (Adjectives survey/AS) were processed similarly to those for Experiment 1. Due to a technical error, French participants were not presented with Excerpt 17, so the data from that excerpt was removed from the dataset for the American participants. To process the data, first, all French survey responses were translated into English. Both sets of responses were then converted into "bricks" of data, with the excerpts on the rows, the adjectives on the columns, and participants on the pages. On any page, at the intersection of any row and column was a one or a zero, with a one indicating that this participant had selected this adjective (column) to describe this stimulus (row). The bricks were then concatenated and summed across pages to obtain a pseudo-contingency table in which the intersection of a row and a column was the total number participants who selected an adjective to describe an excerpt.  
  
  After data processing, the data were in two usable forms, a brick and a contingency table. To analyze the similarity structure between participants, we computed a co-occurrence matrix from the brick with participants on the rows and columns, such that the intersection of a row and column represented the number of similar choices between participants. This was then analyzed using MDS.  
  
  To analyze the excerpts and adjectives and obtain the music quality space, we performed a CA on the contingency table. To identify potential clusters of excerpts or adjectives, two separate HCAs were computed, one each on the row factor scores (excerpts) and the column factor scores (adjectives) obtained from the CA. 
  
  We used MFA to explore the differences between the ratings of French and American participants. To prepare the data, we summed separate pseudo-contingency tables for the French and American participants, with the excerpts on the rows and the adjectives on the columns. Because MFA does not evaluate rows and columns in the same analysis the way the CA does, we had to transpose each of these tables to obtain tables with the adjectives on the rows and the excerpts on the columns. The two pairs of tables were concatenated and we then ran separate MFAs on these.  
  
  
```{r Adatain}
rm(list = ls())

load("adj.catadata.list.RData")
load("excerptsdesign.RData")
load("adjdesign.RData")
load("adjectivecolors.RData")

partcols <- adj.catadata.list$partcols
adjbrick <- adj.catadata.list$adjbrick
adj.contingency <- adj.catadata.list$adjcontingency
adjcols <- adj.catadata.list$adjcols
listofwords <- adj.catadata.list$listofwords

nat.factor <- partcols$nationality
col4nat <- nat.factor
nat.factor <- as.factor(nat.factor)

#cols$n.oc[nat.factor == "AM"] <- "#FF0000"
#cols$n.oc[nat.factor == "FR"] <- "#046C9A"
#cols$n.gc[1] <- "#FF0000"
#cols$n.gc[2] <- "#046C9A"

```

```{r A.CA}
adjsym.cares <- epCA(adj.contingency, 
                     symmetric = TRUE)

adjrenorm <- CARenormalization(adjsym.cares$ExPosition.Data$fi,
                               delta = adjsym.cares$ExPosition.Data$pdq$Dv,
                               singularValues = T,
                               masses = adjsym.cares$ExPosition.Data$M
                               )

FIsym.adj <- adjsym.cares$ExPosition.Data$fi
FIasym.adj <- adjrenorm$G_A
FJs.adj <- adjsym.cares$ExPosition.Data$fj
CAEigs.adj <- adjsym.cares$ExPosition.Data$eigs
```

```{r inferences.A, cache = TRUE}
# Bootstrapping
bootCA.adj <- Boot4PTCA(ZeDataCube = adjbrick,
                        fi = FIsym.adj,
                        fj = FJs.adj,
                        eigs = CAEigs.adj,
                        nf2keep = 3,
                        nBootIter = 1000)
# Compute Bootstrapped ratios
bootRatadj.I <- PTCA4CATA::boot.ratio.test(bootCA.adj$RowsBoot,
                                            critical.value = 2)
bootRatadj.J <- PTCA4CATA::boot.ratio.test(bootCA.adj$ColumnsBoot,
                                              critical.value = 2)
# Probabilities 
probBRadj.I  <- bootRatadj.I$prob.boot.ratios
probBRadj.J  <- bootRatadj.J$prob.boot.ratios

# Permutation tests
#adjca.inf <- perm4PTCA(aCube = adjbrick,
#                       nIter = 1000,
#                       permType = 'byRows' ,
#                       Malinvaud = TRUE)
#Ind.Permu.adj    <- adjca.inf$permInertia
#InertiaFixed.adj <- adjca.inf$fixedInertia
#prob.cpt.lst.adj <- adjca.inf$MalinvaudQ['p-perm',]
# Get the p values for the components
#prob.cpt.adj <- (unlist(prob.cpt.lst.adj[2:length(prob.cpt.lst.adj)]))
#prob.cpt.adj[is.na(prob.cpt.adj)] <- 1
```

```{r partdistance.A}

Cmat.adj <- createSymDist4PTCA(adjbrick)$CrossProduct

eigenCmat.adj <- eigen(Cmat.adj, symmetric = TRUE)
eig4Cmat.adj <-  eigenCmat.adj$values
tau4Cmat.adj <- round( (100*eig4Cmat.adj) / sum(eig4Cmat.adj))

nk       <- 3
F4Cmat.adj   <- eigenCmat.adj$vectors[,1:nk] %*% diag(eig4Cmat.adj[1:nk]^(1/2))

rownames(F4Cmat.adj) <- rownames(Cmat.adj)
```

```{r apartscreecode, include = FALSE}
ScreeInf <- PlotScree(ev = eig4Cmat.adj,
             max.ev = NULL, alpha = 0.05,
             col.ns = "#006D2C", col.sig = "#54278F",
             #title = "Participants Distance Analysis, Adjectives Survey: \nExplained Variance per Dimension",
             plotKaiser = T)

a000.adj.screeRV <-  recordPlot()
```  

## Results
### Participants
```{=latex}
%\begin{wrapfigure}{h}{.4\textwidth}  
%  \begin{center}
%    \includegraphics{./Music-Descriptor-Space_files/figure-latex/a.part.scree-1.png}
%  \caption{This plot shows the explained variance per dimension for this analyisis.}(\#fig:apartscree)  
% \end{center}
%\end{wrapfigure}
```
  
  Figure \@ref(fig:map4RVA) displays the factor scores obtained from the MDS performed on the co-occurrence matrix for the AS, along with group means and bootstrap-derived confidence intervals. The separation between the confidence intervals indicates significant differences between French and American participants, $\textit{p}$. < .01. Additional analyses using gender identity and level of music training as factors were not found to be significant.  
  
```{r map4RVAcode, fig.height=6, out.height = "30%", include = FALSE}
Shortnames4Participants <-  dimnames(adjbrick[[3]])
F4Plot <- F4Cmat.adj
rownames(F4Plot) <- Shortnames4Participants
# Make labels
labels4RV <- createxyLabels.gen(1,2,lambda = eig4Cmat.adj, tau = tau4Cmat.adj)

#Here we calculate the means for the factor groupings, and then bootstrap them:
n.adjmeans <- getMeans(F4Plot, nat.factor)
BootCadj.N <- PTCA4CATA::Boot4Mean(F4Cmat.adj, design = nat.factor,
                                   niter = 1000,
                                   suppressProgressBar = TRUE)
dimnames(BootCadj.N$BootCube)[[2]] <- paste0('Dimension ',
                                             1:dim(BootCadj.N$BootCube)[[2]])
# Create ellipses for the map
n.elliadj <- MakeCIEllipses(BootCadj.N$BootCube[,1:2,],
                            names.of.factors = c("Dimension 1", "Dimension 2"),
                            col = cols$n.gc)
#Base map
BaseMap.Participants <- createFactorMap(X = F4Plot ,
                              axis1 = 1, axis2 = 2,
                              display.points = TRUE,
                              col.points = cols$n.oc,
                              pch = 19, cex = 2.5,
                              display.labels = TRUE,
                              col.labels = cols$n.oc,
                              text.cex = 4, font.face = "bold",
                              font.family = "sans",
                              col.axes = "darkorchid", 
                              alpha.points = .25,
                              alpha.axes = 0.2,
                              width.axes = 1.1,
                              col.background = adjustcolor("lavender",
                                                       alpha.f = 0.2),
                              force = 1, segment.size = 3)

#Nationality map
title4RV <- "RV Analysis of Participants \nIncluding Group Means and Confidence Intervals"
n.rv.means <- createFactorMap(n.adjmeans,
                              axis1 = 1, axis2 = 2, 
                              constraints = BaseMap.Participants$constraints, 
                              col.points =  cols$n.gc,
                              alpha.points = 1, # no transparency
                              alpha.labels = 1,
                              display.points = TRUE,
                              pch = 17, cex = 5,
                              display.labels = TRUE, 
#                              title = title4RV,
                              col.labels = cols$n.gc, 
                              text.cex = 6,font.face = "bold",
                              font.family = "sans", col.axes = "darkorchid", 
                              alpha.axes = 0.2, width.axes = 1.1, 
                              col.background = adjustcolor("lavender", alpha.f = 0.2), 
                              force = 1, segment.size = 0)

a.03adj.map4part <- BaseMap.Participants$zeMap_background + 
                  n.rv.means$zeMap_text + n.rv.means$zeMap_dots +
                    BaseMap.Participants$zeMap_dots + n.elliadj + labels4RV


print(a.03adj.map4part)
```

```{=latex}
\begin{figure}   
  \centering  
  \caption{${R_V}$ Analysis of Participants in the Adjectives Survey}
    \includegraphics[width=0.7\columnwidth]{./Music-Descriptor-Space_files/figure-latex/apartrvmap.png}
  \label{fig:map4RVA}
  \caption*{\footnotesize \textit{Note.} Axis labels are the same as Figure 2. Factor scores for French and Americans are colored by group, in blue and red, respectively. Group means are indicated with triangles and labled with AM and FR. The ellipse around the group mean indicates the confidence interval, after bootstrapping 1000 iterations. The clear separation between the confidence intervals suggests there is a significant difference between the groups, \textit{p} > .001.}
\end{figure}
```

```{=latex}
\begin{wrapfigure}{h}{.4\textwidth}  
  \begin{center}
  \caption{Scree plot for the CA of the Adjectives Survey}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/scree4descriptors-1.png}
  \caption*{\footnotesize \textit{Note.} This plot shows the percentage of explained variance per dimension for this analysis. The horizontal line is called the Kaiser line and indicates the average variance extracted per dimension.}(\#fig:scree4descriptors)  
 \end{center}
\end{wrapfigure}
```

### Excerpts

```{r}
adj.tau <- adjsym.cares$ExPosition.Data$t
```

  The CA performed on the AS pseudo-contingency table revealed two significant dimensions, accounting for `r round(sum(adj.tau[c(1,2)]), 2)`% of the variance total variance. Figure \@ref(fig:scree4excerptsq) displays the scree plot, which shows for this analysis the percentage of variance explained by each dimension. Although excerpts 6 and 14 were removed from Experiment 1 data for being outliers, they were not outliers in this analysis, and were therefore included in all of the analyses for Experiment 2.  


```{r scree4descriptorscode, include = FALSE}
adj.scree <- PlotScree(adjsym.cares$ExPosition.Data$eigs, 
                       #p.ev = adjca.inf$pEigenvalues,
                       plotKaiser = T, color4Kaiser = "red")
  
mus.00.scree <- recordPlot()
```
```{=latex}
\begin{figure}   
  \centering  
  \caption{Factor Plots for the CA of the Adjectives Surveys}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/factormapsA-1.png}
  \label{fig:factormapsA}
  \caption*{\footnotesize \textit{Note.}  This plot shows the row and column factor scores displayed separately. Excerpts and Adjectives are colored according to the clusters exctracted by their respecitve HCAs}
\end{figure}
```

```{r factormapsAcode, fig.width= 10, fig.show = 'hold', out.width='100%', include = FALSE}

rownames(FIsym.adj) <- c(1:16,18:30)


axisone <- 1
axistwo <- 2

exmap <- createFactorMapIJ(FIsym.adj,
                           FJs.adj,
                           axis1 = axisone,axis2 = axistwo,
                           col.points.i = cols$ex.oc, 
                           col.labels.i = cols$ex.oc, 
                           col.points.j = cols$adj.oc, 
                           col.labels.j = cols$adj.oc,
                           text.cex.i = 3.5, text.cex.j = 3.5,
                           font.face.j = 'italic',
                           
                           )

vc.labels <- createxyLabels(resCA = adjsym.cares)


mus.adj.fi <- exmap$baseMap + #zePoly.J + 
            exmap$I_points + 
              exmap$I_labels + 
              #  exmap$J_points + 
               #   exmap$J_labels + 
                    vc.labels + ggtitle('Excerpts')
  
mus.adj.fj <- exmap$baseMap + #zePoly.J + 
          #  exmap$I_points + 
           #   exmap$I_labels + 
                exmap$J_points + 
                  exmap$J_labels + 
                    vc.labels + ggtitle('Adjectives')




#grid.arrange(
#    as.grob(mus.adj.fi),as.grob(mus.adj.fj),
 #   as.grob(mus.adj.amj),as.grob(mus.adj.frj),
#    ncol = 2,nrow = 1# ,top = textGrob("Factor Plots for the Adjectives Survey", gp = gpar(fontsize = 22, font = 3))
# )

```

  The HCAs computed separately on the row and column factor scores revealed four clusters for each, and the excerpts and adjectives are colored according to those clusters in Figure \@ref(fig:factormapsA). This figure displays the row (excerpt) and column (adjective) factor scores obtained from the CA computed on the AS contingency table. Interpretation of the maps individually and jointly is the same as for Experiment 1.

  Figure \@ref(fig:contributionsQ) shows the contributions of excerpts and qualities important for first two dimensions. For Dimension 1, Excerpts 4, 13, 23, and 26, contribute to the positive side of the dimension, whereas Excerpts 3, 7, 10, 24, and 27 contribute to the negative side of the dimension. Low tempi (tempo.F2 and tempo.F1) contribute to the negative side, along with legato (smooth) articulation and soft dynamics. Finally, high tempi contribute to the positive side, along with marcato and staccato (accented and separate, respectively) articulations and loud dynamics. Single levels from other variables also contribute to the first dimension: major harmony, classical genre, and undulating contour in the positive direction and disjunct motion and triple meter in the negative direction. 
  
  For Dimension 2, Excerpts 7, 12, 15, 27, and 29 contribute to the positive side of the dimension, whereas Excerpts 2, 3, 11, and 17 contribute to the negative side. Newer genres (Contemporary, Jazz/Blues, and Modern) contribute to the positive side of Dimension 2, along with Blues and Quintal harmony, Quadruple meter, Gradual decrescendo and loud dynamics, ascending contour, "no melody", and the slowest level of the tempo variable. Older genres (Baroque, Classical, and Romantic) contribute to the negative side of this dimension, along with soft dynamics, minor harmony, and triple meter. A full enumeration of contributions and bootstrap ratios is available at the URL in the author note.  

 Figure \@ref(fig:contributionsA) displays the contributions of excerpts and adjectives important for the first two dimensions. For Dimension 1, Excerpts 3, 7, 10, 18, 24, and 27 contribute to the positive side of the dimension, whereas Excerpts 4, 13, 19, 23, and 26 contribute to the negative side. Adjectives "Dark", "Disturbing", "Melancholy", "Mysterious", "Sad", "Slow", and "Solemn" contribute in the positive direction, whereas "Bright", "Colorful",  "Dancing", "Fast", and "Happy" contribute in the positive direction.

  For Dimension 2, Excerpts 1, 6, 7, 16, and 25 contribute to the positive side of the dimension, whereas Excerpts 10, 11, 20, 28, and 29 contribute to the negative side. Adjectives "Aggressive", "Complex", "Disturbing", "Fast", "Mysterious", and "Surprising" contribute to the positive side of Dimension 2, whereas "Happy", "Melancholy","Round", "Slow", "Soft", "Solemn", and "Warm" contribute to the negative side. 

  
```{r justsomecontsA}
signed.ctrI.adj <- adjsym.cares$ExPosition.Data$ci * sign(FIsym.adj)
signed.ctrJ.adj <- adjsym.cares$ExPosition.Data$cj * sign(FJs.adj)

CIlist <- vector(mode = "list", length = 2)
CJlist <- vector(mode = "list", length= 2)

names(CIlist) <- c("Dim1", "Dim2")
names(CJlist) <- c("Dim1", "Dim2")

for (i in 1:3){
  CIlist[[i]] <- signed.ctrI.adj[which(abs(signed.ctrI.adj[,i]) > 1/nrow(signed.ctrI.adj)),i]
  CJlist[[i]] <- signed.ctrJ.adj[which(abs(signed.ctrJ.adj[,i]) > 1/nrow(signed.ctrJ.adj)),i]
}
```

```{r contributionsAcode, fig.width=10}
# plot contributions of rows for component 1
ctradjI.1 <- PrettyBarPlot2(CIlist[[1]],
                         threshold = 1 / NROW(signed.ctrI.adj),
                         font.size = 3,
                         color4bar = cols$ex.oc[which(abs(signed.ctrI.adj[,1]) > 1/nrow(signed.ctrI.adj))], # we need hex code
                         ylab = 'Contributions',
                         #sortValues = TRUE,
                         ylim = c(1.2*min(CIlist[[1]]), 1.2*max(CIlist[[1]]))
) + ggtitle("Component 1", subtitle = 'Excerpts')

# plot contributions of columns for component 1
ctradjJ.1 <- PrettyBarPlot2(CJlist$Dim1,
                         threshold = 1 / NROW(signed.ctrJ.adj),
                         font.size = 3,
                         color4bar = cols$adj.oc[which(abs(signed.ctrJ.adj[,1]) > 1/nrow(signed.ctrJ.adj))], # we need hex code
                         ylab = 'Contributions',
                        # sortValues = TRUE,
                         ylim = c(1.2*min(CJlist[[1]]), 1.2*max(CJlist[[1]]))
) + ggtitle("", subtitle = 'Adjectives')

# plot contributions of rows for component 2
ctradjI.2 <- PrettyBarPlot2(CIlist[[2]],
                         threshold = 1 / NROW(signed.ctrI.adj),
                         font.size = 3,
                         color4bar = cols$ex.oc[which(abs(signed.ctrI.adj[,2]) > 1/nrow(signed.ctrI.adj))], # we need hex code
                         ylab = 'Contributions',
                        # sortValues = TRUE,
                         ylim = c(1.2*min(signed.ctrI.adj[,2]), 1.2*max(signed.ctrI.adj[,2]))
) + ggtitle("Component 2", subtitle = 'Excerpts')

# plot contributions of columns for component 2
ctradjJ.2 <- PrettyBarPlot2(CJlist$Dim2,
                         threshold = 1 / NROW(signed.ctrJ.adj),
                         font.size = 3,
                         color4bar = cols$adj.oc[which(abs(signed.ctrJ.adj[,2]) > 1/nrow(signed.ctrJ.adj))], # we need hex code
                         ylab = 'Contributions',
                        # sortValues = TRUE,
                         ylim = c(1.2*min(signed.ctrJ.adj[,2]), 1.2*max(signed.ctrJ.adj[,2]))
) + ggtitle("", subtitle = 'Adjectives')

#grid.arrange(
#    as.grob(ctradjI.1),as.grob(ctradjJ.1),
#    as.grob(ctradjI.2),as.grob(ctradjJ.2),
#    ncol = 2,nrow = 2#, top = textGrob("Contributions, Adjectives Survey", gp = gpar(fontsize = 18, font = 3))
#  )

#Ctradj.IJ <- recordPlot()

#yellow is 1, blue is 2, green is 3, red is 4.

```

```{=latex}
\begin{figure}   
  \centering  
  \caption{Contribution Barplots for Rows and Columns of the Adjectives Surveys}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/contributionsA-1.png}
  \label{fig:contributionsA}
  \caption*{\footnotesize \textit{Note.} The excerpts and adjectives with contributions important to Dimensions 1 and 2 are represented by their magnitude and direction. Both excerpts and variables are colored according to the clusters extracted by their respective HCAs.}
\end{figure}
```


  Figure \@ref(fig:mfasbs) displays partial factor score plots (see "Multiple Factor Analysis" above) of the results of the MFA evaluating the differences in rating behavior between French and American participants. Although the specific magnitudes of the dimensions extracted by the MFAs are different, as evidenced by the percentage of variance extracted ($\tau$) on the axes of the plots, the general space revealed by these analyses is similar to that revealed by the CA. Thus we can interpret the space similarly, relative to the valence-arousal plane. However, in this case, we cannot compare elements between maps.  
  
  The triangles represent the compromise between the mental spaces of the French and American participants for each item, and the lines extending from the triangles indicate the partial factor scores for the items from the perspective of each group [@Abdi2013]. Excerpts and adjectives that were rated similarly have shorter lines extending from them, but excerpts that were rated differently have much longer lines. Examples of excerpts that were rated differently are numbers 6, 8, and 12. Adjectives that were used differently include "Disturbing", "Round", "Solemn", and "Bright". 

```{r A.MFA.excode, fig.height=12, message=FALSE, warning=FALSE, include = FALSE}
suppressMessages(library(MExPosition))

adjbrick.AM <- adjbrick[,,1:length(which(adj.catadata.list$partcols$nationality == "US"))]
adj.cont.AM <- apply(adjbrick.AM, c(1,2), sum)

adjbrick.FR <- adjbrick[,,(length(which(adj.catadata.list$partcols$nationality == "US"))+1):dim(adjbrick)[[3]]]
adj.cont.FR <- apply(adjbrick.FR, c(1,2), sum)

adj4MFA <- abind(adj.cont.FR, adj.cont.AM, along = 2)

frvec <- t(as.data.frame(rep("France", length.out = dim(adj.cont.FR)[2])))
amvec <- t(as.data.frame(rep("US", length.out = dim(adj.cont.AM)[2])))

colnames(frvec) <- colnames(amvec) <- colnames(adj.cont.FR)
rownames(frvec) <- rownames(amvec) <- "group"


mfagroups <- abind(frvec, amvec, along = 2)


mfares <- mpMFA(adj4MFA, mfagroups)

renameCols <- function(x){
   colnames(x) <- paste("Dimension", 1:ncol(x))
   x
}

RVmat <- mfares$mexPosition.Data$InnerProduct$RVMatrix

#corrplot(RVmat, method = "color", addCoefasPercent = TRUE) 

Eig4scree <- mfares$mexPosition.Data$Table$eigs

#mfascree <- PlotScree(Eig4scree, plotKaiser = TRUE)

fi4pfs <- mfares$mexPosition.Data$Table$fi

fi4pfs[,2] <- fi4pfs[,2]*-1
rownames(fi4pfs) <- c(1:16,18:30)

MFA_FMap <- createFactorMap(
                            fi4pfs,
                            col.points = cols$ex.oc,
                            col.labels = cols$ex.oc,
                            alpha.points = .6,
                            pch = 17,
                            cex = 5, text.cex = 5,
                            display.labels = TRUE,
                            constraints = minmaxHelper4Partial(FactorScores = mfares$mexPosition.Data$Table$fi,
                              partialFactorScores = 1.25*mfares$mexPosition.Data$Table$partial.fi.array)
                            )
                            
label4Map <- createxyLabels.gen(1,2,
                                lambda = mfares$mexPosition.Data$Table$eigs,
                                tau = mfares$mexPosition.Data$Table$t,
                                axisName = "Dimension ")





fi4pfs <- renameCols(fi4pfs)

pfi4pfs <- mfares$mexPosition.Data$Table$partial.fi.array

pfi4pfs[,2,c(1:2)] <- pfi4pfs[,2,c(1:2)]*-1

pfi4pfs <- renameCols(pfi4pfs)
rownames(pfi4pfs) <- c(1:16,18:30)
dimnames(pfi4pfs)[[3]] <- c("France", "US")

map4PFS <- createPartialFactorScoresMap(
                                        factorScores = fi4pfs,
                                        partialFactorScores = pfi4pfs,
                                        axis1 = 1, axis2 = 2,
                                        colors4Items = cols$ex.oc,
                                        names4Partial = c("FR", "US"),
                                        font.labels = 'bold', 
                                        )

partialfsmap <- MFA_FMap$zeMap + 
                  label4Map + 
                    map4PFS$linesColByItems + 
                      map4PFS$pointsColByItems + 
                        map4PFS$labelsColByItems #+ ggtitle("Partial Factor Scores for Excerpts by Nationality")

adj4MFA.T <- abind(t(adj.cont.FR), t(adj.cont.AM), along = 2)

natvec <- rep(c("France", "US"), times = dim(adj4MFA.T)[2]/2)
natvec <- data.frame(natvec[order(natvec, decreasing = T)]) %>% t(.)

colnames(natvec) <- colnames(adj4MFA.T)
rownames(natvec) <- "group"

mfares.t <- mpMFA(adj4MFA.T, natvec)

RVmat.t <- mfares.t$mexPosition.Data$InnerProduct$RVMatrix

#corrplot(RVmat, method = "color", addCoefasPercent = TRUE) 

Eig4scree <- mfares$mexPosition.Data$Table$eigs

#mfascree <- PlotScree(Eig4scree, plotKaiser = TRUE)

MFA_FMap.t <- createFactorMap(
                            mfares.t$mexPosition.Data$Table$fi,
                            col.points = cols$adj.oc,
                            col.labels = cols$adj.oc,
                            alpha.points = .6,
                            pch = 17,
                            cex = 5,
                            display.labels = TRUE,
                            constraints = minmaxHelper4Partial(FactorScores = mfares.t$mexPosition.Data$Table$fi,
                              partialFactorScores = mfares.t$mexPosition.Data$Table$partial.fi.array)
                            )
                            
label4Map.t <- createxyLabels.gen(1,2,
                                lambda = mfares.t$mexPosition.Data$Table$eigs,
                                tau = mfares.t$mexPosition.Data$Table$t,
                                axisName = "Dimension ")




fi4pfs.t <- mfares.t$mexPosition.Data$Table$fi

fi4pfs.t <- renameCols(fi4pfs.t)

pfi4pfs.t <- mfares.t$mexPosition.Data$Table$partial.fi.array

pfi4pfs.t <- renameCols(pfi4pfs.t)

rownames(pfi4pfs.t) <- colnames(adj.contingency)

dimnames(pfi4pfs.t)[[3]] <- c("France", "US")

map4PFS.t <- createPartialFactorScoresMap(
                                        factorScores = fi4pfs.t,
                                        partialFactorScores = pfi4pfs.t,
                                        axis1 = 1, axis2 = 2,
                                        colors4Items = cols$adj.oc,
                                        names4Partial = c("FR", "US"),
                                        font.labels = 'bold', 
                                       # alpha.lines = .75, size.lines = 3
                                        )

```

```{=latex}
\begin{figure}
     \centering
     \caption{Partial Factor Scores Plots from the MFA on the Adjectives Survey}
     \begin{subfigure}[b]{0.45\textwidth}
         \centering
         \includegraphics[width=\textwidth]{./Music-Descriptor-Space_files/figure-latex/mfasbs-1}
         \caption{For the Excerpts.}
         \label{fig:excerptspfs}
     \end{subfigure}
     %\hfill
     \begin{subfigure}[b]{0.45\textwidth}
         \centering
         \includegraphics[width=\textwidth]{./Music-Descriptor-Space_files/figure-latex/mfasbs-2}
         \caption{For the adjectives.}
         \label{fig:adjectivespfs}
     \end{subfigure}
    \label{fig:mfasbs}
      \caption*{\footnotesize \textit{Note.}  In each plot, the triangles represent the combined factor scores and the small circles represent the partial factor scores contributed by each of the groups. Note the different values between plots in the dimension labels, indicating separate analyses.}
\end{figure}

```

```{r mfasbscode, fig.height=8, include = FALSE}
print(partialfsmap)

mfasbs <- recordPlot()
```

```{r mfasbs-tcode, fig.height = 8, include = FALSE}
partialfsmap.t <- MFA_FMap.t$zeMap + 
                  label4Map.t + 
                    map4PFS.t$linesColByItems + 
                      map4PFS.t$pointsColByItems + 
                        map4PFS.t$labelsColByItems #+ ggtitle("Partial Factor Scores for Adjectives, by Nationality")

print(partialfsmap.t)

mfasbs_t <- recordPlot()
```

## Discussion

  There are clues to the nature of the group differences between French and American participants in Figure \@ref(fig:map4RVA), the factor scores plot for the MDS. The greater variance among American participants, represented by the greater spread on the plot, highlights a much less homogeneous response to the excerpts relative to the French participants. This may be due to a much less homogeneous set captured by the American population sample. Among the American sample, there were a number of responses in which participants identified with another nationality in addition to American. However, all of the French participants responded with "French", except for one participant, who responded with "French - Belgian". 
  
  Although this experiment was designed to evaluate the cognitive response to music, and not the emotional response, there is significant overlap in the results observed here and the results of the work investigating music and emotion, specifically in the appearance of the valence-arousal plane. Studies on music and emotion have used this construct as a way of measuring emotion, but the original proposal was that this plane is simply a measure of "meaning" [@Osgood1955]. The adjectives selected for use in Experiment 2 reflect this original proposal, as they were selected specifically to represent a cognitive space, not an emotional one.

  Interpreting the differences in how the adjectives and the excerpts are distributed in the space is aided by considering the valence-arousal plane. Excerpts 6 and 12 tell a similar story, that the French participants tended to assign adjectives with higher arousal to these excerpts than the American participants. Excerpt 8 is similar, but with low arousal. More interesting, perhaps, is the difference between participants in rating Excerpt 4. Although the magnitude of the difference isn't as extreme, the American partial factor score lies just below the x-axis, in the positive valence/low arousal quadrant, and the French partial factor score lies above the x-axis, in the positive valence/low arousal quadrant. 
  
  Adjectives that highlight the differences between French and American participants include "Bright", "Light", "Round", "Solemn", "Melancholy", "Mysterious", and "Disturbing". "Bright" (Brillant) may be the most extreme example, as the French partial factor score is close to the origin and the American partial factor score is much further away, suggesting that this word carries much more positive valence in English than in French. Additionally, The location of the American partial factor score for "Bright" suggests that Americans commonly grouped it with "Colorful" and "Dancing", a contrast to how the French participants used it. In English, "melancholy" (melancolique) and "sad" (triste) were used the same, but in French they were used very differently. "Disturbing" (inquiétant) is much further from the origin, suggesting that it is more extreme for the French participants than the Americans. The location of "Solemn" (Solennel) suggests that it carries more valence in English, but more arousal in French. All of these differences highlight possible differences in semantic associations, and frequency of use between languages. 
  

# Experiment 3: Combined Surveys

```{r loadthedataPLSC}
rm(list = ls())

load("catadatamusdim.RData")
load("adj.catadata.list.RData")
load("adjdesign.RData")
load("adjectivecolors.RData")

source('~/GitHub/MusicDescriptorsBackup/barplot_sigonly.R')

dimcontingency <- catadata.list$contingency
adjcontingency <- adj.catadata.list$adjcontingency

dimcontingency <- dimcontingency[-c(6,14,17),]
dimcontingency <- dimcontingency[,order(colnames(dimcontingency))]
adjcontingency <- adjcontingency[-c(6,14),]

```

```{r}
library(TExPosition)
library(TInPosition)
library(data4PCCAR)
pls.res <- tepPLS(dimcontingency, adjcontingency, DESIGN = adj.design$thedesign[-c(6,14)])
resPerm4PLSC <- perm4PLSC(dimcontingency, adjcontingency, nIter = 1000)

```

```{r thefirst3eigs}

e1 <- pls.res$TExPosition.Data$eigs[1]
e2 <- pls.res$TExPosition.Data$eigs[2]
e3 <- pls.res$TExPosition.Data$eigs[3]

t1 <- pls.res$TExPosition.Data$t[1]
t2 <- pls.res$TExPosition.Data$t[2]
t3 <- pls.res$TExPosition.Data$t[3]
t4 <- pls.res$TExPosition.Data$t[4]

```

## Methods

  Experiment 3 was a Partial Least Squares Correlation performed using the pseudo-contingency tables created for Experiments 1 and 2. Tables used in PLSC require the same set of observations, so the data for Excerpts 6 and 14 was removed from the table for Experiment 2 and the data for Excerpt 17 was removed from the table for Experiment 1.
  The goal of this experiment was to identify the strongest shared signal between the two tables. PLSC shows what is common between two different sets of data---how often an excerpt was associated with *both* a musical quality and an adjective. The visualizations below show which adjectives are associated with which musical dimensions, and how the excerpts are grouped in a joint factor space. The dimensions extracted from the each table are called *latent variables* (LVs) and are shown with the latent variables of one table plotted against the latent variables of the other.

## Results & Discussion

```{=latex}
\begin{wrapfigure}{h}{.4\textwidth}  
  \begin{center}
  \caption{Scree plot for the PLSC}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/screePLSC-1.png}
  \caption*{Variance extracted per dimension, with two significant dimensions above the Kaiser line, in red.}(\#fig:screePLSC)  
 \end{center}
\end{wrapfigure}
```
  
  The PLSC performed using the pseudo-contingency tables from Experiments 1 and 2 revealed two significant dimensions that extracted the majority of the variance (`r round(sum(t1,t2), 2)`%).  

```{r screePLSCcode,include = FALSE}

PlotScree(ev = pls.res$TExPosition.Data$eigs,
         # p.ev = resPerm4PLSC$pEigenvalues,
          title = 'PLSC Music Features: Inertia Scree Plot',
          plotKaiser = TRUE, 
          color4Kaiser = "red",
          lwd4Kaiser  = 2
          )
a000.scree4plsc <-  recordPlot()

```
  Figure \@ref(fig:factorplotsPLSC) displays the factor score plots for this analysis with the first LVs from each table on the left and the second LVs extracted from the each table on the right. The excerpts are colored according to the clusters identified by the HCA for Experiment 2, with tolerance intervals plotted containing the excerpts in each group to highlight their distribution. The two sets of latent variables extracted by the analysis separate the groups of excerpts approximately by the clusters defined in the HCA for the adjectives survey. This suggests that the excerpts that are more distant from the origin in the first LV plot are defined more by valence than arousal, and those clustered further from the origin on the second LV plot are defined more by arousal than valence. The tolerance intervals for the groups highlight how the groups furthest from the barycenter in LV plot 1 are closer to the origin in LV plot 2, and the quadrants they occupy have switched. The other two groups remain in the same quadrants between plots, but move towards the origin. 
  Specific excerpts that highlight these differences include Excerpts 26, 24, and 27. Excerpt 26 is one of the most extreme examples of positive valence, but is much closer to the origin in the second LV plot, similarly with Excerpts 24 and 27, but with negative valence. This is contrasted with Excerpt 7, which is one of the most negatively valenced stimuli, appearing far from the origin in the first LV plot, but also scores very high on arousal, and appears far from the origin on the second LV plot as well. 

```{r factorplotsPLSCcode, fig.width = 12, fig.height = 6}
latvar.1 <- cbind(pls.res$TExPosition.Data$lx[,1],pls.res$TExPosition.Data$ly[,1])
colnames(latvar.1) <- c("Lx 1", "Ly 1")

zedesign <- adj.design$thedesign[-c(6,14)]
lescoleurs <- adj.design$ex.cols[-c(6,14)]
coleur4group <- adj.design$col4exgrp



rownames(latvar.1) <- c(1:5,7:13,15:16,18:30)


# compute means
lv.1.group <- getMeans(latvar.1, zedesign)

# get bootstrap intervals of groups
lv.1.group.boot <- Boot4Mean(latvar.1, zedesign)
colnames(lv.1.group.boot$BootCube) <- c("Lx 1", "Ly 1")

#Next, we can start plotting:

plot.lv1 <- createFactorMap(latvar.1,
                         col.points = lescoleurs,
                         col.labels = lescoleurs,
                         alpha.points = 0.8, alpha.labels = 0.8,
                         text.cex = 5, title = "Latent Variable Plot 1"
                         )

plot1.mean <- createFactorMap(lv.1.group,
                              col.points = coleur4group,
                              col.labels = coleur4group,
                              cex = 4,
                              pch = 17,
                              alpha.labels = 0.5,
                              text.cex = 6)

plot1.meanCI <- MakeCIEllipses(lv.1.group.boot$BootCube[,c(1:2),], # get the first two components
                              col = adj.design$col4exgrp,
                              names.of.factors = c("Lx 1", "Ly 1"), alpha.ellipse = .2,
                              alpha.line = 0, line.size = 0
                              )

plot1.ti <- MakeToleranceIntervals(latvar.1
                                   , zedesign
                                   , col = coleur4group
                                   )

plot1 <- plot.lv1$zeMap_background + plot.lv1$zeMap_dots + plot.lv1$zeMap_text + plot1.ti#plot1.meanCI 
#           plot1.mean$zeMap_text + 

latvar.2 <- cbind(pls.res$TExPosition.Data$lx[,2],pls.res$TExPosition.Data$ly[,2])
colnames(latvar.2) <- c("Lx 2", "Ly 2")

rownames(latvar.2) <- c(1:5,7:13,15:16,18:30)

# compute means
lv.2.group <- getMeans(latvar.2, zedesign)

# get bootstrap intervals of groups
lv.2.group.boot <- Boot4Mean(latvar.2, zedesign)
colnames(lv.2.group.boot$BootCube) <- c("Lx 2", "Ly 2")

#Next, we can start plotting:

plot.lv2 <- createFactorMap(latvar.2,
                         col.points = lescoleurs,
                         col.labels = lescoleurs,
                         alpha.points = 0.8, alpha.labels = 0.8,
                         text.cex = 5, title = "Latent Variable Plot 2"
                         )

plot2.mean <- createFactorMap(lv.2.group,
                              col.points = coleur4group,
                              col.labels = coleur4group,
                              cex = 4,
                              pch = 17,
                              alpha.labels = 0.5,
                              text.cex = 6)

plot2.meanCI <- MakeCIEllipses(lv.2.group.boot$BootCube[,c(1:2),], # get the first two components
                              col = coleur4group,
                              names.of.factors = c("Lx 2", "Ly 2"), alpha.ellipse = .2,
                              alpha.line = 0, line.size = 0
                              )

plot2.ti <- MakeToleranceIntervals(latvar.2
                                   , zedesign
                                   , col = coleur4group
                                   )


plot2 <- plot.lv2$zeMap_background + plot.lv2$zeMap_dots + plot.lv2$zeMap_text + plot2.ti#plot2.meanCI
         #  plot2.mean$zeMap_text + 


#grid.arrange(as.grob(plot1),
#             as.grob(plot2),
#             ncol = 2,nrow = 1
#             )
#plsc.fplot <- recordPlot()
```

```{=latex}
\begin{figure}   
  \centering  
  \caption{Factor Plots for Latent Variables Exctracted by the PLSC}
  \label{fig:factorplotsPLSC}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/factorplotsPLSC-1.png}
  \caption*{\footnotesize \textit{Note.} Left: first latent variables extracted from the pseudo-contingency tables of the QS and the AS. Right: Second latent variables extracted from the pseudo-contingency tables of the QS and the AS. For both plots, x-axis is the LV from the QS and the y-axis is the LV from the AS.}
\end{figure}
```


  Figure \@ref(fig:contsplsc) displays the variables from each data table that are important for the first and second latent variables. For this plot, the important levels of variables from the QS are displayed in red (positive) and green (negative) and the important adjectives from the AS are in yellow (positive) and blue (negative). The first LVs associate the levels of variables identified as contributing to an arousal dimension in Experiment 1 with the adjectives identified as contributing to a valence dimension in Experiment 2. Likewise the second LVs associate the adjectives identified as contributing to an arousal dimension in Experiment 2 with many of the levels of variables identified as contributing to the genre or complexity dimension in Experiment 1. 
  This suggests that many of the musical qualities that are associated with arousal, such as tempo, dynamics, and articulation, contribute to musical valence. Figure \@ref(fig:factormapsA) provides a useful key for interpretation. The excerpts appear to be separated approximately by quadrant, and less specifically by axis. This suggests that each group of excerpts reflects elements of both valence and arousal. 
  
```{r contsplsccode, fig.width = 10, fig.show='hold', message=F}

ctri <- pls.res$TExPosition.Data$ci*sign(pls.res$TExPosition.Data$fi)
ctrj <- pls.res$TExPosition.Data$cj * sign(pls.res$TExPosition.Data$fj)

conts.sigonly <- barplot.sigonly(x = ctri,
                                 y = ctrj,
                                 th = "mean",
                                 type = "cont")


contribution1 <- PrettyBarPlot2(bootratio = conts.sigonly$data$Dim1, 
                       threshold = conts.sigonly$t.hold$thr.tog, 
                       ylim = conts.sigonly$data$y.limits$ylims.tog$Dim1,
                       color4bar = c(conts.sigonly$color$x.vec$Dim1, conts.sigonly$color$y.vec$Dim1),
                       color4ns = "gray75", 
                       plotnames = TRUE, 
                       main = 'Contributions to the First Latent Variables', 
                       ylab = "Signed Contributions",
                       font.size = 2, line.col = "gray"
                       
                       )
  
contribution2 <- PrettyBarPlot2(bootratio = conts.sigonly$data$Dim2, 
                       threshold = conts.sigonly$t.hold$thr.tog, 
                       ylim =conts.sigonly$data$y.limits$ylims.tog$Dim2,
                       color4bar = c(conts.sigonly$color$x.vec$Dim2, conts.sigonly$color$y.vec$Dim2),
                       color4ns = "gray75", 
                       plotnames = TRUE, 
                       main = 'Contributions to the Second Latent Variables', 
                       ylab = "Signed Contributions",
                       font.size = 2, line.col = "gray"
                       )  

#grid.arrange(as.grob(contribution1),
#             as.grob(contribution2),
#             ncol = 1,nrow = 2
#             )

#contributionsplsc <- recordPlot()
```

```{=latex}
\begin{figure}   
  \centering  
  \caption{Factor Plots for Latent Variables Exctracted by the PLSC}
    \includegraphics{./Music-Descriptor-Space_files/figure-latex/contsplsccode-1.png}
  \label{fig:contsplsc}
  \caption*{\footnotesize \textit{Note.} Signed contributions important for the first and second latent variables extracted by the PLSC. The line representing the average contribution is in gray. The y-axis represents the magnitude of the contribution. Contributions are colored according to the table they are from. Red and green are from the QS and yellow and blue are from the AS.}
\end{figure}
```


# General Discussion
  
  We collected data in the form of responses to musical stimuli and used multivariate analyses to explore the musical and cognitive spaces created by participants from France and the United States. The results revealed a clear valence-arousal plane that was common to participants from both countries, but significant differences in the behavior of French and American participants when responding to the stimuli using adjectives, and a space defined by arousal and complexity when evaluating the stimuli using musical qualities. The combined musical and cognitive spaces identified which musical qualities were associated with which descriptors in terms of valence and arousal. 
  
  One effect observed in Experiment 1 which was not observed in Experiment 2, in which two individual excerpts---numbers 6 and 14---dominate the factor space, requires more explanation. In a CA, information that is common falls towards the origin---the center of mass, or *barycenter*---of the factor plot, while information that is further from the average, or more rare, ends up further away [@Abdi2010d]. Therefore, if any individual item on a survey is rated significantly different from the rest of the items, that item can dominate the factor space.  
  
  In this case we have two examples of stimuli that were different enough from the others in the set that they had this effect. Excerpt 6, which was a Steve-Reich-esque, minimalist, ostinato based excerpt, and Excerpt 14, a jazzy excerpt, were both the only representative of their respective styles, and were therefore different enough from the average that they distorted the factor space. However, this effect does not appear in Experiment 2 because the effect also depends on the specific questions asked. The QS was designed to separate the stimuli along specific musical dimensions, but the AS was designed to evaluate the excerpts more generally on holistic qualities. Thus, we can compare musical stimuli from different styles directly using these holistic qualities, but the relationships between styles become more difficult to quantify as we include specific musical qualities in the evaluations.
  
  One takeaway from these results is that a deep understanding of the stimuli may help to predict the approximate dimensionality of the solution factor space, and when designing surveys or stimuli, multiple items per group, or presumed dimension, are needed. The outliers distorting the factor space that were observed in the present study are analogous to the single noisy dimension described in the introduction. The differences in the behavior of participants between experiments in rating Excerpt 6 shows how survey design affects the overall results. It is possible that Excerpt 6 was the source of noise in Experiment 2---in addition to the effect observed in Experiment 1---due to the possibility that untrained participants are likely to be less familiar with minimalism than the trained participants in Experiment 1, but the results are robust to that noise because the participants were not asked to rate the excerpts on any explicit dimensions or qualities.  
  
  The significant results for the participants in Experiment 2 that were not observed in Experiment 1 suggest that this experimental paradigm works as intended. Significant differences between the experts' ratings of the stimuli would have indicated that the experts were inconsistent and thus not reliable raters of the music. The significant difference in ratings between the French and American participants on the AS indicates that language connotations and word use frequency in a language do have a significant impact on how participants rate the stimuli. MFA revealed some specific differences and highlighted further possibilities for analysis.

## Limitations & future directions

  Although we evaluate the scores and ratings of participants from different countries, we recognize that the issue of multiculturality is not addressed to a significant degree in this study, because France and the United States are both Western countries that share Western musical culture. To truly address this question, an experiment would need to include participants from multiple, contrasting musical cultures, with languages that are more distant than English and French. However, specific musical qualities, like harmony, may not apply or translate well to other musical cultures, because the concepts of melodic and harmonic material are not the same across all musical cultures [@Cohn2001; @Raman2017]. Therefore the specific questions included in the QS would need to be adjusted.  
  Although we suggest that data collected in this way have a much greater hypothetical reach, we recognize that the data collected for these experiments represent a convenience sample, and many of the participants were students. However, these limitations could be easily remedied in future studies.
  One question that fell beyond the scope of this study what the source of the semantic drift between languages is. Although illustrated in Figure \@ref(fig:mfasbs), the source of the differences between French and American participants is not entirely clear. These differences may not come from cultural aspects of music listening, but linguistic sources, including the adjectives' frequency of use in either language or the cultural associations with the words [@Thompson2020], or even the physical characteristics of the words themselves [@Reilly2012]. Diving more into those questions would be a fascinating future study. Another interesting study would be to use adjectives from specific domains, to see how music maps onto different sensory spaces, for example textural words, like 'moist', 'slimy', 'dry', 'puckered', 'smooth'.  
  Finally, the results of this study and possible extensions, in conjunction with studies that have already evaluated music perception non-verbally, may provide insight into the way in which people without language react to music, such as nonverbal autistic people.  

# Conclusions
  Expanding collection and analytical paradigms, and thus expanding scientific scope and perspective, has the added benefit of increasing reach. By expanding the ways in which we collect data, including developing investigative paradigms that are accessible on mobile platforms and that reduce participant demand while maintaining rigor and integrity, we are able to more readily and consistently reach a broader participant population, that might normally be excluded from everday research paradigms, specifically racially and ethnically diverse populations, poor populations, those with limited access to transportation, or who have a disability, or are immunocompromised.  
  The present study demonstrates such an experimental paradigm, that maintains a balance between relaxing experimental control and maintaining scientific rigor. Applying similar paradigms, and focusing on collecting large amounts of qualitative data on a large number of observations, and analyzing these data using multivariate analyses will provide new avenues for investigation.   
  Pairing this kind of data gathering with appropriate analysis will help maintain scientific integrity. The number of ways that exist to analyze data from a single set of experiments is considerable, and the results of each analysis illuminate different parts of the story behind the data. Not every form of analysis is appropriate in every context, but understanding how, and perhaps more importantly when, to apply an analytical technique is vital to uncovering new perspectives or insights.  

  
```{r saveGraphs, message = FALSE, warning = FALSE, error = FALSE}
powerpointFilename <- 'Music-Descriptor-Space.pptx'
path2pptx    <- './Analysis/'
name4Graphs  <- paste0(path2pptx,powerpointFilename)
title4Graphs <- 'Music Descriptor Space '



pptx4musdim <- PTCA4CATA::saveGraph2pptx(file2Save.pptx = name4Graphs, 
                 title = title4Graphs, 
                 addGraphNames = TRUE)
```

\newpage

# References

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id="refs" custom-style="Bibliography"></div>
\endgroup
