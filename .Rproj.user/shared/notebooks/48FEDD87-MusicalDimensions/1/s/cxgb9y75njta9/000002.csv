"0","# We have a problem here because most matrices"
"0","#  have lines with zeros. A symmetric difference matrix "
"0","#  would do better than an RV or a "
"0","#  chi2 distance so we use createSymDist4PTCA"
"0",""
"0","Cmat <- createSymDist4PTCA(thebrick)$CrossProduct"
"0",""
"0","# Calculate the eigenvalues and the percentage of variance extracted (tau)"
"0","eigenCmat <- eigen(Cmat, symmetric = TRUE)"
"0","eig4Cmat <-  eigenCmat$values"
"0","tau4Cmat <- round( (100*eig4Cmat) / sum(eig4Cmat))"
"0",""
"0","# Calculate factor scores for the first three dimensions"
"0","nk       <- 3"
"0","F4Cmat   <- eigenCmat$vectors[,1:nk] %*% diag(eig4Cmat[1:nk]^(1/2))"
"0",""
"0","# Prep for plotting"
"0","Shortnames4Participants <-  dimnames(thebrick[[3]])"
"0","rownames(F4Cmat) <- Shortnames4Participants"
"0",""
"0","# Make labels"
"0","labels4RV <- createxyLabels.gen(1,2,lambda = eig4Cmat, tau = tau4Cmat)"
