"0",""
"0","ps <- pls.res$TExPosition.Data$pdq$p"
"0","qs <- pls.res$TExPosition.Data$pdq$q"
"0",""
"0","th <- .7"
"0",""
"0","pslist <- vector(mode = ""list"", length = 2)"
"0","qslist <- vector(mode = ""list"", length= 2)"
"0",""
"0","names(qslist) <- c(""Dim1"", ""Dim2"")"
"0","names(pslist) <- c(""Dim1"", ""Dim2"")"
"0",""
"0","p.names <- rownames(ps)"
"0","q.names <- rownames(qs)"
"0",""
"0","for (i in 1:2){"
"0","  pslist[[i]] <- ps[which(abs(ps[,i]) > th*max(abs(ps[,i]))),i]"
"0","  qslist[[i]] <- qs[which(abs(qs[,i]) > th*max(abs(qs[,i]))),i]"
"0","  names(pslist[[i]]) <- p.names[abs(ps[,i]) > th*max(abs(ps[,i]))]"
"0","  names(qslist[[i]]) <- q.names[abs(qs[,i]) > th*max(abs(qs[,i]))]"
"0","  }"
"0",""
"0","colors4plsc <- vector(mode = ""list"", length = 5)"
"0","names(colors4plsc) <- c(""colors"", ""p.all"",""q.all"",""p.vec"", ""q.vec"" )"
"0",""
"0","colors4plsc$colors <- c(wes_palettes$Darjeeling1[c(1,2,4)],"
"0","                        wes_palettes$Darjeeling2[2])"
"0",""
"0","colors4plsc$p.all <- ps"
"0","colors4plsc$p.all[colors4plsc$p.all > 0] <- colors4plsc$colors[1]"
"0","colors4plsc$p.all[colors4plsc$p.all != colors4plsc$colors[1]] <- colors4plsc$colors[2]"
"0",""
"0","colors4plsc$q.all <- qs"
"0","colors4plsc$q.all[colors4plsc$q.all > 0] <- colors4plsc$colors[3]"
"0","colors4plsc$q.all[colors4plsc$q.all != colors4plsc$colors[3]] <- colors4plsc$colors[4]"
"0",""
"0","colors4plsc$p.vec <- vector(mode = ""list"", length = 2)"
"0","colors4plsc$q.vec <- vector(mode = ""list"", length = 2)"
"0",""
"0","names(colors4plsc$p.vec) <- c(""Dim1"", ""Dim2"")"
"0","names(colors4plsc$q.vec) <- c(""Dim1"", ""Dim2"")"
"0",""
"0",""
"0","for (i in 1:2){"
"0","  colors4plsc$p.vec[[i]] <- colors4plsc$p.all[which(abs(ps[,i]) > th*max(abs(ps[,i]))),i]"
"0","  colors4plsc$q.vec[[i]] <- colors4plsc$q.all[which(abs(qs[,i]) > th*max(abs(qs[,i]))),i]"
"0",""
"0","}"
"0",""
"0","loading1 <- PrettyBarPlot2(bootratio = c(pslist$Dim1, qslist$Dim1), "
"0","                       threshold = min(c(th*max(abs(ps[,1])), th*max(abs(qs[,1])))), "
"0","                       ylim = c(1.2*min(c(pslist$Dim1, qslist$Dim1)), 1.2*max(c(pslist$Dim1, qslist$Dim1))),"
"0","                       color4bar = c(colors4plsc$p.vec$Dim1, colors4plsc$q.vec$Dim1),"
"0","                       color4ns = ""gray75"", "
"0","                       plotnames = TRUE, "
"0","                       main = 'Loadings for variables for factor plot 1', "
"0","                       ylab = ""Signed Loadings"""
"0","                       #font.size = 1"
"0","                       )"
"0","  "
"0","loading2 <- PrettyBarPlot2(bootratio = c(pslist$Dim2, qslist$Dim2), "
"0","                       threshold = min(c(th*max(abs(ps[,2])), th*max(abs(qs[,2])))), "
"0","                       ylim = c(1.2*min(c(pslist$Dim2, qslist$Dim2)), 1.2*max(c(pslist$Dim2, qslist$Dim2))),"
"0","                       color4bar = c(colors4plsc$p.vec$Dim2, colors4plsc$q.vec$Dim2),"
"0","                       color4ns = ""gray75"", "
"0","                       plotnames = TRUE, "
"0","                       main = 'Loadings for variables for factor plot 2', "
"0","                       ylab = ""Signed Loadings"","
"0","                       #font.size = 1"
"0","                       )  "
"0","  "
"0",""
"0","loads <- grid.arrange("
"0","                      as.grob(loading1),"
"0","                      as.grob(loading2),"
"0","                      ncol = 2,nrow = 1"
"0","                      )"
"0",""
